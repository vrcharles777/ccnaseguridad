<chapter type="" id="en2008000000">
<title><content-text>Implementing Virtual Private Networks</content-text></title>
<section type="ChapterIntroduction" id="en2008000000">
<title><content-text>Chapter Introduction</content-text></title>
<topic type="" id="en2008000100">
<title><content-text>Chapter Introduction</content-text></title>
<page type="OneColumn" id="en2008000101">
<content-media type="StaticGraphic" id="cm2940623417">	<title><content-text></content-text></title>	<media ref="en2008000000/en2008000000/en2008000100/en2008000101/cm2940623417.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2008000000/en2008000000/en2008000100/en2008000101/cm2940623417text.xml"/></content-media>
<content-text><p>Organizations use virtual private networks (VPNs) to create an end-to-end private network connection (tunnel) over third-party networks such as the Internet or extranets. The tunnel eliminates the distance barrier and enables remote users to access central site network resources. However, VPNs cannot guarantee that the information remains secure while traversing the tunnel. For this reason, modern cryptographic methods are applied to VPNs to establish secure, end-to-end, private network connections.</p> <p>The IP Security (IPsec) protocol provides a framework for configuring secure VPNs and is commonly deployed over the Internet to connect branch offices, remote employees, and business partners. It is a reliable way to maintain communication privacy while streamlining operations, reducing costs, and allowing flexible network administration.</p> <p>Secure site-to-site VPNs, between central and remote sites, can be implemented using the IPsec protocol. IPsec can also be used in remote-access tunnels for telecommuter access. The Cisco VPN Client is one method for establishing the IPsec remote-access VPN. In addition to IPsec, the Secure Sockets Layer (SSL) protocol can be used to established remote-access VPN connections.</p></content-text>
</page>
</topic>
</section>
<section type="" id="en2008010000">
<title><content-text>VPNs</content-text></title>
<topic type="" id="en2008010100">
<title><content-text>VPN Overview</content-text></title>
<page type="OneColumn" id="en2008010101">
<content-media type="StaticGraphic" id="cm2715628062">	<title><content-text></content-text></title>	<media ref="en2008000000/en2008010000/en2008010100/en2008010101/cm2715628062.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2008000000/en2008010000/en2008010100/en2008010101/cm2715628062text.xml"/></content-media>
<content-text><p>Solutions, such as the various encryption methods and PKI, enable businesses to securely extend their networks through the Internet. One way in which businesses accomplish this extension is through Virtual Private Networks (VPNs).</p> <p>A VPN is a private network that is created via tunneling over a public network, usually the Internet. Instead of using a dedicated physical connection, a VPN uses virtual connections routed through the Internet from the organization to the remote site. The first VPNs were strictly IP tunnels that did not include authentication or encryption of the data. For example, Generic Routing Encapsulation (GRE) is a tunneling protocol developed by Cisco that can encapsulate a wide variety of Network Layer protocol packet types inside IP tunnels. This creates a virtual point-to-point link to Cisco routers at remote points over an IP internetwork. Other examples of VPNs that do not automatically include security measures are Frame Relay, ATM PVCs, and Multiprotocol Label Switching (MPLS) networks. </p> <p>A VPN is a communications environment in which access is strictly controlled to permit peer connections within a defined community of interest. Confidentiality is achieved by encrypting the traffic within the VPN. Today, a secure implementation of VPN with encryption is what is generally equated with the concept of virtual private networking.</p> <p>VPNs have many benefits:</p> <p><ul><li> <b>Cost savings</b> - VPNs enable organizations to use cost-effective, third-party Internet transport to connect remote offices and remote users to the main corporate site. VPNs eliminate expensive dedicated WAN links and modem banks. Additionally, with the advent of cost-effective, high-bandwidth technologies, such as DSL, organizations can use VPNs to reduce their connectivity costs while simultaneously increasing remote connection bandwidth.</li><li> <b>Security</b> - VPNs provide the highest level of security by using advanced encryption and authentication protocols that protect data from unauthorized access.</li><li> <b>Scalability</b> - VPNs enable corporations to use the Internet infrastructure that is within Internet service providers (ISPs) and devices. This makes it easy to add new users, so that corporations can add significant capacity without adding significant infrastructure.</li><li> <b>Compatibility with broadband technology</b> - VPNs allow mobile workers, telecommuters, and people who want to extend their workday to take advantage of high-speed, broadband connectivity to gain access to their corporate networks, providing workers significant flexibility and efficiency. High-speed broadband connections provide a cost-effective solution for connecting remote offices.</li></ul></p></content-text>
</page>
<page type="OneColumn" id="en2008010102">
<content-media type="StaticGraphic" id="cm8771982523">	<title><content-text></content-text></title>	<media ref="en2008000000/en2008010000/en2008010100/en2008010102/cm8771982523.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2008000000/en2008010000/en2008010100/en2008010102/cm8771982523text.xml"/></content-media>
<content-text><p>In the simplest sense, a VPN connects two endpoints over a public network to form a logical connection. The logical connections can be made at either Layer 2 or Layer 3 of the OSI model. VPN technologies can be classified broadly on these logical connection models as Layer 2 VPNs or Layer 3 VPNs. Establishing connectivity between sites over a Layer 2 or Layer 3 VPN is the same. A delivery header is added in front of the payload to get it to the destination site. This chapter focuses on Layer 3 VPN technology.</p> <p>Common examples of Layer 3 VPNs are GRE, MPLS, and IPsec. Layer 3 VPNs can be point-to-point site connections such as GRE and IPsec, or they can establish any-to-any connectivity to many sites using MPLS.</p> <p>Generic routing encapsulation (GRE) was originally developed by Cisco and later standardized as RFC 1701. An IP delivery header for GRE is defined in RFC 1702. A GRE tunnel between two sites that have IP reachability can be described as a VPN, because the private data between the sites is encapsulated in a GRE delivery header.</p> <p>Pioneered by Cisco, MPLS was originally known as tag switching and later standardized via the IETF as MPLS. Service providers are increasingly deploying MPLS to offer MPLS VPN services to customers. MPLS VPNs use labels to encapsulate the original data, or payload, to form a VPN.</p> <p>How does a network administrator prevent eavesdropping of data in a VPN? Encrypting the data is one way to protect it. Data encryption is achieved by deploying encryption devices at each site. IPsec is a suite of protocols developed with the backing of the IETF to achieve secure services over IP packet-switched networks. The Internet is the most ubiquitous packet-switched public network; therefore, an IPsec VPN deployed over the public Internet can provide significant cost savings to a corporation as compared to a leased-line VPN.</p> <p>IPsec services allow for authentication, integrity, access control, and confidentiality. With IPsec, the information exchanged between remote sites can be encrypted and verified. Both remote-access and site-to-site VPNs can be deployed using IPsec. </p></content-text>
</page>
</topic>
<topic type="" id="en2008010200">
<title><content-text>VPN Topologies</content-text></title>
<page type="OneColumn" id="en2008010201">
<content-media type="StaticGraphic" id="cm8003135230">	<title><content-text></content-text></title>	<media ref="en2008000000/en2008010000/en2008010200/en2008010201/cm8003135230.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2008000000/en2008010000/en2008010200/en2008010201/cm8003135230text.xml"/></content-media>
<content-text><p>There are two basic types of VPN networks:</p> <p><ul><li> Site-to-site</li><li> Remote-access</li></ul></p> <p>A site-to-site VPN is created when connection devices on both sides of the VPN connection are aware of the VPN configuration in advance. The VPN remains static, and internal hosts have no knowledge that a VPN exists. Frame Relay, ATM, GRE, and MPLS VPNs are examples of site-to-site VPNs.</p> <p>A remote-access VPN is created when VPN information is not statically set up, but instead allows for dynamically changing information and can be enabled and disabled. Consider a telecommuter who needs VPN access to corporate data over the Internet. The telecommuter does not necessarily have the VPN connection set up at all times. The telecommuter's PC is responsible for establishing the VPN. The information required to establish the VPN connection, such as the IP address of the telecommuter, changes dynamically depending on the location of the telecommuter.</p></content-text>
</page>
<page type="OneColumn" id="en2008010202">
<content-media type="StaticGraphic" id="cm1016688544">	<title><content-text></content-text></title>	<media ref="en2008000000/en2008010000/en2008010200/en2008010202/cm1016688544.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2008000000/en2008010000/en2008010200/en2008010202/cm1016688544text.xml"/></content-media>
<content-text><p><b>Site-to-Site VPN</b></p> <p>A site-to-site VPN is an extension of a classic WAN network. Site-to-site VPNs connect entire networks to each other, for example, they can connect a branch office network to a company headquarters network. In the past, a leased line or Frame Relay connection was required to connect sites, but because most corporations now have Internet access, these connections can be replaced with site-to-site VPNs.</p> <p>In a site-to-site VPN, hosts send and receive normal TCP/IP traffic through a VPN gateway, which can be a router, firewall, Cisco VPN Concentrator, or Cisco ASA 5500 Series Adaptive Security Appliance. The VPN gateway is responsible for encapsulating and encrypting outbound traffic from a particular site and sending it through a VPN tunnel over the Internet to a peer VPN gateway at the target site. Upon receipt, the peer VPN gateway strips the headers, decrypts the content, and relays the packet toward the target host inside its private network.</p></content-text>
</page>
<page type="OneColumn" id="en2008010203">
<content-media type="StaticGraphic" id="cm3794690528">	<title><content-text></content-text></title>	<media ref="en2008000000/en2008010000/en2008010200/en2008010203/cm3794690528.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2008000000/en2008010000/en2008010200/en2008010203/cm3794690528text.xml"/></content-media>
<content-text><p><b>Remote-Access VPN</b></p> <p>Remote-access VPNs are an evolution of circuit-switching networks, such as plain old telephone service (POTS) or ISDN. Remote-access VPNs can support the needs of telecommuters, mobile users, and extranet consumer-to-business traffic. Remote-access VPNs support a client / server architecture where a VPN client (remote host) requires secure access to the enterprise network via a VPN server device at the network edge.</p> <p>In the past, corporations supported remote users by using dial-in networks and ISDN. With the advent of VPNs, a mobile user simply needs access to the Internet to communicate with the central office. In the case of telecommuters, their Internet connectivity is typically a broadband connection.</p></content-text>
</page>
<page type="OneColumn" id="en2008010204">
<content-media type="StaticGraphic" id="cm7266461730">	<title><content-text></content-text></title>	<media ref="en2008000000/en2008010000/en2008010200/en2008010204/cm7266461730.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2008000000/en2008010000/en2008010200/en2008010204/cm7266461730text.xml"/></content-media>
<content-text><p>In a remote-access VPN, each host typically has Cisco VPN client software. Whenever the host tries to send traffic intended for the VPN, the Cisco VPN Client software encapsulates and encrypts that traffic before sending it over the Internet to the VPN gateway at the edge of the target network. Upon receipt, the VPN gateway behaves as it does for site-to-site VPNs.</p></content-text>
</page>
<page type="OneColumn" id="en2008010205">
<content-media type="StaticGraphic" id="cm5837755443">	<title><content-text></content-text></title>	<media ref="en2008000000/en2008010000/en2008010200/en2008010205/cm5837755443.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2008000000/en2008010000/en2008010200/en2008010205/cm5837755443text.xml"/></content-media>
<content-text><p>An emerging remote-access technology is Cisco IOS SSL VPN. This technology provides remote-access connectivity from almost any Internet-enabled host using a web browser and its native Secure Sockets Layer (SSL) encryption. SSL VPNs allow users to access web pages and services, including the ability to access files, send and receive email, and run TCP-based applications without IPsec VPN Client software. They provide the flexibility to support secure access for all users, regardless of the host from which they establish a connection. This flexibility enables companies to extend their secure enterprise networks to any authorized user by providing remote-access connectivity to corporate resources from any Internet-enabled host.</p> <p>SSL VPN currently delivers two modes of access: clientless and thin client. With clientless SSL VPN, a remote client needs only an SSL-enabled web browser to access HTTP- or HTTPS-enabled web servers on the corporate LAN. In a thin client SSL VPN environment, a remote client must download a small, Java-based applet for secure access of TCP applications that use static port numbers. UDP is not supported in a thin client environment.</p> <p>SSL VPNs are appropriate for user populations that require per-application or per-server access control, or access from non-enterprise-owned desktops. SSL VPNs are not a complete replacement for IPsec VPNs. IPsec VPNs allow secure access to all of an organization's client/server applications. Additionally, SSL VPNs do not support the same level of cryptographic security that IPsec VPNs support. While SSL VPNs cannot replace IPsec VPNs, in many cases, they are complementary because they solve different problems. This complementary approach allows a single device to address all remote-access user requirements.</p> <p>The primary benefit of SSL VPNs is that they are compatible with Dynamic Multipoint VPNs (DMVPNs), Cisco IOS Firewalls, IPsec, intrusion prevention systems (IPSs), Cisco Easy VPN, and Network Address Translation (NAT).</p> <p>The primary restriction of SSL VPNs is that they are currently supported only in software. The router CPU processes the SSL VPN connections. The onboard VPN acceleration that is available in integrated services routers accelerates only IPsec connections.</p></content-text>
</page>
</topic>
<topic type="" id="en2008010300">
<title><content-text>VPN Solutions</content-text></title>
<page type="OneColumn" id="en2008010301">
<content-media type="StaticGraphic" id="cm7873768623">	<title><content-text></content-text></title>	<media ref="en2008000000/en2008010000/en2008010300/en2008010301/cm7873768623.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2008000000/en2008010000/en2008010300/en2008010301/cm7873768623text.xml"/></content-media>
<content-text><p>The Cisco VPN product line includes several devices to support remote and site-to-site VPN: </p> <p><ul><li> <b>Cisco VPN-enabled routers and switches</b> - A good option for customers of all sizes looking to take advantage of their existing network infrastructures to deploy VPNs and security while integrating all services into a single device with the widest selection of WAN and LAN interfaces.</li><li> <b>Cisco PIX 500 Series Security Appliances</b> - Provide robust, enterprise-class, integrated network security services, including stateful inspection firewall, deep protocol and application inspection and IPsec VPN. PIX 500 Series Security Appliances are an excellent option for organizations whose security policies recommend separate management of the security infrastructure to set a clear demarcation between security and network operation. The Cisco PIX 500 Series is End-of-Sale (EOS). This means it is no longer being sold; however, there is a large installed base.</li><li> <b>Cisco ASA 5500 Series Adaptive Security Appliances</b> - All-in-one security appliances that deliver enterprise-class security and IPsec VPN to small- and medium-sized businesses and large enterprise networks in a modular, purpose-built appliance. The appliances incorporate a wide range of integrated security services, including firewall, IPS, and VPN. Cisco ASA 5500 Series Appliances are ideal for clients who are looking for a robust firewall combined with comprehensive VPN support.</li><li> <b>Cisco VPN 3000 Series Concentrators</b> - Offer both IPsec and SSL VPN connectivity on a single platform without the expense of individual feature licensing. Cisco VPN 3000 Series Concentrators are EOS. </li><li> <b>SOHO routers</b> - Many newer broadband home routers such as Linksys also support VPNs.</li></ul></p> <p>In most networks, devices are already in place. If this is the case, it is necessary to verify if interoperability among the different devices is possible. For example, a customer network might have a Cisco ASA 5500 Series Adaptive Security Appliance at one site and a Cisco router at another. This site-to-site VPN interoperability is possible by choosing, at a minimum, the following software versions: Cisco IOS Release 12.2(8)T and Cisco ASA 5500 Series Adaptive Security Appliance Version 8.0.</p> <p>With Cisco routers running Cisco IOS software, organizations can deploy and scale site-to-site VPNs of any topology, from hub-and-spoke to the more complex, fully meshed VPNs. In addition, the Cisco IOS security features combine the VPN feature set with firewall, intrusion prevention, and extensive Cisco IOS capabilities, including quality of service (QoS), multiprotocol, multicast, and advanced routing support.</p></content-text>
</page>
<page type="OneColumn" id="en2008010302">
<content-media type="StaticGraphic" id="cm8461500917">	<title><content-text></content-text></title>	<media ref="en2008000000/en2008010000/en2008010300/en2008010302/cm8461500917.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2008000000/en2008010000/en2008010300/en2008010302/cm8461500917text.xml"/></content-media>
<content-text><p>Cisco provides a suite of VPN-optimized routers. Cisco IOS software for routers combines VPN services with routing services. The Cisco VPN software adds strong security using encryption and authentication. These Cisco VPN-enabled routers provide high performance for site-to-site, intranet, and extranet VPN solutions.</p> <p>The Cisco IOS feature sets incorporate many VPN features:</p> <p><ul><li> <b>Voice and Video Enabled VPN (V3PN)</b> - Integrates IP telephony, QoS, and IPsec, providing an end-to-end VPN service that helps ensure the timely delivery of latency-sensitive applications such as voice and video.</li><li> <b>IPsec stateful failover</b> - Provides fast and scalable network resiliency for VPN sessions between remote and central sites. With both stateless and stateful failover solutions available, such as Hot Standby Router Protocol (HSRP), IPsec stateful failover ensures maximum uptime of mission-critical applications.</li><li> <b>Dynamic Multipoint Virtual Private Network (DMVPN)</b> - Enables the auto-provisioning of site-to-site IPsec VPNs, combining three Cisco IOS software features: Next Hop Resolution Protocol (NHRP), multipoint GRE, and IPsec VPN. This combination eases the provisioning challenges for customers and provides secure connectivity between all locations.</li><li> <b>IPsec and MPLS integration</b> - Enables ISPs to map IPsec sessions directly into an MPLS VPN. This solution can be deployed on co-located edge routers that are connected to a Cisco IOS software MPLS provider edge (PE) network. This approach enables the ISP to securely extend its VPN service beyond the boundaries of the MPLS network by using the public IP infrastructure that securely connects enterprise customer remote offices, telecommuters, and mobile users from anywhere to the corporate network.</li><li> <b>Cisco Easy VPN</b> - Simplifies VPN deployment for remote offices and teleworkers. The Cisco Easy VPN solution centralizes VPN management across all Cisco VPN devices, thus reducing the management complexity of VPN deployments.</li></ul></p></content-text>
</page>
<page type="OneColumn" id="en2008010303">
<content-media type="StaticGraphic" id="cm3228055219">	<title><content-text></content-text></title>	<media ref="en2008000000/en2008010000/en2008010300/en2008010303/cm3228055219.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2008000000/en2008010000/en2008010300/en2008010303/cm3228055219text.xml"/></content-media>
<content-text><p>For VPN services, Cisco ASA 5500 Series Adaptive Security Appliances offer flexible technologies that deliver tailored solutions to suit remote-access and site-to-site connectivity requirements. These appliances provide easy-to-manage IPsec and SSL VPN-based remote-access and network-aware, site-to-site VPN connectivity. Businesses can create secure connections across public networks to mobile users, remote sites, and business partners.</p> <p>As an important component of the Cisco Self-Defending Network, Cisco ASA 5500 Series Adaptive Security Appliances provide proactive threat mitigation, control network activity and application traffic, and deliver flexible VPN connectivity while remaining cost effective.</p> <p>Cisco ASA 5500 Series Adaptive Security Appliances offer other services, such as intrusion prevention, Cisco SSL VPN, and advanced integration module (AIM) to enhance the processing capabilities of the appliances. These are some of the features that Cisco ASA 5500 Series Adaptive Security Appliances provide:</p> <p><ul><li> <b>Flexible platform</b> - Offers both IPsec and SSL VPN on a single platform, eliminating the need to provide parallel solutions. In addition to VPN services, Cisco ASA 5500 Series Adaptive Security Appliances offer application inspection firewall and intrusion prevention services.</li><li> <b>Resilient clustering</b> - Allows remote-access deployments to scale cost-effectively by evenly distributing VPN sessions across all Cisco ASA 5500 Series Adaptive Security Appliances and Cisco VPN 3000 Series Concentrators, without requiring user intervention.</li><li> <b>Cisco Easy VPN</b> - Delivers scalable, cost-effective, and easy-to-manage remote-access VPN architecture. Cisco ASA 5500 Series Adaptive Security Appliances dynamically push the latest VPN security policies to remote VPN devices and clients, making sure that those endpoint policies are up to date before a connection is established.</li><li> <b>Automatic Cisco VPN Client updates - </b>Enables Cisco VPN Client software operating on remote desktops to be automatically upgraded.</li><li> <b>Cisco IOS SSL VPN</b> - Offers Cisco SSL VPN with clientless and thin client Cisco SSL VPN capabilities.</li><li> <b>VPN infrastructure for contemporary applications</b> - Enables converged voice, video, and data across a secure IPsec network by combining robust site-to-site VPN support with rich inspection capabilities, QoS, routing, and stateful failover features.</li><li> <b>Integrated web-based management</b> - Provides management of the Cisco ASA 5500 Series Adaptive Security Appliances using the integrated web-based Cisco Adaptive Security Device Manager (ASDM). Cisco ASDM manages all security and VPN functions of the appliances.</li></ul></p> <p>Each Cisco ASA 5500 Series Adaptive Security Appliance supports a number of VPN peers:</p> <p><ul><li> <b>Cisco ASA 5505</b> - 10 IPsec VPN peers and 25 SSL VPN peers, with a Base license, and 25 VPN peers (IPsec or SSL) with the Security Plus license</li><li> <b>Cisco ASA 5510</b> - 250 VPN peers</li><li> <b>Cisco ASA 5520</b> - 750 VPN peers</li><li> <b>Cisco ASA 5540</b> - 5000 IPsec VPN peers and 2500 SSL VPN peers</li><li> <b>Cisco ASA 5550</b> - 5000 VPN peers</li></ul></p></content-text>
</page>
<page type="OneColumn" id="en2008010304">
<content-media type="StaticGraphic" id="cm3461619368">	<title><content-text></content-text></title>	<media ref="en2008000000/en2008010000/en2008010300/en2008010304/cm3461619368.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2008000000/en2008010000/en2008010300/en2008010304/cm3461619368text.xml"/></content-media>
<content-text><p>Cisco remote-access VPNs can use four IPsec clients: </p> <p><ul><li> <b>Certicom client</b> - A wireless client that is loaded on to wireless personal digital assistants (PDAs) running the Palm or Microsoft Windows Mobile operating systems. Certicom wireless client software allows companies to extend critical enterprise applications, such as email and customer relationship management (CRM) tools, to mobile professionals by enabling handheld devices to connect to corporate VPN gateways for secure wireless access.</li><li> <b>Cisco VPN Client software</b> - Loaded on the PC or laptop of an individual, the Cisco VPN Client allows organizations to establish end-to-end, encrypted VPN tunnels for secure connectivity for mobile employees or teleworkers. The Cisco Easy VPN feature allows the Cisco VPN Client to receive security policies from the central site VPN device, the Cisco Easy VPN Server, when a VPN tunnel connection is made, minimizing configuration requirements at the remote location.</li><li> <b>Cisco Remote Router VPN Client </b>- A Cisco remote router, configured as a VPN client, that connects small office, home office (SOHO) LANs to the VPN.</li><li> <b>Cisco AnyConnect VPN Client</b> - Next-generation VPN client that provides remote users with secure VPN connections to the Cisco 5500 Series Adaptive Security Appliance running Cisco ASA 5500 Series Software Version 8.0 and higher or Cisco ASDM Version 6.0 and higher. It does not connect with a Cisco PIX device or Cisco VPN 3000 Series Concentrator. The Cisco AnyConnect VPN Client supports Windows Vista, Windows XP, Windows 2000, Mac OS X (Version 10.4 or later) on either Intel or PowerPC, and Red Hat Linux (Version 9 or later).</li></ul></p></content-text>
</page>
<page type="OneColumn" id="en2008010305">
<content-media type="StaticGraphic" id="cm9410557050">	<title><content-text></content-text></title>	<media ref="en2008000000/en2008010000/en2008010300/en2008010305/cm9410557050.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2008000000/en2008010000/en2008010300/en2008010305/cm9410557050text.xml"/></content-media>
<content-text><p>To enhance performance and offload the encryption task to specialized hardware, the Cisco VPN family of devices offers hardware acceleration modules:</p> <p><ul><li> <b>AIM</b> - A broad range of Cisco routers can be equipped with AIM. Advanced integration modules are installed inside the router chassis and offload encryption tasks from the router CPU.</li><li> <b>Cisco IPsec VPN Shared Port Adapter (SPA)</b> - Delivers scalable and cost-effective VPN performance for Cisco Catalyst 6500 Series Switches and Cisco 7600 Series Routers. Using the Cisco 7600 Series/Catalyst 6500 Series Services SPA Carrier-400, each slot of the Cisco Catalyst 6500 Series Switch or the Cisco 7600 Series Router can support up to two Cisco IPsec VPN SPAs.</li><li> <b>Cisco PIX VPN Accelerator Card+ (VAC+)</b> - The PIX Firewall VAC+ delivers hardware acceleration up to 425 Mb/s of DES, 3DES, or AES IPsec encryption throughput.</li></ul></p></content-text>
</page>
</topic>
</section>
<section type="" id="en2008020000">
<title><content-text>GRE VPNs</content-text></title>
<topic type="" id="en2008020100">
<title><content-text>Configuring a Site-to-Site GRE Tunnel</content-text></title>
<page type="OneColumn" id="en2008020101">
<content-media type="StaticGraphic" id="cm1797655794">	<title><content-text></content-text></title>	<media ref="en2008000000/en2008020000/en2008020100/en2008020101/cm1797655794.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2008000000/en2008020000/en2008020100/en2008020101/cm1797655794text.xml"/></content-media>
<content-text><p>Generic routing encapsulation (GRE) is a tunneling protocol defined in RFC 1702 and RFC 2784. It was originally developed by Cisco Systems for creating a virtual point-to-point link to Cisco routers at remote points over an IP internetwork. </p> <p>GRE supports multiprotocol tunneling. It can encapsulate multiple protocol packet types inside an IP tunnel. Adding an additional GRE header between the payload and the tunneling IP header provides the multiprotocol functionality. IP tunneling using GRE enables network expansion by connecting multiprotocol subnetworks across a single-protocol backbone environment. GRE also supports IP multicast tunneling. Routing protocols that are used across the tunnel enable dynamic exchange of routing information in the virtual network. </p> <p>GRE tunnels are stateless. Each tunnel endpoint keeps no information about the state or availability of the remote tunnel endpoint. This feature helps service providers (SPs) provide IP tunnels to customers who are not concerned about the internal tunneling architecture at the SP end. Customers then have the flexibility to configure or reconfigure their IP architecture but still maintain connectivity. It creates a virtual point-to-point link to routers at remote points over an IP internetwork. GRE does not include any strong security mechanisms to protect its payload.</p></content-text>
</page>
<page type="OneColumn" id="en2008020102">
<content-media type="StaticGraphic" id="cm6306792863">	<title><content-text></content-text></title>	<media ref="en2008000000/en2008020000/en2008020100/en2008020102/cm6306792863.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2008000000/en2008020000/en2008020100/en2008020102/cm6306792863text.xml"/></content-media>
<content-text><p>GRE encapsulates the entire original IP packet with a standard IP header and GRE header. A GRE tunnel header contains at least two 2-byte mandatory fields:</p> <p><ul><li> GRE flag </li><li> Protocol type</li></ul></p> <p>GRE uses a protocol type field in the GRE header to support the encapsulation of any OSI Layer 3 protocol. The GRE header, together with the tunneling IP header, creates at least 24 bytes of additional overhead for tunneled packets.</p></content-text>
</page>
<page type="OneColumn" id="en2008020103">
<content-media type="StaticGraphic" id="cm2268431333">	<title><content-text></content-text></title>	<media ref="en2008000000/en2008020000/en2008020100/en2008020103/cm2268431333.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2008000000/en2008020000/en2008020100/en2008020103/cm2268431333text.xml"/></content-media>
<content-text><p>There are five steps to configuring a GRE tunnel:</p> <p><b>Step 1.</b> Creating a tunnel interface using the <span class="cmd"><b>interface tunnel 0</b></span> command.</p> <p><b>Step 2.</b> Assigning the tunnel an IP address.</p> <p><b>Step 3.</b> Identifying the source tunnel interface using the <span class="cmd"><b>tunnel source</b></span> command.</p> <p><b>Step 4.</b> Identifying the destination of the tunnel using the <span class="cmd"><b>tunnel destination</b></span> command.</p> <p><b>Step 5.</b> Configuring which protocol GRE will encapsulate using the <span class="cmd"><b>tunnel mode gre</b></span> command.</p></content-text>
</page>
<page type="OneColumn" id="en2008020104">
<content-media type="StaticGraphic" id="cm3703180907">	<title><content-text></content-text></title>	<media ref="en2008000000/en2008020000/en2008020100/en2008020104/cm3703180907.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2008000000/en2008020000/en2008020100/en2008020104/cm3703180907text.xml"/></content-media>
<content-text><p>The advantages of GRE are that it can be used to tunnel non-IP traffic over an IP network. Unlike IPsec, which only supports unicast traffic, GRE supports multicast and broadcast traffic over the tunnel link. Therefore, routing protocols are supported in GRE.</p> <p>GRE does not provide encryption. If that is needed, IPsec should be configured. </p></content-text>
</page>
</topic>
</section>
<section type="" id="en2008030000">
<title><content-text>IPsec VPN Components and Operation</content-text></title>
<topic type="" id="en2008030100">
<title><content-text>Introducing IPsec</content-text></title>
<page type="OneColumn" id="en2008030101">
<content-media type="StaticGraphic" id="cm4102178326">	<title><content-text></content-text></title>	<media ref="en2008000000/en2008030000/en2008030100/en2008030101/cm4102178326.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2008000000/en2008030000/en2008030100/en2008030101/cm4102178326text.xml"/></content-media>
<content-text><p>IPsec is an IETF standard (RFC 2401-2412) that defines how a VPN can be configured using the IP addressing protocol. IPsec is not bound to any specific encryption, authentication, security algorithms, or keying technology. IPsec is a framework of open standards that spells out the rules for secure communications. IPsec relies on existing algorithms to implement the encryption, authentication, and key exchange. </p> <p>IPsec works at the Network Layer, protecting and authenticating IP packets between participating IPsec devices (peers). As a result, IPsec can protect virtually all application traffic because the protection can be implemented from Layer 4 through Layer 7. All implementations of IPsec have a plaintext Layer 3 header, so there are no issues with routing. IPsec functions over all Layer 2 protocols, such as Ethernet, ATM, Frame Relay, Synchronous Data Link Control (SDLC), and High-Level Data Link Control (HDLC). </p> <p>The IPsec framework consists of five building blocks: </p> <p><ul><li> The first represents the IPsec protocol. Choices include ESP or AH. </li><li> The second represents the type of confidentiality implemented using an encryption algorithm such as DES, 3DES, AES, or SEAL. The choice depends on the level of security required. </li><li> The third represents integrity that can be implemented using either MD5 or SHA. </li><li> The fourth represents how the shared secret key is established. The two methods are pre-shared or digitally signed using RSA. </li><li> The last represents the DH algorithm group. There are four separate DH key exchange algorithms to choose from including DH Group 1 (DH1), DH Group 2 (DH2), DH Group 5 (DH5), and DH Group 7 (DH7). The type of group selected depends on the specific needs.</li></ul></p> <p>IPsec provides the framework, and the administrator chooses the algorithms that are used to implement the security services within that framework. By not binding IPsec to specific algorithms, it allows newer and better algorithms to be implemented without patching the existing IPsec standards.</p> <p>IPsec can secure a path between a pair of gateways, a pair of hosts, or a gateway and host. Using the IPsec framework, IPsec provides these essential security functions:</p> <p><ul><li> <b>Confidentiality</b> - IPsec ensures confidentiality by using encryption. </li><li> <b>Integrity</b> - IPsec ensures that data arrives unchanged at the destination using a hash algorithm such as MD5 or SHA.</li><li> <b>Authentication</b> - IPsec uses Internet Key Exchange (IKE) to authenticate users and devices that can carry out communication independently. IKE uses several types of authentication, including username and password, one-time password, biometrics, pre-shared keys (PSKs), and digital certificates.</li><li> <b>Secure key exchange - </b>IPsec uses the DH algorithm to provide a public key exchange method for two peers to establish a shared secret key.</li></ul></p></content-text>
</page>
<page type="OneColumn" id="en2008030102">
<content-media type="StaticGraphic" id="cm3839466133">	<title><content-text></content-text></title>	<media ref="en2008000000/en2008030000/en2008030100/en2008030102/cm3839466133.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2008000000/en2008030000/en2008030100/en2008030102/cm3839466133text.xml"/></content-media>
<content-text><p><b>Confidentiality</b></p> <p>Confidentiality is achieved through encryption of traffic as it travels down the VPN. The degree of security depends on the length of the key of the encryption algorithm. If someone tries to hack the key through a brute-force attack, the number of possibilities to try is a function of the length of the key. The time to process all the possibilities is a function of the computer power of the attacking device. The shorter the key, the easier it is to break. A 64-bit key can take approximately one year to break with a relatively sophisticated computer. A 128-bit key with the same machine can take roughly 10^19 years to decrypt. </p> <p>The following are some encryption algorithms and key lengths that VPNs use:</p> <p><ul><li> <b>DES - </b>Uses a 56-bit key, ensuring high-performance encryption. DES is a symmetric key cryptosystem.</li><li> <b>3DES</b> - A variant of the 56-bit DES. 3DES uses three independent 56-bit encryption keys per 64-bit block, providing significantly stronger encryption strength over DES. 3DES is a symmetric key cryptosystem.</li><li> <b>AES - </b>Provides stronger security than DES and is computationally more efficient than 3DES. AES offers three different key lengths: 128 bits, 192 bits, and 256 bits.</li><li> <b>Software-Optimized Encryption Algorithm (SEAL)</b> - A stream cipher developed in 1993 by Phillip Rogaway and Don Coppersmith, which uses a 160-bit key.</li></ul></p></content-text>
</page>
<page type="OneColumn" id="en2008030103">
<content-media type="StaticGraphic" id="cm3328545714">	<title><content-text></content-text></title>	<media ref="en2008000000/en2008030000/en2008030100/en2008030103/cm3328545714.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2008000000/en2008030000/en2008030100/en2008030103/cm3328545714text.xml"/></content-media>
<content-text><p><b>Integrity</b></p> <p>The next VPN-critical function is data integrity. Assume that a check for $100 is written to Sonya from Jeremy. The check is then mailed to Sonya but intercepted by an attacker. The attacker changes the name and amount on the check and attempts to cash it. Depending on the forged quality of the altered check, the attacker could be successful. </p> <p>This scenario applies to VPNs because data is transported over the public Internet. Potentially, this data could be intercepted and modified. A method of proving data integrity is required to guarantee that the content has not been altered. A data integrity algorithm can provide this guarantee. </p> <p>Hashed Message Authentication Codes (HMAC) is a data integrity algorithm that guarantees the integrity of the message using a hash value. At the local device, the message and a shared-secret key are processed through a hash algorithm, which produces a hash value. This value is appended to the message, and the message is sent over the network. At the remote device, the hash value is recalculated and compared to the sent hash value. If the transmitted hash matches the received hash, the message integrity is verified. However, if they do not match, the message was altered and is invalidated. </p> <p>There are two common HMAC algorithms:</p> <p><ul><li> <b>HMAC-Message Digest 5 (HMAC-MD5)</b> - Uses a 128-bit shared-secret key. The variable-length message and 128-bit shared secret key are combined and run through the HMAC-MD5 hash algorithm. The output is a 128-bit hash. </li><li> <b>HMAC-Secure Hash Algorithm 1 (HMAC-SHA-1)</b> - Uses a 160-bit secret key. The variable-length message and the 160-bit shared secret key are combined and run through the HMAC-SHA-1 hash algorithm. The output is a 160-bit hash. </li></ul></p> <p>HMAC-SHA-1 is considered cryptographically stronger than HMAC-MD5. It is recommended when slightly superior security is important.</p></content-text>
</page>
<page type="OneColumn" id="en2008030104">
<content-media type="StaticGraphic" id="cm1196712779">	<title><content-text></content-text></title>	<media ref="en2008000000/en2008030000/en2008030100/en2008030104/cm1196712779.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2008000000/en2008030000/en2008030100/en2008030104/cm1196712779text.xml"/></content-media>
<content-text><p><b>Authentication</b></p> <p>When conducting business over long distance, it is necessary to know (authenticate) the individual at the other end of the phone, email, or fax. The same is true of VPN networks. The device on the other end of the VPN tunnel must be authenticated before the communication path is considered secure. </p> <p>In the middle ages, a seal guaranteed the authenticity of a document. In modern times, a signed document is notarized with a seal and a signature. In the electronic era, a document is signed using the sender's private encryption key called a digital signature. A signature is authenticated by decrypting the signature with the sender's public key.</p> <p>There are two primary methods of configuring peer authentication.</p> <p><ul><li> <b>Pre-shared Keys (PSKs)</b> - A pre-shared secret key value is entered into each peer manually and is used to authenticate the peer. At each end, the PSK is combined with other information to form the authentication key. Each peer must authenticate its opposite peer before the tunnel is considered secure. Pre-shared keys are easy to configure manually but do not scale well, because each IPsec peer must be configured with the pre-shared key of every other peer with which it communicates.</li><li> <b>RSA signatures</b> - The exchange of digital certificates authenticates the peers. The local device derives a hash and encrypts it with its private key. The encrypted hash is attached to the message and is forwarded to the remote end and acts like a signature. At the remote end, the encrypted hash is decrypted using the public key of the local end. If the decrypted hash matches the recomputed hash, the signature is genuine. Each peer must authenticate its opposite peer before the tunnel is considered secure.</li></ul></p> <p> </p> <p>A third way to accomplish authentication is through RSA-encrypted nonces. A nonce is a random number that is generated by the peer. RSA-encrypted nonces use RSA to encrypt the nonce value and other values. This method requires that the public key of the two peers be present on the other peer before the third and fourth messages of an IKE exchange can be accomplished. For this reason, public keys must be manually copied to each peer as part of the configuration process. This method is the least used of the authentication methods.</p></content-text>
</page>
<page type="OneColumn" id="en2008030105">
<content-media type="StaticGraphic" id="cm3531796290">	<title><content-text></content-text></title>	<media ref="en2008000000/en2008030000/en2008030100/en2008030105/cm3531796290.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2008000000/en2008030000/en2008030100/en2008030105/cm3531796290text.xml"/></content-media>
<content-text><p><b>Secure Key Exchange</b></p> <p>Encryption algorithms such as DES, 3DES, and AES as well as the MD5 and SHA-1 hashing algorithms require a symmetric, shared secret key to perform encryption and decryption. How do the encrypting and decrypting devices get the shared secret key?</p> <p>Email, courier, or overnight express can be used to send the shared secret keys to the administrators of the devices. But the easiest key exchange method is a public key exchange method between the encrypting and decrypting devices. </p> <p>The Diffie-Hellman (DH) key agreement is a public key exchange method that provides a way for two peers to establish a shared secret key that only they know, even though they are communicating over an insecure channel.</p> <p>Variations of the DH key exchange algorithm are known as DH groups. There are four DH groups: 1, 2, 5, and 7.</p> <p><ul><li> DH groups 1, 2, and 5 support exponentiation over a prime modulus with a key size of 768 bits, 1024 bits, and 1536 bits, respectively. </li><li> Cisco 3000 clients support DH groups 1, 2, and 5. DES and 3DES encryption support DH groups 1 and 2. </li><li> AES encryption supports DH groups 2 and 5. </li><li> The Certicom movianVPN client supports group 7. </li><li> Group 7 supports Elliptical Curve Cryptography (ECC), which reduces the time needed to generate keys. </li></ul></p> <p>During tunnel setup, VPN peers negotiate which DH group to use. </p></content-text>
</page>
</topic>
<topic type="" id="en2008030200">
<title><content-text>IPsec Security Protocols</content-text></title>
<page type="OneColumn" id="en2008030201">
<content-media type="StaticGraphic" id="cm4265801012">	<title><content-text></content-text></title>	<media ref="en2008000000/en2008030000/en2008030200/en2008030201/cm4265801012.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2008000000/en2008030000/en2008030200/en2008030201/cm4265801012text.xml"/></content-media>
<content-text><p>IPsec is a framework of open standards. IPsec spells out the messaging to secure the communications but relies on existing algorithms. The two main IPsec framework protocols are AH and ESP. The IPsec protocol is the first building block of the framework. The choice of AH or ESP establishes which other building blocks are available:</p> <p><ul><li> <b>Authentication Header (AH) - </b>AH, which is IP protocol 51, is the appropriate protocol to use when confidentiality is not required or permitted. It ensures that the origin of the data is either R1 or R2 and verifies that the data has not been modified during transit. AH does not provide data confidentiality (encryption) of packets. All text is transported unencrypted. If the AH protocol is used alone, it provides weak protection.</li><li> <b>Encapsulating Security Payload</b> (<b>ESP) - </b>ESP, which is IP protocol 50, can provide confidentiality and authentication. It provides confidentiality by performing encryption on the IP packet. IP packet encryption conceals the data payload and the identities of the ultimate source and destination. ESP provides authentication for the inner IP packet and ESP header. Authentication provides data origin authentication and data integrity. Although both encryption and authentication are optional in ESP, at a minimum, one of them must be selected.</li></ul></p></content-text>
</page>
<page type="OneColumn" id="en2008030202">
<content-media type="StaticGraphic" id="cm5391939890">	<title><content-text></content-text></title>	<media ref="en2008000000/en2008030000/en2008030200/en2008030202/cm5391939890.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2008000000/en2008030000/en2008030200/en2008030202/cm5391939890text.xml"/></content-media>
<content-text><p><b>Authentication Header </b></p> <p>AH achieves authenticity by applying a keyed one-way hash function to the packet to create a hash or message digest. The hash is combined with the text and is transmitted. The receiver detects changes in any part of the packet that occur during transit by performing the same one-way hash function on the received packet and comparing the result to the value of the message digest that the sender supplied. The fact that the one-way hash also involves a shared secret key between the two systems means that authenticity is assured.</p> <p>The AH function is applied to the entire packet, except for any mutable IP header fields that change in transit. For example, Time to Live (TTL) fields that are modified by the routers along the transmission path are mutable fields. </p> <p>The AH process occurs in this order:</p> <p><b>1.</b> The IP header and data payload are hashed using the shared secret key.</p> <p><b>2.</b> The hash builds a new AH header, which is inserted into the original packet.</p> <p><b>3.</b> The new packet is transmitted to the IPsec peer router.</p> <p><b>4.</b> The peer router hashes the IP header and data payload using the shared secret key, extracts the transmitted hash from the AH header, and compares the two hashes. </p> <p>The hashes must match exactly. If one bit is changed in the transmitted packet, the hash output on the received packet changes and the AH header will not match.</p> <p>AH supports the HMAC-MD5 and HMAC-SHA-1 algorithms. AH can have problems if the environment uses NAT.</p></content-text>
</page>
<page type="OneColumn" id="en2008030203">
<content-media type="StaticGraphic" id="cm3975921407">	<title><content-text></content-text></title>	<media ref="en2008000000/en2008030000/en2008030200/en2008030203/cm3975921407.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2008000000/en2008030000/en2008030200/en2008030203/cm3975921407text.xml"/></content-media>
<content-text><p><b>ESP </b></p> <p>ESP provides confidentiality by encrypting the payload. It supports a variety of symmetric encryption algorithms. If ESP is selected as the IPsec protocol, an encryption algorithm must also be selected. The default algorithm for IPsec is 56-bit DES. Cisco products also support the use of 3DES, AES, and SEAL for stronger encryption.</p> <p>ESP can also provide integrity and authentication. First, the payload is encrypted. Next, the encrypted payload is sent through a hash algorithm, HMAC-MD5 or HMAC-SHA-1. The hash provides authentication and data integrity for the data payload.</p> <p>Optionally, ESP can also enforce anti-replay protection. Anti-replay protection verifies that each packet is unique and is not duplicated. This protection ensures that a hacker cannot intercept packets and insert changed packets into the data stream. Anti-replay works by keeping track of packet sequence numbers and using a sliding window on the destination end. When a connection is established between a source and destination, their counters are initialized at zero. Each time a packet is sent, a sequence number is appended to the packet by the source. The destination uses the sliding window to determine which sequence numbers are expected. The destination verifies that the sequence number of the packet is not duplicated and is received in the correct order. For example, if the sliding window on the destination is set to one, the destination is expecting to receive the packet with the sequence number one. After it is received, the sliding window moves to two. When detection of a replayed packet occurs, such as the destination receiving a second packet with the sequence number of one, an error message is sent, the replayed packet is discarded, and the event is logged. </p> <p>Anti-replay is typically used in ESP, but it is also supported in AH.</p></content-text>
</page>
<page type="OneColumn" id="en2008030204">
<content-media type="StaticGraphic" id="cm4545348723">	<title><content-text></content-text></title>	<media ref="en2008000000/en2008030000/en2008030200/en2008030204/cm4545348723.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2008000000/en2008030000/en2008030200/en2008030204/cm4545348723text.xml"/></content-media>
<content-text><p>The original data is well protected by ESP because the entire original IP datagram and ESP trailer are encrypted. With ESP authentication, the encrypted IP datagram and trailer, and the ESP header, are included in the hashing process. Last, a new IP header is attached to the authenticated payload. The new IP address is used to route the packet through the Internet.</p> <p>When both authentication and encryption are selected, encryption is performed first. One reason for this order of processing is that it facilitates rapid detection and rejection of replayed or bogus packets by the receiving device. Prior to decrypting the packet, the receiver can authenticate inbound packets. By doing this, it can quickly detect problems and potentially reduce the impact of DoS attacks.</p></content-text>
</page>
<page type="OneColumn" id="en2008030205">
<content-media type="StaticGraphic" id="cm8520727744">	<title><content-text></content-text></title>	<media ref="en2008000000/en2008030000/en2008030200/en2008030205/cm8520727744.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2008000000/en2008030000/en2008030200/en2008030205/cm8520727744text.xml"/></content-media>
<content-text><p>ESP and AH can be applied to IP packets in two different modes, transport mode and tunnel mode.</p> <p><b>Transport Mode</b></p> <p>In transport mode, security is provided only for the Transport Layer of the OSI model and above. Transport mode protects the payload of the packet but leaves the original IP address in plaintext. The original IP address is used to route the packet through the Internet. </p> <p>ESP transport mode is used between hosts. Transport mode works well with GRE, because GRE hides the addresses of the end devices by adding its own IP.</p> <p><b>Tunnel Mode</b></p> <p>Tunnel mode provides security for the complete original IP packet. The original IP packet is encrypted and then it is encapsulated in another IP packet. This is known as IP-in-IP encryption. The IP address on the outside IP packet is used to route the packet through the Internet. </p> <p>ESP tunnel mode is used between a host and a security gateway or between two security gateways. For gateway-to-gateway applications, rather than load IPsec on all of the computers at the remote and corporate offices, it is easier to have the security gateways perform the IP-in-IP encryption and encapsulation. </p> <p>ESP tunnel mode is used in the IPsec remote-access application. A home office might not have a router to perform the IPsec encapsulation and encryption. In this case, an IPsec client running on the PC performs the IPsec IP-in-IP encapsulation and encryption. At the corporate office, the router de-encapsulates and decrypts the packet.</p> <p>The VPN process involves selecting and applying many parameters. How does IPsec actually negotiate these security parameters?</p></content-text>
</page>
</topic>
<topic type="" id="en2008030300">
<title><content-text>Internet Key Exchange</content-text></title>
<page type="OneColumn" id="en2008030301">
<content-media type="StaticGraphic" id="cm4987820762">	<title><content-text></content-text></title>	<media ref="en2008000000/en2008030000/en2008030300/en2008030301/cm4987820762.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2008000000/en2008030000/en2008030300/en2008030301/cm4987820762text.xml"/></content-media>
<content-text><p>The IPsec VPN solution negotiates key exchange parameters, establishes a shared key, authenticates the peer, and negotiates the encryption parameters. The negotiated parameters between two devices are known as a security association (SA). </p> <p><b>Security Associations</b></p> <p>An SA is a basic building block of IPsec. Security associations are maintained within a SA database (SADB), which is established by each device. A VPN has SA entries defining the IPsec encryption parameters as well as SA entries defining the key exchange parameters. </p> <p>All cryptographic systems, including the Caesar cipher, Vigenere cipher, Enigma machine, to modern encryption algorithms, must deal with key management issues. Diffie-Hellman (DH) is used to create the shared secret key. However, IPsec uses the Internet Key Exchange (IKE) protocol to establish the key exchange process.</p> <p>Instead of transmitting keys directly across a network, IKE calculates shared keys based on the exchange of a series of data packets. This disables a third party from decrypting the keys even if the third party captured all exchanged data that is used to calculate the keys.</p> <p>IKE is layered on UDP and uses UDP port 500 to exchange IKE information between the security gateways. UDP port 500 packets must be permitted on any IP interface involved in connecting a security gateway peer.</p> <p>IKE is defined in RFC 2409. It is a hybrid protocol, combining the Internet Security Association and Key Management Protocol (ISAKMP) and the Oakley and Skeme key exchange methods. ISAKMP defines the message format, the mechanics of a key-exchange protocol, and the negotiation process to build an SA for IPsec. ISAKMP does not define how keys are managed or shared between the two IPsec peers. Oakley and Skeme have five defined key groups. Of these groups, Cisco routers support Group 1 (768-bit key), Group 2 (1024-bit key), and Group 5 (1536-bit key). </p> <p>IKE combines these protocols to build secure IPsec connections between devices. It establishes SAs that are mutually agreeable to each peer. Each peer must have identical ISAKMP and IPsec parameters to establish an operational and secure VPN. Note that the terms ISAKMP and IKE are commonly used by industry people to refer to IKE.</p> <p>An alternative to using IKE is to manually configure all parameters required to establish a secure IPsec connection. This process is impractical because it does not scale.</p> <p>How does IKE work?</p></content-text>
</page>
<page type="OneColumn" id="en2008030302">
<content-media type="StaticGraphic" id="cm6552807787">	<title><content-text></content-text></title>	<media ref="en2008000000/en2008030000/en2008030300/en2008030302/cm6552807787.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2008000000/en2008030000/en2008030300/en2008030302/cm6552807787text.xml"/></content-media>
<content-text><p>To establish a secure communication channel between two peers, the IKE protocol executes two phases:</p> <p><ul><li> <b>Phase 1 - </b>Two IPsec peers perform the initial negotiation of SAs. The basic purpose of Phase 1 is to negotiate IKE policy sets, authenticate the peers, and set up a secure channel between the peers. It can be implemented in main mode (longer, initial contact) or aggressive mode (after initial contact).</li><li> <b>Phase 2 - </b>SAs are negotiated by the IKE process ISAKMP on behalf of IPsec. It can be negotiated in quick mode.</li></ul></p> <p>In Phase 1, the transform sets, hash methods, and other parameters are determined. An IKE session begins with a router (the initiator) sending a proposals to another router (the responder). The proposal sent by the initiator defines which encryption and authentication protocols are acceptable, how long keys should remain active, and whether perfect forward secrecy (PFS) should be enforced. PFS is a property that states that keys used to protect data are not used to derive any other keys. PFS ensures that if one key is compromised, previous and subsequent keys remain secure.</p></content-text>
</page>
<page type="OneColumn" id="en2008030303">
<content-media type="StaticGraphic" id="cm3720402392">	<title><content-text></content-text></title>	<media ref="en2008000000/en2008030000/en2008030300/en2008030303/cm3720402392.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2008000000/en2008030000/en2008030300/en2008030303/cm3720402392text.xml"/></content-media>
<content-text><p>Three exchanges transpire during IKE Phase 1. These are referred to as the first, second, and third exchanges.</p> <p><b>First Exchange</b> </p> <p>The first exchange between the initiator and the responder establishes the basic security policy. Peers negotiate and agree on the algorithms and hashes that are used to secure the IKE communications. Rather than negotiate each protocol individually, the protocols are grouped into sets, called IKE policy sets. The IKE policy sets are exchanged first. </p> <p>The initiator first transmits proposals for the encryption and authentication schemes to be used. The responder looks for a matching ISAKMP policy. The responder chooses a proposal that is best suited to the security situation and then sends that proposal to the initiator. If a policy match is found between the peers, IKE Phase 1 continues. If no match is found, the tunnel is torn down.</p> <p>Policy set numbers are only locally significant to a VPN device. The policy set numbers do not have to match between two VPN peers. In a point-to-point application, each end might need only a single IKE policy set to be defined. In a hub-and-spoke environment, the central site might require multiple IKE policy sets to satisfy all the remote peers.</p> <p><b>Second Exchange</b></p> <p>The second exchange creates and exchanges the DH public keys between the two endpoints. DH allows two parties that have no prior knowledge of each other to establish a shared secret key over an insecure communications channel. </p> <p>The two peers run the DH key exchange protocol to acquire the keying material that is needed by the various encryption and hashing algorithms upon which IKE and IPsec will ultimately agree. </p> <p>Several levels of DH key exchanges are available in Cisco IOS Software:</p> <p><ul><li> <b>DH Group 1</b> - results in 768 bits of keying material. This group is the usual choice when the encryption algorithm is DES.</li><li> <b>DH Group 2</b> - results in 1024 bits of keying material. This group is the usual choice when using 3DES for encryption.</li><li> <b>DH Group 5</b> - results in 1536 bits of keying material. DH 5 should be used with AES.</li><li> <b>DH Group 7 (elliptic curve cryptography [ECC])</b> - generates IPsec keys when the elliptic curve field is 163 bits. This group was designed to be used with low-powered hosts such as PDAs.</li></ul></p> <p>It is important to have sufficient keying material for the algorithms chosen. Using the DH algorithm, each peer generates a shared secret without actually exchanging secrets. All further negotiations are encrypted using the DH-generated secret key.</p> <p><b>Third Exchange</b></p> <p>Each end device must authenticate the other end device before the communication path is considered secure. The last exchange of IKE Phase 1 authenticates the remote peer. </p> <p>The initiator and recipient authenticate each other using one of the three data-origin authentication methods:</p> <p><ul><li> PSK </li><li> RSA signature</li><li> RSA encrypted nonce</li></ul></p> <p>The Phase 1 SA negotiations are bidirectional, which means that data can be sent and received using the same encryption key. Even if the SA negotiation data stream between the two IPsec peers is compromised, there is little chance that the encryption keys could be decrypted.</p></content-text>
</page>
<page type="OneColumn" id="en2008030304">
<content-media type="StaticGraphic" id="cm4628645423">	<title><content-text></content-text></title>	<media ref="en2008000000/en2008030000/en2008030300/en2008030304/cm4628645423.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2008000000/en2008030000/en2008030300/en2008030304/cm4628645423text.xml"/></content-media>
<content-text><p>The three exchanges of IKE Phase 1 transpire in what is called main mode. The outcome of main mode is a secure communication path for subsequent exchanges between the peers. </p> <p>IKE Phase 1 can also transpire in aggressive mode. Aggressive mode is faster than main mode because there are fewer exchanges. Aggressive mode compresses the IKE SA negotiation phases into one exchange with three packets. Main mode requires three exchanges with six packets.</p> <p>Aggressive mode packets include:</p> <p><ul><li> <b>First packet</b> - The initiator packages everything needed for the SA negotiation in the first message, including its DH public key. </li><li> <b>Second packet</b> - The recipient responds with the acceptable parameters, authentication information, and its DH public key.</li><li> <b>Third packet</b> - The initiator then sends a confirmation that it received that information.</li></ul></p> <p>Aggressive mode negotiation is quicker, and the initiator and responder IDs pass in plaintext.</p> <p>After the IKE SA is established, Phase 2 negotiation begins.</p></content-text>
</page>
<page type="OneColumn" id="en2008030305">
<content-media type="StaticGraphic" id="cm5057104329">	<title><content-text></content-text></title>	<media ref="en2008000000/en2008030000/en2008030300/en2008030305/cm5057104329.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2008000000/en2008030000/en2008030300/en2008030305/cm5057104329text.xml"/></content-media>
<content-text><p>The purpose of IKE Phase 2 is to negotiate the IPsec security parameters that will be used to secure the IPsec tunnel. IKE Phase 2 is called quick mode and can only occur after IKE has established the secure tunnel in Phase 1. SAs are negotiated by the IKE process ISAKMP on behalf of IPsec, which needs encryption keys for operation. Quick mode negotiates the IKE Phase 2 SAs. In this phase, the SAs that IPsec uses are unidirectional; therefore, a separate key exchange is required for each data flow.</p> <p>IKE Phase 2 performs the following functions:</p> <p><ul><li> Negotiates IPsec security parameters, known as IPsec transform sets</li><li> Establishes IPsec SAs</li><li> Periodically renegotiates IPsec SAs to ensure security</li><li> Optionally performs an additional DH exchange</li></ul></p> <p>Quick mode also renegotiates a new IPsec SA when the IPsec SA lifetime expires. Basically, quick mode refreshes the keying material that creates the shared secret key based on the keying material that is derived from the DH exchange in Phase 1.</p></content-text>
</page>
</topic>
</section>
<section type="" id="en2008040000">
<title><content-text>Implementing Site-to-Site IPsec VPNs with CLI</content-text></title>
<topic type="" id="en2008040100">
<title><content-text>Configuring a Site-to-Site IPsec VPN</content-text></title>
<page type="OneColumn" id="en2008040101">
<content-media type="StaticGraphic" id="cm8689169813">	<title><content-text></content-text></title>	<media ref="en2008000000/en2008040000/en2008040100/en2008040101/cm8689169813.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2008000000/en2008040000/en2008040100/en2008040101/cm8689169813text.xml"/></content-media>
<content-text><p>A VPN is a communications channel that is used to form a logical connection between two endpoints over a public network. VPNs do not necessarily include encryption or authentication. IPsec VPNs rely on the IKE protocol to establish secure communications. </p> <p>IPsec VPN negotiation involves several steps, which include Phase 1 and Phase 2 of IKE negotiation.</p> <p><b>1.</b> An IPsec tunnel is initiated when host A sends "interesting" traffic to host B. Traffic is considered interesting when it travels between the IPsec peers and meets the criteria that is defined in the crypto access control list (ACL).</p> <p><b>2.</b> IKE Phase 1 begins. The IPsec peers negotiate the established IKE security association (SA) policy. When the peers are authenticated, a secure tunnel is created using Internet Security Association and Key Management Protocol (ISAKMP).</p> <p><b>3.</b> IKE Phase 2 begins. The IPsec peers use the authenticated secure tunnel to negotiate IPsec SA transforms. The negotiation of the shared policy determines how the IPsec tunnel is established.</p> <p><b>4.</b> The IPsec tunnel is created and data is transferred between the IPsec peers based on the IPsec parameters that are configured in the IPsec transform sets.</p> <p><b>5.</b> The IPsec tunnel terminates when the IPsec SAs are deleted or when their lifetime expires.</p></content-text>
</page>
<page type="OneColumn" id="en2008040102">
<content-media type="StaticGraphic" id="cm4020294843">	<title><content-text></content-text></title>	<media ref="en2008000000/en2008040000/en2008040100/en2008040102/cm4020294843.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2008000000/en2008040000/en2008040100/en2008040102/cm4020294843text.xml"/></content-media>
<content-text><p>Some basic tasks must be completed to configure a site-to-site IPsec VPN.</p> <p><b>Task 1. </b>Ensure that ACLs configured on the Interface are compatible with IPsec configuration. Usually there are restrictions on the interface that the VPN traffic uses; for example, block all traffic that is not IPsec or IKE.</p> <p><b>Task 2. </b>Create an ISAKMP policy to determine the ISAKMP parameters that will be used to establish the tunnel.</p> <p><b>Task 3. </b>Define the IPsec transform set. The definition of the transform set defines the parameters that the IPsec tunnel uses. The set can include the encryption and integrity algorithms.</p> <p><b>Task 4. </b>Create a crypto ACL. The crypto ACL defines which traffic is sent through the IPsec tunnel and protected by the IPsec process.</p> <p><b>Task 5.</b> Create and apply a crypto map. The crypto map groups the previously configured parameters together and defines the IPsec peer devices. The crypto map is applied to the outgoing interface of the VPN device.</p></content-text>
</page>
</topic>
<topic type="" id="en2008040200">
<title><content-text>Task 1 - Configure Compatible ACLs</content-text></title>
<page type="OneColumn" id="en2008040201">
<content-media type="StaticGraphic" id="cm2117474760">	<title><content-text></content-text></title>	<media ref="en2008000000/en2008040000/en2008040200/en2008040201/cm2117474760.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2008000000/en2008040000/en2008040200/en2008040201/cm2117474760text.xml"/></content-media>
<content-text><p>The first step in configuring Cisco IOS ISAKMP is to ensure that the existing ACLs on perimeter routers, firewalls, or other routers do not block IPsec traffic. Perimeter routers typically implement a restrictive security policy with ACLs, where only specific traffic is permitted, and all other traffic is denied. Such a restrictive policy blocks IPsec traffic. Therefore, specific permit statements must be added to the ACL.</p> <p>Ensure that the ACLs are configured so that ISAKMP, Encapsulating Security Payload (ESP), and Authentication Header (AH) traffic is not blocked at the interfaces used by IPsec. </p> <p><ul><li> ESP is assigned IP protocol number 50.</li><li> AH is assigned IP protocol number 51.</li><li> ISAKMP uses UDP port 500.</li></ul></p></content-text>
</page>
<page type="OneColumn" id="en2008040202">
<content-media type="StaticGraphic" id="cm5065516728">	<title><content-text></content-text></title>	<media ref="en2008000000/en2008040000/en2008040200/en2008040202/cm5065516728.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2008000000/en2008040000/en2008040200/en2008040202/cm5065516728text.xml"/></content-media>
<content-text><p>To permit AH, ESP, and ISAKMP on an IPsec interface while denying any other unnecessary traffic, an existing ACL must be edited or a new ACL created.</p> <p><ul><li> To permit AH traffic, use the <span class="cmd"><b>access-list </b><i>acl</i><b> permit ahp </b><i>source wildcard destination wildcard</i></span> command. </li><li> To permit ESP traffic, use the <span class="cmd"><b>access-list </b><i>acl</i><b> permit esp </b><i>source wildcard destination wildcard</i></span> command. </li><li> To permit ISAKMP traffic, use the <span class="cmd"><b>access-list </b><i>acl</i><b> per</b><b>mit udp </b><i>source wildcard destination wildcard</i><b> eq isakmp</b></span> command. </li></ul></p> <p>Use the <span class="cmd"><b>show access-list</b></span> command to verify the entries.</p></content-text>
</page>
</topic>
<topic type="" id="en2008040300">
<title><content-text>Task 2 - Configure IKE</content-text></title>
<page type="OneColumn" id="en2008040301">
<content-media type="StaticGraphic" id="cm6173397527">	<title><content-text></content-text></title>	<media ref="en2008000000/en2008040000/en2008040300/en2008040301/cm6173397527.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2008000000/en2008040000/en2008040300/en2008040301/cm6173397527text.xml"/></content-media>
<content-text><p>The second major task in configuring Cisco IOS ISAKMP support is to define the parameters within the IKE policy. IKE uses these parameters during negotiation to establish ISAKMP peering between two IPsec endpoints.</p> <p>Multiple ISAKMP policies can be configured on each peer participating in IPsec. When configuring policies, each policy must be given a unique priority number. Use the command <span class="cmd"><b>crypto isakmp policy </b><i>priority</i></span>, where the priority is a number that uniquely identifies the IKE policy and assigns a priority to the policy. Use an integer from 1 to 10,000, with 1 being the highest priority and 10,000 the lowest. Assign the most secure policy the smallest available number.</p> <p>The <span class="cmd"><b>crypto isakmp policy</b></span> command invokes ISAKMP policy configuration command mode. Set the ISAKMP parameters in this mode. If commands are not explicitly configured, default values are used. For example, if the <span class="cmd"><b>hash</b></span> command is not explicitly configured, IKE uses the default SHA value.</p></content-text>
</page>
<page type="OneColumn" id="en2008040302">
<content-media type="StaticGraphic" id="cm4761150340">	<title><content-text></content-text></title>	<media ref="en2008000000/en2008040000/en2008040300/en2008040302/cm4761150340.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2008000000/en2008040000/en2008040300/en2008040302/cm4761150340text.xml"/></content-media>
<content-text><p>Two endpoints must negotiate ISAKMP policies before they agree on the SA to use for IPsec. </p> <p>When the ISAKMP negotiation begins in IKE Phase 1 main mode, the peer that initiates the negotiation sends all its policies to the remote peer, and the remote peer tries to find a match with its own policies. The remote peer looks for a match by comparing its own highest priority policy against the policies it received from the other peer. The remote peer checks each of its policies in order of its priority (highest priority first) until a match is found.</p> <p>A match is made when both policies from the two peers contain the same encryption, hash, authentication, DH parameter values, and when the policy of the remote peer specifies a lifetime less than or equal to the lifetime of the policy that is being compared. If the lifetimes are not identical, the shorter lifetime from the remote peer policy is used. Assign the most secure policy the smallest available priority number so that the most secure policy finds a match before any less secure policies are configured.</p> <p>If an acceptable match is not found, ISAKMP refuses negotiation, and IPsec is not established. If a match is found, ISAKMP completes the main mode negotiation, and IPsec SAs are created during IKE Phase 2 quick mode.</p></content-text>
</page>
<page type="OneColumn" id="en2008040303">
<content-media type="StaticGraphic" id="cm5426067035">	<title><content-text></content-text></title>	<media ref="en2008000000/en2008040000/en2008040300/en2008040303/cm5426067035.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2008000000/en2008040000/en2008040300/en2008040303/cm5426067035text.xml"/></content-media>
<content-text><p>PSKs are required for encryption. At a given peer, the same key can be configured to be shared with multiple remote peers. A more secure approach is to specify different keys to share between different pairs of peers.</p> <p>Configure a PSK with the <span class="cmd"><b>crypto isakmp key</b></span> global configuration command. This key must be configured if the <span class="cmd"><b>authentication pre-share</b></span> command was configured in the ISAKMP policy.</p> <p><span class="cmd"><b>crypto isakmp key </b><i>keystring</i><b> address </b><i>peer-address</i></span></p> <p><span class="cmd"><b>crypto isakmp key </b><i>keystring</i><b> hostname </b><i>hostname</i></span></p> <p>By default, the ISAKMP identity is set to use the IP address. To use the <span class="cmd"><i>hostname</i></span> parameter, the ISAKMP identity must be configured to use the host name with the <span class="cmd"><b>crypto isakmp identity hostname</b></span> global configuration mode command. In addition, DNS must be accessible to resolve the hostname.</p></content-text>
</page>
</topic>
<topic type="" id="en2008040400">
<title><content-text>Task 3 - Configure the Transform Sets</content-text></title>
<page type="OneColumn" id="en2008040401">
<content-media type="StaticGraphic" id="cm3138178120">	<title><content-text></content-text></title>	<media ref="en2008000000/en2008040000/en2008040400/en2008040401/cm3138178120.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2008000000/en2008040000/en2008040400/en2008040401/cm3138178120text.xml"/></content-media>
<content-text><p>A transform set is a combination of individual IPsec transforms that are designed to enact a specific security policy for traffic. During the ISAKMP IPsec SA negotiation that occurs in IKE Phase 2 quick mode, the peers agree to use a particular transform set for protecting a particular data flow. </p> <p>Transform sets consist of a combination of an AH transform, an ESP transform, and the IPsec mode (either tunnel or transport mode). Transform sets are limited to one AH transform and one or two ESP transforms. Multiple transform sets can be configured. Then one or more of these transform sets can be specified in a crypto map entry. The IPsec SA negotiation uses the transform set that is defined in the crypto map entry to protect the data flows that are specified by the ACL of that crypto map entry.</p> <p>To define a transform set, specify one to four transforms using the <span class="cmd"><b>crypto ipsec transform-set</b></span> global configuration command. This command invokes crypto-transform configuration mode.</p> <p><span class="cmd"><b>crypto ipsec transform-set </b><i>transform-set-name transform1</i> [<i>transform2</i>] [<i>transform3</i>] [<i>transform4</i>]</span></p> <p>Each transform represents an IPsec security protocol (AH or ESP) plus the associated algorithm. These protocols and algorithms are specified within the crypto-transform configuration mode. In a transform set, specify the AH protocol, the ESP protocol, or both. If an ESP protocol is specified in a transform set, an ESP encryption transform set or an ESP encryption transform set and an ESP authentication transform set must be specified. </p> <p>During the negotiation, the peers search for a transform set that has the same criteria (the combination of protocols, algorithms, and other settings) at both peers. When a transform set is found, it is selected and applied to the protected traffic as part of the IPsec SAs of both peers.</p> <p>When ISAKMP is not used to establish SAs, a single transform set must be used. In this instance, the transform set is not negotiated.</p></content-text>
</page>
<page type="OneColumn" id="en2008040402">
<content-media type="StaticGraphic" id="cm1610246532">	<title><content-text></content-text></title>	<media ref="en2008000000/en2008040000/en2008040400/en2008040402/cm1610246532.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2008000000/en2008040000/en2008040400/en2008040402/cm1610246532text.xml"/></content-media>
<content-text><p>Transform sets are negotiated during IKE Phase 2 quick mode. When configuring multiple transform sets, configure the transforms from most to least secure, according to the network security policy. </p> <p>IPsec peers search for a transform set that matches at both ends and agree on one unidirectional transform proposal per SA. For example, assume R1 and R2 are negotiating a transform set. R1 has transform sets ALPHA, BETA, and CHARLIE configured, while R2 has RED, BLUE, and YELLOW configured. Each R1 transform set is compared against each R2 transform set in succession. R1 transform sets ALPHA, BETA, and CHARLIE are compared to R2 transform set RED. The result is no match. All the R1 transform sets are then compared against R2 transform set BLUE. Finally, the R1 transform sets are compared to R2 transform set YELLOW. YELLOW is matched against the R1 transform set CHARLIE. When a transform set match is found, it is selected and applied to the protected traffic as part of the IPsec SAs of both peers. </p></content-text>
</page>
</topic>
<topic type="" id="en2008040500">
<title><content-text>Task 4 - Configure the Crypto ACLs</content-text></title>
<page type="OneColumn" id="en2008040501">
<content-media type="StaticGraphic" id="cm3174414887">	<title><content-text></content-text></title>	<media ref="en2008000000/en2008040000/en2008040500/en2008040501/cm3174414887.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2008000000/en2008040000/en2008040500/en2008040501/cm3174414887text.xml"/></content-media>
<content-text><p>Crypto ACLs identify the traffic flows to protect. Outbound crypto ACLs select outbound traffic that IPsec should protect. Traffic that is not selected is sent in plaintext. If desired, inbound ACLs can be created to filter and discard traffic that should have been protected by IPsec.</p> <p>Extended IP ACLs select IP traffic to encrypt based on protocol, IP address, network, subnet, and port. Although the ACL syntax is unchanged from extended IP ACLs, the meanings are slightly different for crypto ACLs. For example, permit specifies that matching packets must be encrypted, and deny specifies that matching packets are not encrypted. Traffic is not necessarily dropped because of a deny statement. Crypto ACLs are processed in a similar fashion to an extended IP ACL applied to outbound traffic on an interface.</p></content-text>
</page>
<page type="OneColumn" id="en2008040502">
<content-media type="StaticGraphic" id="cm3367136638">	<title><content-text></content-text></title>	<media ref="en2008000000/en2008040000/en2008040500/en2008040502/cm3367136638.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2008000000/en2008040000/en2008040500/en2008040502/cm3367136638text.xml"/></content-media>
<content-text><p>The command syntax for the basic form of an extended IP ACL is: </p> <p><span class="cmd"><b>access-list </b><i>access-list-number</i> {<b>permit </b>|<b> deny</b>} <i>protocol source source-wildcard destination destination-wildcard</i></span></p> <p>Outbound crypto ACLs define the interesting traffic to be encrypted. All other traffic passes as plaintext. </p> <p>Inbound crypto ACLs inform the router of which traffic should be received as encrypted traffic. When traffic matches the permit statement, the router expects that traffic to be encrypted. If inbound plaintext traffic is received that matches a permit statement in the crypto ACL, that traffic is dropped. This drop occurs because the plaintext traffic was expected to be protected by IPsec and encrypted, but was not.</p> <p>An administrator might want certain traffic to receive one combination of IPsec protection (authentication only) and other traffic to receive a different combination (both authentication and encryption). To do so, create two different crypto ACLs to define the two different types of traffic. Different crypto map entries then use these ACLs to specify different IPsec policies.</p> <p>Try to be as restrictive as possible when defining which packets to protect in a crypto ACL. Using the <span class="cmd"><b>any</b></span> keyword to specify source or destination addresses is not recommended. The <span class="cmd"><b>permit any any</b></span> statement is strongly discouraged because it causes all outbound traffic to be protected and all protected traffic to be sent to the peer that is specified in the corresponding crypto map entry. Then, all inbound packets that lack IPsec protection are silently dropped, including packets for routing protocols, NTP, echo, echo response, and others. If the <span class="cmd"><b>any</b></span> keyword must be used in a permit statement, preface the statement with a series of deny statements to filter out traffic that should not be protected.</p> <p>The crypto ACL is associated with a crypto map, which in turn is assigned to a specific interface. </p></content-text>
</page>
<page type="OneColumn" id="en2008040503">
<content-media type="StaticGraphic" id="cm6346286794">	<title><content-text></content-text></title>	<media ref="en2008000000/en2008040000/en2008040500/en2008040503/cm6346286794.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2008000000/en2008040000/en2008040500/en2008040503/cm6346286794text.xml"/></content-media>
<content-text><p>Symmetric crypto ACLs must be configured for use by IPsec. When a router receives encrypted packets back from an IPsec peer, it uses the same ACL to determine which inbound packets to decrypt by viewing the source and destination addresses in the ACL in reverse order. The ACL criteria are applied in the forward direction to traffic exiting a router, and in the backward direction to traffic entering the router, so that the outbound ACL source becomes the inbound ACL destination. </p> <p>For example, assume that for Site 1, IPsec protection is applied to traffic between hosts on the 10.0.1.0/24 network as the data exits the R1 S0/0/0 interface in route to Site 2 hosts on the 10.0.2.0/24 network. For traffic from Site 1 hosts on the 10.0.1.0/24 network to Site 2 hosts on the 10.0.2.0/24 network, the ACL entry on R1 is evaluated as follows:</p> <p><ul><li> Source = hosts on 10.0.1.0/24 network</li><li> Destination = hosts on 10.0.2.0/24 network</li></ul></p> <p>For incoming traffic from Site 2 hosts on the 10.0.2.0/24 network to Site 1 hosts on the 10.0.1.0/24 network, that same ACL entry on R1 is evaluated as follows:</p> <p><ul><li> Source = hosts on 10.0.2.0/24 network</li><li> Destination = hosts on 10.0.1.0/24 network</li></ul></p></content-text>
</page>
</topic>
<topic type="" id="en2008040600">
<title><content-text>Task 5 - Apply the Crypto Map</content-text></title>
<page type="OneColumn" id="en2008040601">
<content-media type="StaticGraphic" id="cm3399726762">	<title><content-text></content-text></title>	<media ref="en2008000000/en2008040000/en2008040600/en2008040601/cm3399726762.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2008000000/en2008040000/en2008040600/en2008040601/cm3399726762text.xml"/></content-media>
<content-text><p>Crypto map entries that are created for IPsec combine the needed configuration parameters of IPsec SAs, including the following parameters:</p> <p><ul><li> Which traffic to protect using a crypto ACL</li><li> Granularity of the flow to be protected by a set of SAs</li><li> Who the remote IPsec peer is, which determines where the IPsec-protected traffic is sent</li><li> Local address used for the IPsec traffic (optional)</li><li> Which type of IPsec security is applied to this traffic, choosing from a list of one or more transform sets</li></ul></p> <p>Crypto map entries with the same crypto map name but different map sequence numbers are grouped into a crypto map set.</p> <p>Only one crypto map can be set to a single interface. The crypto map set can include a combination of Cisco Encryption Technology (CET) and IPsec using IKE. Multiple interfaces can share the same crypto map set if the same policy is applied to multiple interfaces. If more than one crypto map entry is created for a given interface, use the sequence number (<i>seq-num</i>) of each map entry to rank the map entries. The smaller the sequence number, the higher the priority. At the interface that has the crypto map set, traffic is evaluated against higher priority map entries first.</p> <p>Create multiple crypto map entries for a given interface if any of these conditions exist:</p> <p><ul><li> Separate IPsec peers handle different data flows.</li><li> Different IPsec security must be applied to different types of traffic (to the same or separate IPsec peers). For example, if traffic between one set of subnets needs to be authenticated, and traffic between another set of subnets needs to be both authenticated and encrypted. In this case, define the different types of traffic in two separate ACLs, and create a separate crypto map entry for each crypto ACL.</li><li> IKE is not used to establish a particular set of SAs, and multiple ACL entries must be specified, create separate ACLs (one per permit entry) and specify a separate crypto map entry for each ACL.</li></ul></p></content-text>
</page>
<page type="OneColumn" id="en2008040602">
<content-media type="StaticGraphic" id="cm5160228402">	<title><content-text></content-text></title>	<media ref="en2008000000/en2008040000/en2008040600/en2008040602/cm5160228402.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2008000000/en2008040000/en2008040600/en2008040602/cm5160228402text.xml"/></content-media>
<content-text><p>Use the <span class="cmd"><b>crypto map</b></span> global configuration command to create or modify a crypto map entry and enter crypto map configuration mode. Set the crypto map entries that reference dynamic maps to the lowest priority in a crypto map set (they should have the largest sequence numbers).The command syntax and parameter definitions are as follows:</p> <p><span class="cmd"><b>crypto map </b><i>map-name seq-num</i><b> cisco</b></span></p> <p><span class="cmd"><b>crypto map </b><i>map-name seq-num</i><b> ipsec-manual</b></span></p> <p><span class="cmd"><b>crypto map </b><i>map-name seq-num</i><b> ipsec-isakmp </b>[<b>dynamic </b><i>dynamic-map-name</i>]</span></p> <p><span class="cmd"><b>no crypto map </b><i>map-name</i> [<i>seq-num</i>]</span></p> <p>Using the <span class="cmd"><b>crypto map</b></span> command in global configuration mode enters crypto-map configuration mode. From here, various IPsec components are configured, including which crypto ACL, peer address, and transform set to use.</p> <p>ACLs for crypto map entries that are tagged as IPsec-manual are restricted to a single permit entry, and subsequent entries are ignored. The SAs that are established by that particular crypto map entry are for a single data flow only. To support multiple manually established SAs for different kinds of traffic, define multiple crypto ACLs and then apply each one to a separate IPsec-manual crypto map entry. Each ACL includes one permit statement that defines the traffic that it must protect.</p> <p>Two peers can be specified in a crypto map for redundancy. If the first peer cannot be contacted, the second peer is used. There is no limit to the number of redundant peers that can be configured.</p></content-text>
</page>
<page type="OneColumn" id="en2008040603">
<content-media type="StaticGraphic" id="cm2551379012">	<title><content-text></content-text></title>	<media ref="en2008000000/en2008040000/en2008040600/en2008040603/cm2551379012.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2008000000/en2008040000/en2008040600/en2008040603/cm2551379012text.xml"/></content-media>
<content-text><p>After the crypto map parameters are configured, assign the crypto map set to interfaces using the <span class="cmd"><b>crypto map</b></span> interface configuration command.</p> <p>The crypto map is applied to the outgoing interface of the VPN tunnel using the <span class="cmd"><b>crypto map</b></span> command in interface configuration mode. </p> <p><span class="cmd"><b>crypto map </b><i>map-name</i></span></p> <p><span class="cmd"><i>map-name</i></span> is the name of the crypto map set to apply to the interface.</p> <p>Make sure that the routing information that is needed to send packets into the tunnel is also configured.</p> <p>All IP traffic passing through the interface where the crypto map is applied is evaluated against the applied crypto map set. If a crypto map entry sees outbound IP traffic that should be protected and the crypto map specifies the use of IKE, an SA is negotiated with the remote peer according to the parameters that are included in the crypto map entry.</p></content-text>
</page>
</topic>
<topic type="" id="en2008040700">
<title><content-text>Verify and Troubleshoot the IPsec Configuration</content-text></title>
<page type="OneColumn" id="en2008040701">
<content-media type="StaticGraphic" id="cm8168584012">	<title><content-text></content-text></title>	<media ref="en2008000000/en2008040000/en2008040700/en2008040701/cm8168584012.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2008000000/en2008040000/en2008040700/en2008040701/cm8168584012text.xml"/></content-media>
<content-text><p>VPNs can be complex and sometimes do not operate as expected. For this reason, there are a variety of useful commands to verify the operation of VPNs and to troubleshoot when necessary. </p> <p>The best time to become familiar with these commands and their output is when the network is operating correctly. This way, anomalies can be detected when using them for troubleshooting.</p></content-text>
</page>
<page type="OneColumn" id="en2008040702">
<content-media type="StaticGraphic" id="cm9993860551">	<title><content-text></content-text></title>	<media ref="en2008000000/en2008040000/en2008040700/en2008040702/cm9993860551.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2008000000/en2008040000/en2008040700/en2008040702/cm9993860551text.xml"/></content-media>
<content-text><p>To view all configured crypto maps, use the <span class="cmd"><b>show crypto map</b></span> command. This command verifies configurations and shows the SA lifetime. The <span class="cmd"><b>show running-config</b></span> command also reveals many of these same settings.</p> <p>Use the <span class="cmd"><b>show crypto isakmp policy</b></span> command to display configured IKE policies and the default IKE policy settings. This command is useful because it reveals all ISAKMP (IKE) configuration information.</p> <p>Use the <span class="cmd"><b>show crypto ipsec transform-set</b></span> command to show all configured transform sets. Because transform sets determine the level of protection that the data will have as it is tunneled, it is important to verify the strength of the IPsec protection policy.</p></content-text>
</page>
<page type="OneColumn" id="en2008040703">
<content-media type="StaticGraphic" id="cm6175222553">	<title><content-text></content-text></title>	<media ref="en2008000000/en2008040000/en2008040700/en2008040703/cm6175222553.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2008000000/en2008040000/en2008040700/en2008040703/cm6175222553text.xml"/></content-media>
<content-text><p>One of the more useful commands is <span class="cmd"><b>show crypto ipsec sa</b></span>. If the output indicates that an SA is established, the rest of the configuration is assumed to be working. Within the output, the pkts encrypt and pkts decrypt values indicate that traffic is flowing through the tunnel.</p> <p>A similar useful command is <span class="cmd"><b>show crypto isakmp sa</b></span>. This command displays all current IKE SAs. QM_IDLE status indicates an active IKE SA.</p></content-text>
</page>
<page type="OneColumn" id="en2008040704">
<content-media type="StaticGraphic" id="cm9802020588">	<title><content-text></content-text></title>	<media ref="en2008000000/en2008040000/en2008040700/en2008040704/cm9802020588.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2008000000/en2008040000/en2008040700/en2008040704/cm9802020588text.xml"/></content-media>
<content-text><p>To use debugging commands to troubleshoot VPN connectivity, connect to the Cisco IOS router with a terminal connection.</p> <p>The <span class="cmd"><b>debug crypto isakmp</b></span> command displays detailed information about the IKE Phase 1 and IKE Phase 2 negotiation processes. The <span class="cmd"><b>debug crypto ipsec</b></span> command displays detailed information about IPsec events. </p> <p>As with other debug commands, use the <span class="cmd"><b>debug crypto isakmp</b></span> command with caution, because debug processes can cause performance problems on the device. Use the <span class="cmd"><b>undebug all</b></span> command to turn off the debug as soon as possible.</p></content-text>
</page>
</topic>
</section>
<section type="" id="en2008050000">
<title><content-text>Implementing Site-to-Site IPsec VPNs with SDM</content-text></title>
<topic type="" id="en2008050100">
<title><content-text>Configuring IPsec Using SDM</content-text></title>
<page type="OneColumn" id="en2008050101">
<content-media type="StaticGraphic" id="cm9290939449">	<title><content-text></content-text></title>	<media ref="en2008000000/en2008050000/en2008050100/en2008050101/cm9290939449.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2008000000/en2008050000/en2008050100/en2008050101/cm9290939449text.xml"/></content-media>
<content-text><p>In addition to configuring IPsec VPNs via CLI, it is possible to configure them using an SDM wizard. </p> <p>To select and start a VPN wizard, follow these steps:</p> <p><b>Step 1. </b>Click <b>Configure</b> in the main toolbar. </p> <p><b>Step 2. </b>Click the <b>VPN</b> button on the left to open the VPN page.</p> <p><b>Step 3. </b>Choose a wizard from the VPN window.</p> <p><b>Step 4. </b>Click the VPN implementation subtype. </p> <p><b>Step 5. </b>Click the <b>Launch the selected task</b> button to start the wizard.</p></content-text>
</page>
<page type="OneColumn" id="en2008050102">
<content-media type="StaticGraphic" id="cm2873415532">	<title><content-text></content-text></title>	<media ref="en2008000000/en2008050000/en2008050100/en2008050102/cm2873415532.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2008000000/en2008050000/en2008050100/en2008050102/cm2873415532text.xml"/></content-media>
<content-text><p>The Cisco SDM VPN wizards use two sources to create a VPN connection: user input during a step-by-step wizard process, and preconfigured VPN components.</p> <p>The Cisco SDM provides some default VPN components: two IKE policies and an IPsec transform set for the quick setup wizard.</p> <p>The VPN wizards create other components during the step-by-step configuration process. Some components must be configured before the wizards can be used. For instance, PKI components must be configured before using the PKI wizard.</p> <p>The VPN navigation bar contains three major sections:</p> <p><ul><li> <b>The VPN tab - </b>Contains the wizards to create a site-to-site VPN, Easy VPN Remote, Easy VPN Server, and dynamic multipoint VPN. The VPN wizards simplify the configuration of individual VPN components. The individual IPsec components section can then be used to modify parameters that might have been misconfigured during the VPN wizard step-by-step configuration.</li><li> <b>The SSL VPN tab - </b>Used to configure SSL VPNs parameters.</li><li> <b>VPN components - </b>Used to configure VPN components such as IPsec, IKE, Easy VPN Server group policies and browser proxy settings, Public Key Infrastructure (for IKE authentication using digital certificates), and VPN Keys Encryption. The VPN components option appears if the Cisco IOS software image on the router supports type 6 encryption, also referred to as VPN key encryption. Use this window to specify a master key when encrypting VPN keys, such as PSKs, Cisco Easy VPN keys, and Extended Authentication (XAUTH) keys. When the keys are encrypted, they are not readable by someone viewing the router configuration file.</li></ul></p></content-text>
</page>
<page type="OneColumn" id="en2008050103">
<content-media type="StaticGraphic" id="cm8055453256">	<title><content-text></content-text></title>	<media ref="en2008000000/en2008050000/en2008050100/en2008050103/cm8055453256.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2008000000/en2008050000/en2008050100/en2008050103/cm8055453256text.xml"/></content-media>
<content-text><p>Use a web browser to start the Cisco SDM on a router. Select the VPN wizard by choosing <b>Configure > VPN > Site-to-Site VPN</b>. </p> <p>To create and configure a classic site-to-site VPN, click the <b>Create a Site-to-Site VPN</b> radio button on the Create Site-to-Site VPN tab. Then click the <b>Launch the selected task</b> button.</p></content-text>
</page>
<page type="OneColumn" id="en2008050104">
<content-media type="StaticGraphic" id="cm8271042654">	<title><content-text></content-text></title>	<media ref="en2008000000/en2008050000/en2008050100/en2008050104/cm8271042654.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2008000000/en2008050000/en2008050100/en2008050104/cm8271042654text.xml"/></content-media>
<content-text><p>A window displays the Quick setup option and the Step by step wizard option. </p> <p>The <b>Quick setup</b> option uses the Cisco SDM default IKE policies and IPsec transform sets. It enables a junior administrator to quickly set up an IPsec VPN using best practice security parameters.</p> <p>The <b>Step by step wizard</b> allows the administrator to specify all the finer details of the IPsec VPN.</p> <p>Click the <b>Next</b> button to configure the parameters of the VPN connection.</p></content-text>
</page>
</topic>
<topic type="" id="en2008050200">
<title><content-text>VPN Wizard - Quick Setup</content-text></title>
<page type="OneColumn" id="en2008050201">
<content-media type="StaticGraphic" id="cm8133566671">	<title><content-text></content-text></title>	<media ref="en2008000000/en2008050000/en2008050200/en2008050201/cm8133566671.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2008000000/en2008050000/en2008050200/en2008050201/cm8133566671text.xml"/></content-media>
<content-text><p>The quick setup option uses a single window to configure the VPN connection and includes the following parameters:</p> <p><ul><li> Interface to use for the VPN connection (usually the outside interface)</li><li> Peer identity information, which includes the type of peer and IP address of the peer</li><li> Authentication method, either PSKs (specify the secret) or digital certificates (choose a certificate that has been created beforehand)</li><li> Traffic to encrypt by identifying the source interface and destination IP subnet</li></ul></p> <p>Cisco SDM provides a default IKE policy to govern authentication, a default transform set to control data encryption, and a default IPsec rule that encrypts all traffic between the router and the remote device. </p></content-text>
</page>
<page type="OneColumn" id="en2008050202">
<content-media type="StaticGraphic" id="cm2204437164">	<title><content-text></content-text></title>	<media ref="en2008000000/en2008050000/en2008050200/en2008050202/cm2204437164.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2008000000/en2008050000/en2008050200/en2008050202/cm2204437164text.xml"/></content-media>
<content-text><p>When all parameters are set, verify the configuration on the summary page before clicking <b>Finish</b>.</p> <p>Quick setup is best used when both the local router and the remote system are Cisco routers using Cisco SDM. Quick setup configures 3DES encryption if it is supported by the Cisco IOS image. Otherwise, it configures DES encryption. If AES or SEAL encryption is required, the Step-by-Step wizard must be used.</p></content-text>
</page>
</topic>
<topic type="" id="en2008050300">
<title><content-text>VPN Wizard - Step-by-Step Setup</content-text></title>
<page type="OneColumn" id="en2008050301">
<content-media type="StaticGraphic" id="cm5317124018">	<title><content-text></content-text></title>	<media ref="en2008000000/en2008050000/en2008050300/en2008050301/cm5317124018.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2008000000/en2008050000/en2008050300/en2008050301/cm5317124018text.xml"/></content-media>
<content-text><p>The Step-by-Step wizard requires multiple steps to configure the VPN connection and includes the following parameters:</p> <p><ul><li> Connection settings, including outside interface, peer identity, and authentication credentials</li><li> IKE proposals, such as priority, encryption, the Hashed Message Authentication Code (HMAC) algorithm, IKE authentication method, Diffie-Hellman (DH) group, and IKE lifetime</li><li> IPsec transform set information, including name, integrity algorithm, encryption algorithm, mode of operation (tunnel or transport), and compression</li><li> Traffic to protect by identifying the single source and destination subnets or defining an ACL to use for more complex VPNs</li></ul></p> <p>The first task in the Step-by-Step wizard is to configure the connection settings.</p> <p><b>Step 1.</b> Choose the outside interface to connect to the IPsec peer over the untrusted network.</p> <p><b>Step 2.</b> Specify the IP address of the peer.</p> <p><b>Step 3.</b> Choose the authentication method and specify the credentials. Use long and random PSKs to prevent brute-force and dictionary attacks against IKE.</p> <p><b>Step 4. </b>Click <b>Next</b> to proceed to the next task.</p></content-text>
</page>
<page type="OneColumn" id="en2008050302">
<content-media type="StaticGraphic" id="cm4690172468">	<title><content-text></content-text></title>	<media ref="en2008000000/en2008050000/en2008050300/en2008050302/cm4690172468.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2008000000/en2008050000/en2008050300/en2008050302/cm4690172468text.xml"/></content-media>
<content-text><p>The second task in the Step-by-Step wizard is to configure IKE proposals. A custom IKE proposal can be created, or the default IKE proposal can be used.</p> <p><b>Custom IKE Proposal</b></p> <p>To create a custom IKE proposal, a new IKE must be added. </p> <p><b>Step 1. </b>Click the <b>Add</b> button to define a proposal and specify the IKE proposal priority, encryption algorithm, hashing algorithm, IKE authentication method, DH group, and IKE lifetime. </p> <p><b>Step 2. </b>Click <b>OK</b> when configuring the IKE proposal is completed.</p> <p><b>Step 3. </b>When finished with adding IKE policies, choose the proposal to use. Click <b>Next</b> to proceed to the next task.</p> <p><b>Predefined IKE Proposal</b></p> <p>To use the predefined IKE proposal, click <b>Next</b> on the IKE Proposal page. The predefined IKE proposal is chosen by default.</p></content-text>
</page>
<page type="OneColumn" id="en2008050303">
<content-media type="StaticGraphic" id="cm3784596978">	<title><content-text></content-text></title>	<media ref="en2008000000/en2008050000/en2008050300/en2008050303/cm3784596978.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2008000000/en2008050000/en2008050300/en2008050303/cm3784596978text.xml"/></content-media>
<content-text><p>The third task in the Step-by-Step wizard is to configure a transform set. A custom IPsec transform set can be created, or a predefined IPsec transform set can be used.</p> <p><b>Custom IPsec Transform Set</b></p> <p>To create a custom IPsec transform set, a new IPsec transform set must be added.</p> <p><b>Step 1.</b> Click the <b>Add</b> button to define the transform set and specify the name, integrity algorithm, encryption algorithm, mode of operation, and optional compression.</p> <p><b>Step 2.</b> Click <b>OK</b> when configuring the transform set is completed.</p> <p><b>Step 3.</b> When finished adding transform sets, choose the transform set to use, and click <b>Next</b> to proceed to the next task.</p> <p><b>Predefined IPsec Transform Set</b></p> <p>To use the IPsec transform set, click <b>Next</b> on the Transform Set page. The predefined transform set is chosen by default.</p></content-text>
</page>
<page type="OneColumn" id="en2008050304">
<content-media type="StaticGraphic" id="cm7868250457">	<title><content-text></content-text></title>	<media ref="en2008000000/en2008050000/en2008050300/en2008050304/cm7868250457.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2008000000/en2008050000/en2008050300/en2008050304/cm7868250457text.xml"/></content-media>
<content-text><p>The fourth task in the Step-by-Step wizard is to configure which traffic needs protection. </p> <p>To protect all traffic from one IP subnet to another:</p> <p><b>Step 1. </b>From the Traffic to Protect window, click the <b>Protect all traffic between the following subnets</b> radio button.</p> <p><b>Step 2. </b>Define the IP address and subnet mask of the local network where IPsec traffic originates.</p> <p><b>Step 3. </b>Define the IP address and subnet mask of the remote network where IPsec traffic is sent.</p> <p>To specify a Custom ACL (IPsec rule) that defines the traffic types to be protected:</p> <p><b>Step 1. </b>From the Traffic to Protect window, click the <b>Create/Select an access-list for IPSec traffic</b> radio button.</p> <p><b>Step 2. </b>Click the ellipsis (<b>...</b>) button to choose an existing ACL or to create a new one.</p> <p><b>Step 3. </b>To use an existing ACL, choose the <b>Select an existing rule (ACL)</b> option. To create a new ACL, choose the <b>Create a new rule (ACL) and select</b> option.</p></content-text>
</page>
<page type="OneColumn" id="en2008050305">
<content-media type="StaticGraphic" id="cm5246131710">	<title><content-text></content-text></title>	<media ref="en2008000000/en2008050000/en2008050300/en2008050305/cm5246131710.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2008000000/en2008050000/en2008050300/en2008050305/cm5246131710text.xml"/></content-media>
<content-text><p>When creating a new ACL to define traffic that needs protection, a window that lists the created access rule entries is displayed:</p> <p><b>Step 1. </b>Give the access rule a name and description.</p> <p><b>Step 2. </b>Click the <b>Add</b> button to start adding rule entries.</p> <p>After a new ACL is created, entries must be specified within the ACL.</p> <p><b>Step 1. </b>Choose an action from the <b>Select an Action</b> list box and enter a description of the rule entry in the <b>Description</b> text box.</p> <p><b>Step 2. </b>Define the source hosts or networks in the Source Host/Network pane, and the destination hosts or networks in the Destination Host/Network pane. Each rule entry defines one pair of source and destination addresses or networks. Be sure to use wildcard bits and not the subnet mask bits in the Wildcard Mask field.</p> <p><b>Step 3. </b>(Optional) To provide protection for a specific protocol, choose the protocol radio button (TCP, UDP, or ICMP) and the port numbers. If IP is chosen as the protocol, the rule applies to all IP traffic.</p> <p>At the end of the configuration, the wizard presents a summary of the configured parameters. To modify the configuration, click the <b>Back</b> button. Click the <b>Finish</b> button to complete the configuration.</p></content-text>
</page>
</topic>
<topic type="" id="en2008050400">
<title><content-text>Verifying, Monitoring, and Troubleshooting VPNs</content-text></title>
<page type="OneColumn" id="en2008050401">
<content-media type="StaticGraphic" id="cm4886012558">	<title><content-text></content-text></title>	<media ref="en2008000000/en2008050000/en2008050400/en2008050401/cm4886012558.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2008000000/en2008050000/en2008050400/en2008050401/cm4886012558text.xml"/></content-media>
<content-text><p>After the IPsec VPN is configured, it is necessary to test the VPN to verify operation.</p> <p>To test the configuration of the VPN tunnel, choose <b>Configure > VPN > Site-to-Site VPN > Edit Site-to-Site VPN</b> and click the <b>Test Tunnel </b>button. </p> <p>The <b>Generate Mirror</b> button can also be clicked to generate a mirroring configuration that is required on the other end of the tunnel. This is useful if the other router does not have Cisco SDM and must use the command-line interface (CLI) to configure the tunnel.</p></content-text>
</page>
<page type="OneColumn" id="en2008050402">
<content-media type="StaticGraphic" id="cm8739172259">	<title><content-text></content-text></title>	<media ref="en2008000000/en2008050000/en2008050400/en2008050402/cm8739172259.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2008000000/en2008050000/en2008050400/en2008050402/cm8739172259text.xml"/></content-media>
<content-text><p>To see all IPsec tunnels, their parameters, and status, choose <b>Monitor</b> > <b>VPN Status</b> > <b>IPsec</b> <b>Tunnels</b>.</p></content-text>
</page>
</topic>
</section>
<section type="" id="en2008060000">
<title><content-text>Implementing Remote-Access VPNs</content-text></title>
<topic type="" id="en2008060100">
<title><content-text>The Changing Corporate Landscape</content-text></title>
<page type="OneColumn" id="en2008060101">
<content-media type="StaticGraphic" id="cm5138453495">	<title><content-text></content-text></title>	<media ref="en2008000000/en2008060000/en2008060100/en2008060101/cm5138453495.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2008000000/en2008060000/en2008060100/en2008060101/cm5138453495text.xml"/></content-media>
<content-text><p>How many hours are spent by employees traveling to and from work everyday? What if there are traffic jams? How could these hours be put to productive use? The answer is telecommuting. </p> <p>Telecommuting is sometimes referred to as teleworking. Telecommuting employees have flexibility in location and hours. Employers offer telecommuting because they can save on real estate, utility, and other overhead costs. Organizations that have the greatest success with a telecommuting program ensure that telecommuting is voluntary, subject to management discretion, operationally feasible, and results in no additional costs. </p> <p>Telecommuting organizations take full advantage of new technologies and new ways of working. With telecommuting, the focus is on the actual work performed rather than on the location where it is performed. This aspect of telecommuting moves us closer to a global society, allowing individuals across the world to work together. As one of the key workplace transformers of the next decade, there is little doubt that it will inevitably and dramatically reshape how work is performed.</p></content-text>
</page>
<page type="OneColumn" id="en2008060102">
<content-media type="StaticGraphic" id="cm4039496530">	<title><content-text></content-text></title>	<media ref="en2008000000/en2008060000/en2008060100/en2008060102/cm4039496530.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2008000000/en2008060000/en2008060100/en2008060102/cm4039496530text.xml"/></content-media>
<content-text><p>Telecommuting offers organizational, social, and environmental benefits. Studies have shown that telecommuting improves employee lifestyles by decreasing job-related stresses. It can also accommodate those with health problems or disabilities. Telecommuting helps reduce energy consumption by decreasing transportation related pollution. It also increases organizational profits, improves recruitment and retention, and can offer possibilities for increased service and international reach. Telecommuters in different time zones can ensure that a company is virtually open for business around the clock. </p> <p>Although telecommuting has many benefits, there may be some drawbacks. For example, telecommuters working from home can experience distractions that they would not have at work. Additionally, companies that offer telecommuting programs have to manage more risk, because data must travel across public networks, and organizations must rely on employees to maintain secure systems.</p></content-text>
</page>
<page type="OneColumn" id="en2008060103">
<content-media type="StaticGraphic" id="cm1997078322">	<title><content-text></content-text></title>	<media ref="en2008000000/en2008060000/en2008060100/en2008060103/cm1997078322.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2008000000/en2008060000/en2008060100/en2008060103/cm1997078322text.xml"/></content-media>
<content-text><p>Telecommuters typically need high-speed access to the Internet. This access can be provided using broadband connections, such as DSL, Cable or satellite Internet connections. Although a dialup connection can be used to access the Internet, the access speed is very slow and is not generally considered adequate for telecommuting.</p> <p>Laptop or desktop computers are also required, and many implementations also require a VoIP phone to provide seamless telephone services. </p> <p>Security is a huge concern for companies. Remote access to corporate locations is implemented using remote VPN access.</p></content-text>
</page>
</topic>
<topic type="" id="en2008060200">
<title><content-text>Introducing Remote-Access VPNs</content-text></title>
<page type="OneColumn" id="en2008060201">
<content-media type="StaticGraphic" id="cm6003652192">	<title><content-text></content-text></title>	<media ref="en2008000000/en2008060000/en2008060200/en2008060201/cm6003652192.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2008000000/en2008060000/en2008060200/en2008060201/cm6003652192text.xml"/></content-media>
<content-text><p>The ubiquity of the Internet, combined with today's VPN technologies, allows organizations to cost-effectively and securely extend the reach of their networks to anyone, anyplace, anytime.</p> <p>VPNs have become the logical solution for remote-access connectivity for many reasons. VPNs provide secure communications with access rights tailored to individual users, such as employees, contractors, and partners. They also enhance productivity by extending the corporate network and applications securely while reducing communication costs and increasing flexibility. </p> <p>Using VPN technology, employees can essentially take their office, including access to emails and network applications, with them. VPNs can also allow contractors and partners to have limited access to the specific servers, web pages, or files required. This network access allows them to contribute to business productivity without compromising network security.</p> <p>There are two primary methods for deploying remote-access VPNs: </p> <p><ul><li> Secure Sockets Layer (SSL)</li><li> IP Security (IPsec)</li></ul></p></content-text>
</page>
<page type="OneColumn" id="en2008060202">
<content-media type="StaticGraphic" id="cm3162294546">	<title><content-text></content-text></title>	<media ref="en2008000000/en2008060000/en2008060200/en2008060202/cm3162294546.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2008000000/en2008060000/en2008060200/en2008060202/cm3162294546text.xml"/></content-media>
<content-text><p>The type of VPN method implemented is based on the access requirements of the users and the organization's IT processes. </p> <p>Both IPsec and SSL VPN technologies offer access to virtually any network application or resource. SSL VPNs offer such features as easy connectivity from non-company-managed desktops, little or no desktop software maintenance, and user-customized web portals upon login. </p> <p>IPsec exceeds SSL in many significant ways: </p> <p><ul><li> Number of applications that are supported</li><li> Strength of its encryption</li><li> Strength of its authentication</li><li> Overall security</li></ul></p> <p>When security is an issue, IPsec is the superior choice. If support and ease of deployment are the primary issues, consider SSL.</p> <p>IPsec and SSL VPN are complementary because they solve different problems. Depending on its needs, an organization can implement one or both. This complementary approach allows a single device such as an ISR router or an ASA firewall appliance to address all remote-access user requirements. While many solutions offer either IPsec or SSL, Cisco remote-access VPN solutions offer both technologies integrated on a single platform with unified management. Offering both IPsec and SSL technologies enables organizations to customize their remote-access VPN without any additional hardware or management complexity.</p></content-text>
</page>
</topic>
<topic type="" id="en2008060300">
<title><content-text>SSL VPNs</content-text></title>
<page type="OneColumn" id="en2008060301">
<content-media type="StaticGraphic" id="cm7820274444">	<title><content-text></content-text></title>	<media ref="en2008000000/en2008060000/en2008060300/en2008060301/cm7820274444.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2008000000/en2008060000/en2008060300/en2008060301/cm7820274444text.xml"/></content-media>
<content-text><p>Cisco IOS SSL VPN is an emerging technology that provides remote-access connectivity from almost any Internet-enabled location using a web browser and its native SSL encryption. Originally developed by Netscape, SSL has been universally accepted on the Web.</p> <p>SSL VPN does not require a software client to be preinstalled on the endpoint host. It provides remote-access connectivity for corporate resources to any authorized user from any Internet-enabled location.</p> <p>The SSL protocol supports a variety of different cryptographic algorithms for operations such as authenticating the server and client to each other, transmitting certificates, and establishing session keys. Cisco SSL VPN solutions can be customized for businesses of any size. These solutions deliver many remote-access connectivity features and benefits:</p> <p><ul><li> Web-based clientless access and full network access without preinstalled desktop software. This facilitates customized remote access based on user and security requirements, and minimizes desktop support costs. </li><li> Protection against viruses, worms, spyware, and hackers on a VPN connection by integrating network and endpoint security in the Cisco SSL VPN platform. This reduces cost and management complexity by eliminating the need for additional security equipment and management infrastructure. </li><li> Simple, flexible, and cost-effective licensing. SSL uses a single license. There is no per-feature license to purchase or manage. User count upgrades are flexible and cost effective. An implementation can start with as few as 10 users and scale as the needs change.</li><li> Single device for both SSL VPN and IPsec VPN. This reduces cost and management complexity by facilitating robust remote access and site-to-site VPN services from a single platform with unified management.</li></ul></p></content-text>
</page>
<page type="OneColumn" id="en2008060302">
<content-media type="StaticGraphic" id="cm9341855152">	<title><content-text></content-text></title>	<media ref="en2008000000/en2008060000/en2008060300/en2008060302/cm9341855152.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2008000000/en2008060000/en2008060300/en2008060302/cm9341855152text.xml"/></content-media>
<content-text><p>SSL VPNs provide different types of access: </p> <p><ul><li> Clientless </li><li> Thin client </li><li> Full client</li></ul></p> <p>SSL VPN provides three modes of remote access on Cisco IOS routers: clientless, thin client, and full client. ASA devices have two modes: clientless (which includes clientless and thin client port forwarding) and AnyConnect client (which replaces full tunnel).</p> <p><b>Clientless Access Mode</b></p> <p>In clientless mode, the remote user accesses the internal or corporate network using a web browser on the client machine. Clientless access requires no specialized VPN software or applet on the user desktop. All VPN traffic is transmitted and delivered through a standard web browser. No other software is required, eliminating many support issues. Using a clientless connection, all web-enabled and some client/server applications, such as intranets, applications with Web interfaces, email, calendaring, and file servers, can be accessed. </p> <p>Not all client/server applications are accessible to SSL clients; however, this limited access is often a perfect fit for business partners or contractors who should have access only to a limited set of resources on the organization's network. It does not work for employees that require full network access.</p> <p><b>Thin Client Mode</b></p> <p>Thin client mode, sometimes called TCP port forwarding, assumes that the client application uses TCP to connect to a well-known server and port. In this mode, the remote user downloads a Java applet by clicking the link provided on the portal page. The Java applet acts as a TCP proxy on the client machine for the services configured on the SSL VPN gateway. The Java applet starts a new SSL connection for every client connection.</p> <p>The Java applet initiates an HTTP request from the remote user client to the SSL VPN gateway. The name and port number of the internal email server is included in the HTTP request. The SSL VPN gateway creates a TCP connection to that internal email server and port.</p> <p>Thin client mode is often referred to as a type of clientless mode and can be used anywhere that clientless VPNs are supported. It extends the capability of the cryptographic functions of the web browser to enable remote access to TCP-based applications such as POP3, SMTP, IMAP, Telnet, and SSH.</p></content-text>
</page>
<page type="OneColumn" id="en2008060303">
<content-media type="StaticGraphic" id="cm8624382350">	<title><content-text></content-text></title>	<media ref="en2008000000/en2008060000/en2008060300/en2008060303/cm8624382350.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2008000000/en2008060000/en2008060300/en2008060303/cm8624382350text.xml"/></content-media>
<content-text><p><b>Full Tunnel Client Access Mode</b></p> <p>Full tunnel client mode enables access to the corporate network completely over an SSL VPN tunnel, which is used to move data at the Network (IP) Layer. This mode supports most IP-based applications, such as Microsoft Outlook, Microsoft Exchange, Lotus Notes Email, and Telnet. Being part of the SSL VPN is transparent to the applications run on the client. A Java applet is downloaded to handle the tunneling between the client host and the SSL VPN gateway. The user can use any application as if the client host was on the internal network.</p> <p>This VPN client, because it is dynamically downloaded and updated without any manual software distribution or interaction from the end user, requires little or no desktop support by IT organizations, thereby minimizing deployment and operations costs. Like clientless access, full network access offers full access control customization based on the access privileges of the end user. Full network access is a natural choice for employees who need remote access to the same applications and network resources that they use when in the office or for any client/server application that cannot be delivered across a web-based clientless connection.</p></content-text>
</page>
<page type="OneColumn" id="en2008060304">
<content-media type="StaticGraphic" id="cm7127842655">	<title><content-text></content-text></title>	<media ref="en2008000000/en2008060000/en2008060300/en2008060304/cm7127842655.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2008000000/en2008060000/en2008060300/en2008060304/cm7127842655text.xml"/></content-media>
<content-text><p>Establishing an SSL session involves a few steps:</p> <p><b>Step 1.  </b>The user makes an outbound connection to TCP port 443.</p> <p><b>Step 2.  </b>The router responds with a digital certificate, which contains a public key that is digitally signed by a trusted certificate authority (CA).</p> <p><b>Step 3.  </b>The user's computer generates a shared secret key that both parties use.</p> <p><b>Step 4.  </b>The shared secret is encrypted with the public key of the router and transmitted to the router. The router software is able to easily decrypt the packet using its private key. Now both participants in the session know the shared secret key.</p> <p><b>Step 5.  </b>The key is used to encrypt the SSL session. </p> <p>SSL utilizes encryption algorithms with key lengths from 40 to 128 bits.</p></content-text>
</page>
<page type="OneColumn" id="en2008060305">
<content-media type="StaticGraphic" id="cm5451069842">	<title><content-text></content-text></title>	<media ref="en2008000000/en2008060000/en2008060300/en2008060305/cm5451069842.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2008000000/en2008060000/en2008060300/en2008060305/cm5451069842text.xml"/></content-media>
<content-text><p>Before SSL VPN services are implemented in Cisco IOS routers, the current environment must be analyzed to determine which features and modes might be useful in the implementation. </p> <p>There are many SSL VPN design considerations:</p> <p><ul><li> <b>User connectivity</b> - Determine whether the users connect to the corporate network from public shared computers, such as a computer in a library or at an Internet kiosk. In this case, use clientless SSL VPN mode.</li><li> <b>Router feature</b> - A Cisco IOS router can run various features, such as IPsec VPN tunnels, routing engines, and firewall processes. Enabling the SSL VPN feature can add considerable load if the router is already running a number of features.</li><li> <b>Router hardware</b> - The SSL VPN process is fairly CPU and memory intensive. Before implementing an SSL VPN on the Cisco IOS router, make sure to leverage the hardware-accelerated SSL VPN engines such as AIM-VPN/SSL-1, AIM-VPN/SSL-2, and AIM-VPN/SSL-3. Check www.cisco.com for more information about the SSL VPN hardware modules.</li><li> <b>Infrastructure planning</b> - It is important to consider the placement of the VPN termination devices. Before implementing the SSL VPN feature in Cisco IOS, ask questions such as: Should the SSL VPN be placed behind a firewall? If so, what ports should be opened? Should the decrypted traffic be passed through another set of firewalls? If so, what ports should be allowed? </li><li> <b>Implementation scope - </b>Network security administrators need to determine the size of the SSL VPN deployment, especially the number of simultaneous users that will connect to gain network access. If one Cisco IOS router is not enough to support the required number of users, traditional load balancers or server-clustering schemes must be considered to accommodate all potential remote users.</li></ul></p> <p>SSL VPNs are a viable option for many organizations, however, the configuration of SSL VPNs is beyond the scope of this course. Visit <content-link target="http://www.cisco.com" type="external">www.cisco.com</content-link> to learn about the required configuration commands to implement SSL VPNs as well as to download reference guides.</p></content-text>
</page>
</topic>
<topic type="" id="en2008060400">
<title><content-text>Cisco Easy VPN</content-text></title>
<page type="OneColumn" id="en2008060401">
<content-media type="StaticGraphic" id="cm6395214627">	<title><content-text></content-text></title>	<media ref="en2008000000/en2008060000/en2008060400/en2008060401/cm6395214627.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2008000000/en2008060000/en2008060400/en2008060401/cm6395214627text.xml"/></content-media>
<content-text><p>While SSL VPNs are useful in many instances, many applications require the security of an IPsec VPN connection for authentication and to encrypt data. Establishing a VPN connection between two sites can be complicated and typically requires coordination between the network administrators at each site to configure the VPN parameters. When deploying VPNs for telecommuters and small branch offices, ease of deployment is critical if technical resources are not available for VPN configuration on the remote site router.</p> <p>The Cisco Easy VPN solution feature offers flexibility, scalability, and ease of use for site-to-site and remote-access VPNs. It consists of three components: </p> <p><ul><li> <b>Cisco Easy VPN Server</b> - A Cisco IOS router or Cisco PIX / ASA Firewall acting as the VPN head-end device in site-to-site or remote-access VPNs. </li><li> <b>Cisco Easy VPN Remote</b> - A Cisco IOS router or Cisco PIX / ASA Firewall acting as a remote VPN client.</li><li> <b>Cisco Easy VPN Client - </b>An application supported on a PC used to access a Cisco VPN server. </li></ul></p> <p>Most of the VPN parameters are defined on the Cisco IOS Easy VPN Server to simplify deployment. When a remote client initiates a VPN tunnel connection, the Cisco Easy VPN Server pushes the IPsec policies to the client and creates the corresponding IPsec VPN tunnel connection.</p> <p>The remote devices can be mobile workers running the Cisco Easy VPN client software on PCs to easily establish VPN connections with the Cisco Easy VPN Server-enabled device through the Internet. It can also be a Cisco device running the Cisco Easy VPN Remote feature, enabling it to be a client of the Easy VPN Server. This means that individuals at small branch offices no longer need to run VPN client software on their PCs.</p></content-text>
</page>
<page type="OneColumn" id="en2008060402">
<content-media type="StaticGraphic" id="cm5579776611">	<title><content-text></content-text></title>	<media ref="en2008000000/en2008060000/en2008060400/en2008060402/cm5579776611.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2008000000/en2008060000/en2008060400/en2008060402/cm5579776611text.xml"/></content-media>
<content-text><p>The Cisco Easy VPN Server makes it possible for mobile and remote workers using VPN Client software on their PCs to create secure IPsec tunnels to access their headquarters' intranet where critical data and applications exist. It enables Cisco IOS routers and Cisco PIX and ASA Firewalls to act as VPN head-end devices in site-to-site or remote-access VPNs. Remote office devices use the Cisco Easy VPN Remote feature or the Cisco VPN Client application to connect to the server, which then pushes defined security policies to the remote VPN device. This ensures that those connections have up-to-date policies in place before the connection is established. </p> <p>The Cisco Easy VPN Remote enables Cisco IOS routers, Cisco PIX Firewalls, and Cisco VPN 3002 hardware clients or software clients to act as remote VPN clients. These devices can receive security policies from a Cisco Easy VPN Server, minimizing VPN configuration requirements at the remote location. This cost-effective solution is ideal for remote offices with little IT support or for large customer premises equipment (CPE) deployments where it is impractical to individually configure multiple remote devices. </p></content-text>
</page>
<page type="OneColumn" id="en2008060403">
<content-media type="StaticGraphic" id="cm7426786425">	<title><content-text></content-text></title>	<media ref="en2008000000/en2008060000/en2008060400/en2008060403/cm7426786425.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2008000000/en2008060000/en2008060400/en2008060403/cm7426786425text.xml"/></content-media>
<content-text><p>When a client connects to a server, the negotiation to secure the VPN occurs:</p> <p><b>1. </b>The VPN client initiates the IKE Phase 1 process. If a pre-shared key is used for authentication, the VPN Client initiates aggressive mode. If digital certificates are used for authentication, the VPN Client initiates main mode. </p> <p><b>2.</b>  The VPN client establishes an ISAKMP SA. To reduce the amount of manual configuration on the VPN Client, Easy VPN ISAKMP proposals include every combination of encryption and hash algorithms, authentication methods, and DH group sizes.</p> <p><b>3.</b>  The Easy VPN Server accepts the SA proposal. The ISAKMP policy can consist of several proposals, but the Easy VPN Server uses the first match, so always configure the most secure policies first. Device authentication ends and user authentication begins at this point.</p> <p><b>4.</b> The Easy VPN Server initiates a username and password challenge. The information that is entered is checked against authentication entities using authentication, authorization, and accounting (AAA) protocols such as RADIUS and TACACS+. Token cards can also be used via AAA proxy. VPN devices that are configured to handle remote VPN clients should always enforce user authentication.</p> <p><b>5.</b> The mode configuration process is initiated. The remaining system parameters (IP address, DNS, split tunnel attributes, and so on) are pushed to the VPN client at this time using mode configuration. </p> <p><b>6.</b> The reverse route injection (RRI) process is initiated. RRI ensures that a static route is created on the Cisco Easy VPN Server for the internal IP address of each VPN client.</p> <p><b>7.</b> IPsec quick mode completes the connection. The connection is complete after IPsec SAs have been created.</p></content-text>
</page>
</topic>
<topic type="" id="en2008060500">
<title><content-text>Configure a VPN Server with SDM</content-text></title>
<page type="OneColumn" id="en2008060501">
<content-media type="StaticGraphic" id="cm4423870042">	<title><content-text></content-text></title>	<media ref="en2008000000/en2008060000/en2008060500/en2008060501/cm4423870042.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2008000000/en2008060000/en2008060500/en2008060501/cm4423870042text.xml"/></content-media>
<content-text><p>Configuring Cisco Easy VPN Server functionality using SDM consists of two major tasks:</p> <p><b>Task 1.</b> Configure prerequisites, such as AAA, privileged users, and the enable secret password, based on the chosen VPN design.</p> <p><b>Task 2.</b> Configure the Cisco Easy VPN Server.</p> <p>From the SDM main page, click the <b>Configure</b> button, then click the <b>VPN Task</b> button and select the Easy VPN Server option. If AAA has not been previously configured, the wizard asks to configure it. If AAA is disabled on the router, configure AAA before Easy VPN Server configuration begins and create at least one administrative user.</p></content-text>
</page>
<page type="OneColumn" id="en2008060502">
<content-media type="StaticGraphic" id="cm9082715084">	<title><content-text></content-text></title>	<media ref="en2008000000/en2008060000/en2008060500/en2008060502/cm9082715084.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2008000000/en2008060000/en2008060500/en2008060502/cm9082715084text.xml"/></content-media>
<content-text><p>After the Easy VPN Server wizard is launched, the Interface and Authentication window displays. Specify the router interface where the VPN connection will terminate (e.g., Unnumbered to Serial 0/0/1) and the authentication method (e.g., pre-shared keys or digital certificates).</p> <p>Click <b>Next</b> to display the IKE Proposals window. When configuring IKE proposals, use the default policy that is predefined by SDM or add a custom IKE Policy specifying these required parameters:</p> <p><ul><li> IKE policy priority</li><li> Authentication (PRE-SHARE or RSA-SIG)</li><li> D-H group (1, 2, or 5)</li><li> Encryption algorithm (DES, 3DES or AES)</li><li> Hash (SHA-1 or MD5)</li><li> IKE lifetime </li></ul></p></content-text>
</page>
<page type="OneColumn" id="en2008060503">
<content-media type="StaticGraphic" id="cm1663893630">	<title><content-text></content-text></title>	<media ref="en2008000000/en2008060000/en2008060500/en2008060503/cm1663893630.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2008000000/en2008060000/en2008060500/en2008060503/cm1663893630text.xml"/></content-media>
<content-text><p>Cisco SDM provides a default transform set. Use the default or create a new IPsec transform set configuration using these parameters:</p> <p><ul><li> Transform set name </li><li> Encryption algorithm (DES, 3DES, AES, or SEAL) </li><li> HMAC (SHA-1 or MD5) </li><li> Optional compression </li><li> Mode of operation (tunnel or transport)</li></ul></p></content-text>
</page>
<page type="OneColumn" id="en2008060504">
<content-media type="StaticGraphic" id="cm3697910097">	<title><content-text></content-text></title>	<media ref="en2008000000/en2008060000/en2008060500/en2008060504/cm3697910097.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2008000000/en2008060000/en2008060500/en2008060504/cm3697910097text.xml"/></content-media>
<content-text><p>The Group Authorization and Group Policy Lookup window appears next. There are three options to choose from for the location where Easy VPN group policies can be stored:</p> <p><ul><li> <b>Local</b> - All groups are in the router configuration in NVRAM. </li><li> <b>RADIUS</b> - The router uses the RADIUS server for group authorization. </li><li> <b>RADIUS and Local</b> - The router can look up policies stored in an AAA server database that can be reached via RADIUS.</li></ul></p> <p>Click <b>Next</b> to configure the Group Authorization parameters. Click the <b>Add</b> button to add a new group policy. The General tab allows configuration of the following parameters:</p> <p><ul><li> Group name</li><li> Pre-shared keys</li><li> IP Address pool information</li><li> Maximum connections allowed</li></ul></p> <p>Other tabs address the following options:</p> <p><ul><li> DNS/WINS</li><li> Split Tunneling</li><li> Client Settings</li><li> XAuth Options</li><li> Client Update </li></ul></p></content-text>
</page>
<page type="OneColumn" id="en2008060505">
<content-media type="StaticGraphic" id="cm8425338253">	<title><content-text></content-text></title>	<media ref="en2008000000/en2008060000/en2008060500/en2008060505/cm8425338253.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2008000000/en2008060000/en2008060500/en2008060505/cm8425338253text.xml"/></content-media>
<content-text><p>After all the steps are completed, the Easy VPN Server wizard presents a summary of the configured parameters. Click <b>Back</b> to correct any errors in the configuration. Otherwise, click <b>Finish</b> to apply the configuration to the router.</p> <p>The Easy VPN Server configuration can then be verified. Run a test to confirm the correct tunnel configuration by clicking the <b>Test VPN Server</b> button at the bottom of the Edit Easy VPN Server page. This will present the VPN Troubleshooting window which displays the VPN validation results.</p></content-text>
</page>
</topic>
<topic type="" id="en2008060600">
<title><content-text>Connect with a VPN Client</content-text></title>
<page type="OneColumn" id="en2008060601">
<content-media type="StaticGraphic" id="cm7548650611">	<title><content-text></content-text></title>	<media ref="en2008000000/en2008060000/en2008060600/en2008060601/cm7548650611.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2008000000/en2008060000/en2008060600/en2008060601/cm7548650611text.xml"/></content-media>
<content-text><p>The Cisco VPN Client is simple to deploy and operate. It allows organizations to establish end-to-end, encrypted VPN tunnels for secure connectivity for mobile employees or telecommuters. This thin design IPsec-implementation is compatible with all Cisco VPN products.</p> <p>When preconfigured for mass deployments, initial logins require little user intervention. Cisco VPN Client supports the innovative Cisco Easy VPN capabilities, delivering a uniquely scalable, cost-effective, and easy-to-manage remote access VPN architecture that eliminates the operational costs associated with maintaining a consistent policy and key management method.</p> <p>The Cisco Easy VPN feature allows the Cisco VPN Client to receive security policies on a VPN tunnel connection from the central site VPN device (Cisco Easy VPN Server), minimizing configuration requirements at the remote location. This simple and highly scalable solution is ideal for large remote access deployments where it is impractical to configure policies individually for multiple remote PCs.</p></content-text>
</page>
<page type="OneColumn" id="en2008060602">
<content-media type="StaticGraphic" id="cm1560522291">	<title><content-text></content-text></title>	<media ref="en2008000000/en2008060000/en2008060600/en2008060602/cm1560522291.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2008000000/en2008060000/en2008060600/en2008060602/cm1560522291text.xml"/></content-media>
<content-text><p>When the Cisco Easy VPN client is installed, open the Cisco Easy VPN client window to start an IPsec VPN connection on a PC. </p> <p>The application lists the available preconfigured sites. Double-click a site. In the user authentication dialog box, authenticate to the site. After authentication, the Cisco Easy VPN Client displays a connected status. </p> <p>Configuring the Easy VPN client is beyond the scope of this course. Check <content-link target="http://www.cisco.com" type="external">www.cisco.com</content-link> for more information.</p></content-text>
</page>
</topic>
</section>
<section type="ChapterSummary" id="en2008070000">
<title><content-text>Chapter Summary</content-text></title>
<topic type="" id="en2008070100">
<title><content-text>Chapter Summary</content-text></title>
<page type="FullScreen" id="en2008070101">
<content-media type="StaticGraphic" id="cm1628807779">	<title><content-text></content-text></title>	<media ref="en2008000000/en2008070000/en2008070100/en2008070101/cm1628807779.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2008000000/en2008070000/en2008070100/en2008070101/cm1628807779text.xml"/></content-media>
<content-text></content-text>
</page>
</topic>
</section>
</chapter>
