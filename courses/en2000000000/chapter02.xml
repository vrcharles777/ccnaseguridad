<chapter type="" id="en2002000000">
<title><content-text>Securing Network Devices</content-text></title>
<section type="ChapterIntroduction" id="en2002000000">
<title><content-text>Chapter Introduction</content-text></title>
<topic type="" id="en2002000100">
<title><content-text>Chapter Introduction</content-text></title>
<page type="OneColumn" id="en2002000101">
<content-media type="StaticGraphic" id="cm6917788012">	<title><content-text></content-text></title>	<media ref="en2002000000/en2002000000/en2002000100/en2002000101/cm6917788012.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2002000000/en2002000000/en2002000100/en2002000101/cm6917788012text.xml"/></content-media>
<content-text><p>Securing outgoing network traffic and scrutinizing incoming traffic are critical aspects of network security. Securing the edge router, which connects to the outside network, is an important first step in securing the network. </p> <p>Device hardening is an essential task that must never be overlooked. It involves implementing proven methods for physically securing the router and protecting the router's administrative access using the Cisco IOS command-line interface (CLI) as well as the Cisco Router and Security Device Manager (SDM). Some of these methods involve securing administrative access, including maintaining passwords, configuring enhanced virtual login features, and implementing Secure Shell (SSH). Because not all information technology personnel should have the same level of access to the infrastructure devices, defining administrative roles in terms of access is another important aspect of securing infrastructure devices. </p> <p>Securing the management and reporting features of Cisco IOS devices is also important. Recommended practices for securing syslog, using Simple Network Management Protocol (SNMP), and configuring Network Time Protocol (NTP) are examined.</p> <p>Many router services are enabled by default. A number of these features are enabled for historical reasons but are no longer required today. This chapter discusses some of these services and examines router configurations with the Security Audit feature of Cisco SDM. This chapter also examines the one-step lockdown Cisco SDM feature and the <span class="cmd"><b>auto secure</b></span> command, which can be used to automate device hardening tasks.</p></content-text>
</page>
</topic>
</section>
<section type="" id="en2002010000">
<title><content-text>Securing Device Access</content-text></title>
<topic type="" id="en2002010100">
<title><content-text>Securing the Edge Router</content-text></title>
<page type="OneColumn" id="en2002010101">
<content-media type="StaticGraphic" id="cm2013689036">	<title><content-text></content-text></title>	<media ref="en2002000000/en2002010000/en2002010100/en2002010101/cm2013689036.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2002000000/en2002010000/en2002010100/en2002010101/cm2013689036text.xml"/></content-media>
<content-text><p>Securing the network infrastructure is critical to overall network security. The network infrastructure includes routers, switches, servers, endpoints, and other devices. </p> <p>Consider a disgruntled employee casually looking over the shoulder of a network administrator while the administrator is logging in to an edge router. This is known as shoulder surfing, and it is a surprisingly easy way for an attacker to gain unauthorized access. If an attacker gains access to a router, the security and management of the entire network can be compromised, leaving servers and endpoints at risk. It is critical that the appropriate security policies and controls be implemented to prevent unauthorized access to all infrastructure devices. Although all infrastructure devices are at risk, routers are a primary target for network attackers. This is because routers act as traffic police, directing traffic into, out of and between networks. The edge router is the last router between the internal network and an untrusted network such as the Internet. All of an organization's Internet traffic goes through this edge router; therefore, it often functions as the first and last line of defense for a network. Through initial and final filtering, the edge router helps to secure the perimeter of a protected network. It is also responsible for implementing security actions that are based on the security policies of the organization. For these reasons, securing network routers is imperative.</p></content-text>
</page>
<page type="OneColumn" id="en2002010102">
<content-media type="StaticGraphic" id="cm5137855913">	<title><content-text></content-text></title>	<media ref="en2002000000/en2002010000/en2002010100/en2002010102/cm5137855913.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2002000000/en2002010000/en2002010100/en2002010102/cm5137855913text.xml"/></content-media>
<content-text><p>The edge router implementation varies depending on the size of the organization and the complexity of the required network design. Router implementations can include a single router protecting an entire inside network or a router as the first line of defense in a defense-in-depth approach. </p> <p><b>Single Router Approach</b></p> <p>In the single router approach, a single router connects the protected network, or internal LAN, to the Internet. All security policies are configured on this device. This is more commonly deployed in smaller site implementations such as branch and SOHO sites. In smaller networks, the required security features can be supported by ISRs without impeding the router's performance capabilities.</p> <p><b>Defense-in-Depth Approach</b></p> <p>A defense-in-depth approach is more secure than the single router approach. In this approach, the edge router acts as the first line of defense and is known as a screening router. It passes all connections that are intended for the internal LAN to the firewall.</p> <p>The second line of defense is the firewall. The firewall typically picks up where the edge router leaves off and performs additional filtering. It provides additional access control by tracking the state of the connections and acts as a chokepoint device. </p> <p>The edge router has a set of rules specifying which traffic it allows and denies. By default, the firewall denies the initiation of connections from the outside (untrusted) networks to the inside (trusted) network. However, it allows the internal users to establish connections to the untrusted networks and permits the responses to come back through the firewall. It can also perform user authentication (authentication proxy) where users must be authenticated to gain access to network resources.</p> <p><b>DMZ Approach</b></p> <p>A variation of the defense-in-depth approach is to offer an intermediate area, often called the demilitarized zone (DMZ). The DMZ can be used for servers that must be accessible from the Internet or some other external network. The DMZ can be set up between two routers, with an internal router connecting to the protected network and an external router connecting to the unprotected network, or simply be an additional port off of a single router. The firewall, located between the protected and unprotected networks, is set up to permit the required connections (for example, HTTP) from the outside (untrusted) networks to the public servers in the DMZ. The firewall serves as the primary protection for all devices on the DMZ. In the DMZ approach, the router provides some protection by filtering some traffic, but leaves the bulk of the protection to the firewall.</p> <p><i>(The focus of this course is on ISR security features, including explanations of how to configure these features. With respect to the Cisco Adaptive Security Appliance (ASA), the discussion is limited to design implementation in this course. For ASA device configuration, see <content-link target="http://www.cisco.com" type="external">www.cisco.com</content-link>.)</i></p></content-text>
</page>
<page type="OneColumn" id="en2002010103">
<content-media type="StaticGraphic" id="cm9419127937">	<title><content-text></content-text></title>	<media ref="en2002000000/en2002010000/en2002010100/en2002010103/cm9419127937.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2002000000/en2002010000/en2002010100/en2002010103/cm9419127937text.xml"/></content-media>
<content-text><p>Securing the edge router is a critical first step in securing the network. If there are other internal routers, they must be securely configured as well. Three areas of router security must be maintained.</p> <p><b>Physical Security</b></p> <p>Provide physical security for the routers:</p> <p><ul><li>Place the router and physical devices that connect to it in a secure locked room that is accessible only to authorized personnel, is free of electrostatic or magnetic interference, and has controls for temperature and humidity.</li><li>Install an uninterruptible power supply (UPS) and keep spare components available. This reduces the possibility of a DoS attack from power loss to the building.</li></ul></p> <p><b>Operating System Security</b></p> <p>Secure the features and performance of the router operating systems:</p> <p><ul><li>Configure the router with the maximum amount of memory possible. The availability of memory can help protect the network from some DoS attacks, while supporting the widest range of security services. </li><li>Use the latest stable version that meets the feature requirements of the network. Security features in an operating system evolve over time. Keep in mind that the latest version of an operating system might not be the most stable version available. </li><li>Keep a secure copy of the router operating system image and router configuration file as a backup.</li></ul></p> <p><b>Router Hardening</b></p> <p>Eliminate potential abuse of unused ports and services:</p> <p><ul><li>Secure administrative control. Ensure that only authorized personnel have access and that their level of access is controlled.</li><li>Disable unused ports and interfaces. Reduce the number of ways a device can be accessed.</li><li>Disable unnecessary services. Similar to many computers, a router has services that are enabled by default. Some of these services are unnecessary and can be used by an attacker to gather information or for exploitation.</li></ul></p></content-text>
</page>
<page type="OneColumn" id="en2002010104">
<content-media type="StaticGraphic" id="cm2420347406">	<title><content-text></content-text></title>	<media ref="en2002000000/en2002010000/en2002010100/en2002010104/cm2420347406.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2002000000/en2002010000/en2002010100/en2002010104/cm2420347406text.xml"/></content-media>
<content-text><p>Administrative access is required for router management purposes; therefore, securing administrative access is an extremely important security task. If an unauthorized person were to gain administrative access to a router, that person could alter routing parameters, disable routing functions, or discover and gain access to other systems in the network.</p> <p>Several important tasks are involved in securing administrative access to an infrastructure device:</p> <p><ul><li><b>Restrict device accessibility</b> - Limit the accessible ports, restrict the permitted communicators, and restrict the permitted methods of access. </li><li><b>Log and account for all access</b> - For auditing purposes, record anyone who accesses a device, including what occurs and when.</li><li><b>Authenticate access</b> - Ensure that access is granted only to authenticated users, groups, and services. Limit the number of failed login attempts and the time between logins. </li><li><b>Authorize actions</b> - Restrict the actions and views permitted by any particular user, group, or service.</li><li><b>Present Legal Notification</b> - Display a legal notice, developed in conjunction with company legal counsel, for interactive sessions.</li><li><b>Ensure the confidentiality of data</b> - Protect locally stored sensitive data from viewing and copying. Consider the vulnerability of data in transit over a communication channel to sniffing, session hijacking, and man-in-the-middle (MITM) attacks.</li></ul></p></content-text>
</page>
<page type="OneColumn" id="en2002010105">
<content-media type="StaticGraphic" id="cm3932345185">	<title><content-text></content-text></title>	<media ref="en2002000000/en2002010000/en2002010100/en2002010105/cm3932345185.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2002000000/en2002010000/en2002010100/en2002010105/cm3932345185text.xml"/></content-media>
<content-text><p>There are two ways to access a device for administrative purposes, locally and remotely.</p> <p>All network infrastructure devices can be accessed locally. Local access to a router usually requires a direct connection to a console port on the Cisco router using a computer that is running terminal emulation software. </p> <p>Some network devices can be accessed remotely. Remote access typically involves allowing Telnet, Secure Shell (SSH), HTTP, HTTPS, or Simple Network Management Protocol (SNMP) connections to the router from a computer. The computer can be on the same subnet or a different subnet. Some remote access protocols send the data, including usernames and passwords, to the router in plaintext. If an attacker can collect network traffic while an administrator is remotely logged in to a router, the attacker can capture passwords or router configuration information. </p> <p>For this reason, it is preferable to allow only local access to the router. However, remote access might still be necessary. When accessing the network remotely, a few precautions should be taken:</p> <p><ul><li>Encrypt all traffic between the administrator computer and the router. For example, instead of using Telnet, use SSH. Or instead of using HTTP, use HTTPS.</li><li>Establish a dedicated management network. The management network should include only identified administration hosts and connections to a dedicated interface on the router. </li><li>Configure a packet filter to allow only the identified administration hosts and preferred protocols to access the router. For example, permit only SSH requests from the IP address of the administration host to initiate a connection to the routers in the network.</li></ul></p> <p>These precautions are valuable, but they do not protect the network completely. Other lines of defense must also be implemented. One of the most basic and important is the use of a secure password.</p></content-text>
</page>
</topic>
<topic type="" id="en2002010200">
<title><content-text>Configuring Secure Administrative Access</content-text></title>
<page type="OneColumn" id="en2002010201">
<content-media type="StaticGraphic" id="cm5630123151">	<title><content-text></content-text></title>	<media ref="en2002000000/en2002010000/en2002010200/en2002010201/cm5630123151.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2002000000/en2002010000/en2002010200/en2002010201/cm5630123151text.xml"/></content-media>
<content-text><p>Attackers deploy various methods of discovering administrative passwords. They can shoulder surf, attempt to guess passwords based on the user's personal information, or sniff TFTP packets containing plaintext configuration files. Attackers can also use tools such as L0phtCrack and Cain &amp; Abel to attempt brute force attacks and guess passwords. </p> <p>To protect assets such as routers and switches, follow these common guidelines for choosing strong passwords. These guidelines are designed to make passwords less easily discovered by intelligent guessing and cracking tools:</p> <p><ul><li>Use a password length of 10 or more characters. The longer, the better.</li><li>Make passwords complex. Include a mix of uppercase and lowercase letters, numbers, symbols, and spaces. </li><li>Avoid passwords based on repetition, dictionary words, letter or number sequences, usernames, relative or pet names, biographical information, such as birthdates, ID numbers, ancestor names, or other easily identifiable pieces of information..</li><li>Deliberately misspell a password. For example, Smith = Smyth = 5mYth or Security = 5ecur1ty.</li><li>Change passwords often. If a password is unknowingly compromised, the window of opportunity for the attacker to use the password is limited.</li><li>Do not write passwords down and leave them in obvious places such as on the desk or monitor.</li></ul></p> <p>On Cisco routers and many other systems, password-leading spaces are ignored, but spaces after the first character are not ignored. Therefore, one method to create a strong password is to use the space bar in the password and create a phrase made of many words. This is called a pass phrase. A pass phrase is often easier to remember than a simple password. It is also longer and harder to guess.</p> <p>Administrators should ensure that strong passwords are used across the network. One way to accomplish this is to use the same cracking and brute force attack tools that attackers use as a way to verify password strength.</p></content-text>
</page>
<page type="OneColumn" id="en2002010202">
<content-media type="StaticGraphic" id="cm1731849348">	<title><content-text></content-text></title>	<media ref="en2002000000/en2002010000/en2002010200/en2002010202/cm1731849348.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2002000000/en2002010000/en2002010200/en2002010202/cm1731849348text.xml"/></content-media>
<content-text><p>Many access ports require passwords on a Cisco router, including the console port, auxiliary port, and virtual terminal connections. Password management in a large network should be maintained using a central TACACS+ or RADIUS authentication server such as the Cisco Secure Access Control Server (ACS). All routers must be configured with the user and privileged EXEC passwords. A local username database is also recommended as backup if access to an authentication, authorization, and accounting (AAA) server is compromised. Using a password and assigning privilege levels is a simple way to provide terminal access control in a network. Passwords must be established for privileged EXEC mode access and individual lines such as the console and auxiliary lines.</p> <p><b>Enable Secret Password</b></p> <p>The <span class="cmd"><b>enable secret </b><i>password</i></span> global configuration command restricts access to privileged EXEC mode. The enable secret password is always hashed inside the router configuration using a Message Digest 5 (MD5) hashing algorithm. If the enable secret password is lost or forgotten, it must be replaced using the Cisco router password recovery procedure.</p> <p><b>Console Line</b> </p> <p>By default, the console port does not require a password for console administrative access; however, it should always be configured as a console port line-level password. Use the <span class="cmd"><b>line console 0</b></span> command followed by the <span class="cmd"><b>login</b></span> and <span class="cmd"><b>password</b></span> subcommands to require login and establish a login password on the console line.</p> <p><b>Virtual Terminal Lines</b> </p> <p>By default, Cisco routers support up to five simultaneous virtual terminal vty (Telnet or SSH) sessions. On the router, the vty ports are numbered from 0 through 4. Use the <span class="cmd"><b>line vty 0 4</b></span> command followed by the <span class="cmd"><b>login</b></span> and <span class="cmd"><b>password</b></span> subcommands to require login and establish a login password on incoming Telnet sessions.</p> <p><b>Auxiliary Line</b></p> <p>By default, Cisco router auxiliary ports do not require a password for remote administrative access. Administrators sometimes use this port to remotely configure and monitor the router using a dialup modem connection.</p> <p>To access the auxiliary line use the <span class="cmd"><b>line aux 0</b></span> command. Use the <span class="cmd"><b>login</b></span> and <span class="cmd"><b>password</b></span> subcommands to require login and establish a login password on incoming connections. </p> <p>By default, with the exception of the enable secret password, all Cisco router passwords are stored in plain text within the router configuration. These passwords can be viewed with the <span class="cmd"><b>show running-config</b></span> command. Sniffers can also see these passwords if the TFTP server configuration files traverse an unsecured intranet or Internet connection. If an intruder gains access to the TFTP server where the router configuration files are stored, the intruder is able to obtain these passwords.</p></content-text>
</page>
<page type="OneColumn" id="en2002010203">
<content-media type="StaticGraphic" id="cm8124716679">	<title><content-text></content-text></title>	<media ref="en2002000000/en2002010000/en2002010200/en2002010203/cm8124716679.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2002000000/en2002010000/en2002010200/en2002010203/cm8124716679text.xml"/></content-media>
<content-text><p>To increase the security of passwords, the following should be configured:</p> <p><ul><li>Enforce minimum password lengths.</li><li>Disable unattended connections.</li><li>Encrypt all passwords in the configuration file.</li></ul></p> <p><b>Minimum Character Length</b></p> <p>Beginning with the Cisco IOS Release 12.3(1) and later, administrators can set the minimum character length for all router passwords from 0 to 16 characters using the global configuration command <span class="cmd"><b>security passwords min-length </b><i>length</i></span>. It is strongly recommended that the minimum password length be set to at least 10 characters to eliminate common passwords that are short and prevalent on most networks, such "lab" and "cisco". </p> <p>This command affects user passwords, enable secret passwords, and line passwords that are created after the command is executed. Existing router passwords remain unaffected. Any attempt to create a new password that is less than the specified length fails and results in an error message similar to the following:</p> <p><span class="cmd"><b>Password too short - must be at least 10 characters. Password configuration failed.</b></span></p> <p><b>Disable Unattended Connections</b></p> <p>By default, an administrative interface stays active and logged in for 10 minutes after the last session activity. After that, the interface times out and logs out of the session. </p> <p>If an administrator is away from the terminal while the console connection is active, an attacker has up to 10 minutes to gain privilege level access. It is recommended that these timers be fine-tuned to limit the amount of time to within a two or three minute maximum. These timers can be adjusted using the <span class="cmd"><b>exec-timeout</b></span> command in line configuration mode for each of the line types that are used.</p> <p>It is also possible to turn off the exec process for a specific line, such as on the auxiliary port, using the <span class="cmd"><b>no exec</b></span> command within the line configuration mode. This command allows only an outgoing connection on the line. The <span class="cmd"><b>no exec</b></span> command allows you to disable the EXEC process for connections which may attempt to send unsolicited data to the router.</p> <p><b>Encrypt All Passwords</b></p> <p>By default, some passwords are shown in plaintext, meaning not encrypted, in the Cisco IOS software configuration. With the exception of the enable secret password, all other plaintext passwords in the configuration file can be encrypted in the configuration file using the <span class="cmd"><b>service password-encryption</b></span> command. This command hashes current and future plaintext passwords in the configuration file into an encrypted ciphertext. To stop encrypting passwords, use the <span class="cmd"><b>no</b></span> form of the command. Only passwords created after the <span class="cmd"><b>no</b></span> command is issued will be unencrypted. Existing passwords that have been previously encrypted will remain so. </p> <p>The <span class="cmd"><b>service password-encryption</b></span> command is primarily useful for keeping unauthorized individuals from viewing passwords in the configuration file. The algorithm used by the <span class="cmd"><b>service password-encryption</b></span> command is simple and can be easily reversed by someone with access to the encrypted ciphertext and a password-cracking application. For that reason, this command should not be used with the intention to protect configuration files against serious attacks. </p> <p>The <span class="cmd"><b>enable secret</b></span> command is far more secure because it encrypts the password using MD5, which is a stronger algorithm.</p></content-text>
</page>
<page type="OneColumn" id="en2002010204">
<content-media type="StaticGraphic" id="cm9637284758">	<title><content-text></content-text></title>	<media ref="en2002000000/en2002010000/en2002010200/en2002010204/cm9637284758.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2002000000/en2002010000/en2002010200/en2002010204/cm9637284758text.xml"/></content-media>
<content-text><p>Another available security feature is authentication. Cisco routers can maintain a list of usernames and passwords in a local database on the router for performing local login authentication. There are two methods of configuring local username accounts.</p> <p><span class="cmd"><b>username </b><i>name</i><b> password </b><i>password</i></span></p> <p><span class="cmd"><b>username </b><i>name</i><b> secret </b><i>password</i></span></p> <p>The <span class="cmd">username secret</span> command is more secure because it uses the stronger algorithm, MD5 hashing, for concealing passwords. MD5 is a much better algorithm than the standard type 7 used by the <span class="cmd"><b>service password-encryption</b></span> command. The added layer of MD5 protection is useful in environments in which the password crosses the network or is stored on a TFTP server. Keep in mind that when configuring a username and password combination, password length restrictions must be followed. Use the <span class="cmd"><b>login local</b></span> command on the line configuration to enable the local database for authentication. </p> <p>All of the remaining examples in this chapter are using the <span class="cmd"><b>username secret</b></span> configuration instead of <span class="cmd"><b>username password</b></span>.</p></content-text>
</page>
</topic>
<topic type="" id="en2002010300">
<title><content-text>Configuring Enhanced Security for Virtual Logins</content-text></title>
<page type="OneColumn" id="en2002010301">
<content-media type="StaticGraphic" id="cm7547104608">	<title><content-text></content-text></title>	<media ref="en2002000000/en2002010000/en2002010300/en2002010301/cm7547104608.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2002000000/en2002010000/en2002010300/en2002010301/cm7547104608text.xml"/></content-media>
<content-text><p>Assigning passwords and local authentication does not prevent a device from being targeted for attack. DoS attacks flood a device with so many connection requests that the device might not provide normal login service to legitimate system administrators. A dictionary attack, which is used to gain administrative access to a device, floods a device with thousands of username and password combinations. The end result is much the same as a DoS attack, in that the device cannot process legitimate user requests. The network needs to have systems in place to detect and help prevent these attacks. </p> <p>By enabling a detection profile, a network device can be configured to react to repeated failed login attempts by refusing further connection requests (login blocking). This block can be configured for a period of time, which is called a quiet period. Legitimate connection attempts can still be permitted during a quiet period by configuring an access control list (ACL) with the addresses that are known to be associated with system administrators.</p> <p>The Cisco IOS login enhancements feature allows Cisco IOS devices to be better secured when creating a virtual connection, such as Telnet, SSH, or HTTP, by slowing down dictionary attacks and stopping DoS attacks. To better configure security for virtual login connections, the login process should be configured with specific parameters:</p> <p><ul><li>Delays between successive login attempts </li><li>Login shutdown if DoS attacks are suspected </li><li>Generation of system logging messages for login detection</li></ul></p> <p>These enhancements do not apply to console connections. It is assumed that only authorized personnel have physical access to the devices.</p></content-text>
</page>
<page type="OneColumn" id="en2002010302">
<content-media type="StaticGraphic" id="cm4305927185">	<title><content-text></content-text></title>	<media ref="en2002000000/en2002010000/en2002010300/en2002010302/cm4305927185.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2002000000/en2002010000/en2002010300/en2002010302/cm4305927185text.xml"/></content-media>
<content-text><p>The following commands are available to configure a Cisco IOS device to support the enhanced login features.</p> <p><span class="cmd">Router# <b>configure terminal</b></span></p> <p><span class="cmd">Router(config)# <b>login block-for</b><i> seconds </i><b>attempts</b><i> tries</i><b> within </b><i>seconds</i></span></p> <p><span class="cmd">Router(config)# <b>login quiet-mode access-class</b> {<i>acl-name</i> | <i>acl-number</i>}</span></p> <p><span class="cmd">Router(config)# <b>login delay</b><i> seconds</i></span></p> <p><span class="cmd">Router(config)# <b>login on-failure log</b> [<b>every </b><i>login</i>]</span></p> <span class="cmd"><p>Router(config)# <b>login on-success log</b> [<b>every </b><i>login</i>]</p></span> <p>Authentication on vty lines must be configured to use a username and password combination. If the vty lines are configured to use only a password, the enhanced login features are not enabled. </p> <p>What does each command accomplish?</p></content-text>
</page>
<page type="OneColumn" id="en2002010303">
<content-media type="StaticGraphic" id="cm6387628846">	<title><content-text></content-text></title>	<media ref="en2002000000/en2002010000/en2002010300/en2002010303/cm6387628846.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2002000000/en2002010000/en2002010300/en2002010303/cm6387628846text.xml"/></content-media>
<content-text><p>All login enhancement features are disabled by default. Use the <span class="cmd"><b>login block-for</b></span> command to enable login enhancements. </p> <p>The <span class="cmd"><b>login block-for</b></span> feature monitors login device activity and operates in two modes:</p> <p><ul><li><b>Normal mode (watch mode)</b> - The router keeps count of the number of failed login attempts within an identified amount of time. </li><li><b>Quiet mode (quiet period)</b> - If the number of failed logins exceeds the configured threshold, all login attempts using Telnet, SSH, and HTTP are denied.</li></ul></p> <p>When quiet mode is enabled, all login attempts, including valid administrative access, are not permitted. However, to provide critical hosts access at all times, this behavior can be overridden using an ACL. The ACL must be created and identified using the <span class="cmd"><b>login quiet-mode access-class</b></span> command. </p> <p>By default, Cisco IOS devices can accept connections, such as Telnet, SSH, and HTTP, as quickly as they can be processed. This makes devices susceptible to dictionary attack tools, such as Cain or L0phtCrack, which are capable of thousands of password attempts per second. The <span class="cmd"><b>login block-for</b></span> command invokes an automatic delay of 1 second between login attempts. Attackers have to wait 1 second before they can try a different password.</p> <p>This delay time can be changed using the <span class="cmd"><b>login delay</b></span> command. The <span class="cmd"><b>login delay</b></span> command introduces a uniform delay between successive login attempts. The delay occurs for all login attempts, including failed or successful attempts. </p> <p>The <span class="cmd"><b>login block-for</b></span>, <span class="cmd"><b>login quiet-mode access-class</b></span>, and <span class="cmd"><b>login delay</b></span> commands help block failed login attempts for a limited period of time but cannot prevent an attacker from trying again. How can an administrator know when someone tries to gain access to the network by guessing the password?</p></content-text>
</page>
<page type="OneColumn" id="en2002010304">
<content-media type="StaticGraphic" id="cm6566954945">	<title><content-text></content-text></title>	<media ref="en2002000000/en2002010000/en2002010300/en2002010304/cm6566954945.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2002000000/en2002010000/en2002010300/en2002010304/cm6566954945text.xml"/></content-media>
<content-text><p>The command <span class="cmd"><b>auto secure</b></span> enables message logging for failed login attempts. Logging successful login attempts is not enabled by default. </p> <p>These commands can be used to keep track of the number of successful and failed login attempts.</p> <p><span class="cmd"><b>login on-failure log</b></span> generates logs for failed login requests.</p> <p><span class="cmd"><b>login on-success log</b></span> generates log messages for successful login requests.</p> <p>As an alternative, the <span class="cmd"><b>security authentication failure rate </b><i>threshold-rate</i><b> log</b></span> command generates a log message when the login failure rate is exceeded. </p> <p>To verify that the <span class="cmd"><b>login block-for</b></span> command is configured and which mode the router is currently in, use the <span class="cmd"><b>show login</b></span> command. The router is in either normal or quite mode, depending on whether login thresholds were exceeded. </p> <p>The <span class="cmd"><b>show login failures</b></span> command displays more information regarding the failed attempts, such as the IP address from which the failed login attempts originated.</p></content-text>
</page>
<page type="OneColumn" id="en2002010305">
<content-media type="StaticGraphic" id="cm5550294278">	<title><content-text></content-text></title>	<media ref="en2002000000/en2002010000/en2002010300/en2002010305/cm5550294278.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2002000000/en2002010000/en2002010300/en2002010305/cm5550294278text.xml"/></content-media>
<content-text><p>Use banner messages to present legal notification to would-be intruders to inform them that they are not welcome on a network. Banners are very important to the network from a legal perspective. Intruders have won court cases because they did not encounter appropriate warning messages when accessing router networks. In addition to warning would-be intruders, banners are also used to inform remote administrators of use restrictions.</p> <p>Choosing what to place in banner messages is important and should be reviewed by legal counsel before putting them on network routers. Never use the word welcome or any other familiar greeting that may be misconstrued as an invitation to use the network.</p> <p>Banners are disabled by default and must be explicitly enabled. Use the <span class="cmd"><b>banner</b></span> command from global configuration mode to specify appropriate messages.</p> <p><span class="cmd"><b>banner</b> {<b>exec </b>|<b> incoming </b>|<b> login </b>|<b> motd </b>|<b> slip-ppp</b>} <i>d message d</i></span></p> <p>Tokens are optional and can be used within the message section of the <span class="cmd"><b>banner</b></span> command:</p> <p><span class="cmd"><b>$(hostname)</b></span> - Displays the host name for the router.</p> <p><span class="cmd"><b>$(domain)</b></span> - Displays the domain name for the router.</p> <p><span class="cmd"><b>$(line)</b></span> - Displays the vty or tty (asynchronous) line number.</p> <p><span class="cmd"><b>$(line-desc)</b></span> - Displays the description that is attached to the line.</p> <p>Be careful in placing this information in the banner because it provides more information to a possible intruder. </p> <p>Cisco SDM can also be used to configure banner messages.</p></content-text>
</page>
</topic>
<topic type="" id="en2002010400">
<title><content-text>Configure SSH</content-text></title>
<page type="OneColumn" id="en2002010401">
<content-media type="StaticGraphic" id="cm8541978963">	<title><content-text></content-text></title>	<media ref="en2002000000/en2002010000/en2002010400/en2002010401/cm8541978963.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2002000000/en2002010000/en2002010400/en2002010401/cm8541978963text.xml"/></content-media>
<content-text><p>When enabling remote administrative access, it is also important to consider the security implications of sending information across the network. Traditionally, remote access on routers was configured using Telnet on TCP port 23. However, Telnet was developed in the days when security was not an issue, therefore, all Telnet traffic is forwarded in plaintext. Using this protocol, critical data, such as router configurations, is easily accessible to attackers. Hackers can capture packets forwarded by an administrator's computer using a protocol analyzer such as Wireshark. If the initial Telnet stream is discovered and followed, attackers can learn the administrator's username and password. </p> <p>However, having remote access capability can save an organization time and money when making necessary configuration changes. So how can a secure remote access connection be established to manage Cisco IOS devices? </p> <p>SSH has replaced Telnet as the recommended practice for providing remote router administration with connections that support confidentiality and session integrity. It provides functionality that is similar to an outbound Telnet connection, except that the connection is encrypted and operates on port 22. With authentication and encryption, SSH allows for secure communication over a non-secure network. </p> <p>Four steps must be completed prior to configuring routers for the SSH protocol:</p> <p><b>Step 1.</b> Ensure that the target routers are running a Cisco IOS Release 12.1(1)T image or later to support SSH. Only the Cisco IOS cryptographic images containing the IPsec feature set support SSH. Specifically, Cisco IOS 12.1 or later IPsec DES or Triple Data Encryption Standard (3DES) cryptographic images support SSH. Typically, these images have image IDs of k8 or k9 in their image names. For example, c1841-advipservicesk9-mz.124-10b.bin is an image that can support SSH. </p> <p><b>Step 2.</b> Ensure that each of the target routers has a unique host name.</p> <p><b>Step 3.</b> Ensure that each of the target routers is using the correct domain name of the network.</p> <p><b>Step 4.</b> Ensure that the target routers are configured for local authentication or AAA services for username and password authentication. This is mandatory for a router-to-router SSH connection.</p></content-text>
</page>
<page type="OneColumn" id="en2002010402">
<content-media type="StaticGraphic" id="cm1837088009">	<title><content-text></content-text></title>	<media ref="en2002000000/en2002010000/en2002010400/en2002010402/cm1837088009.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2002000000/en2002010000/en2002010400/en2002010402/cm1837088009text.xml"/></content-media>
<content-text><p>Using the CLI, there are four steps to configure a Cisco router to support SSH:</p> <p><b>Step 1.</b> If the router has a unique host name, configure the IP domain name of the network using the <span class="cmd"><b>ip domain-name</b><i> domain-name</i></span> command in global configuration mode.</p> <p><b>Step 2.</b> One-way secret keys must be generated for a router to encrypt the SSH traffic. These keys are referred to as asymmetric keys. Cisco IOS software uses the Rivest, Shamir, and Adleman (RSA) algorithm to generate keys. To create the RSA key, use the <span class="cmd"><b>crypto key generate rsa general-keys modulus </b><i>modulus-size</i></span> command in global configuration mode. The modulus determines the size of the RSA key and can be configured from 360 bits to 2048 bits. The larger the modulus, the more secure the RSA key. However, keys with large modulus values take slightly longer to generate and longer to encrypt and decrypt as well. The minimum recommended modulus key length is 1024 bits. </p> <p>To verify SSH and display the generated keys, use the <span class="cmd"><b>show crypto key mypubkey rsa</b></span> command in privileged EXEC mode. If there are existing key pairs, it is recommended that they are overwritten using the <span class="cmd"><b>crypto key zeroize rsa</b></span> command.</p> <p><b>Step 3.</b> Ensure that there is a valid local database username entry. If not, create one using the <span class="cmd"><b>username </b><i>name</i><b> secret </b><i>secret</i></span> command.</p> <p><b>Step 4.</b> Enable vty inbound SSH sessions using the line vty commands <span class="cmd"><b>login local</b></span> and <span class="cmd"><b>transport input ssh</b></span>.</p> <p>SSH is automatically enabled after the RSA keys are generated. The router SSH service can be accessed using SSH client software.</p></content-text>
</page>
<page type="OneColumn" id="en2002010403">
<content-media type="StaticGraphic" id="cm5444017258">	<title><content-text></content-text></title>	<media ref="en2002000000/en2002010000/en2002010400/en2002010403/cm5444017258.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2002000000/en2002010000/en2002010400/en2002010403/cm5444017258text.xml"/></content-media>
<content-text><p><b>Optional SSH Commands</b></p> <p>Optionally, SSH commands can be used to configure the following:</p> <p><ul><li>SSH version </li><li>SSH timeout period</li><li>Number of authentication retries</li></ul></p> <p>Cisco routers support two versions of SSH: SSH version 1 (SSHv1) and the newer, more secure SSH version 2 (SSHv2). SSHv2 provides better security using the Diffie-Hellman key exchange and the strong integrity-checking message authentication code (MAC).</p> <p>Cisco IOS Release 12.1(1)T and later supports SSHv1. Cisco IOS Release 12.3(4)T and later operates in compatibility mode and supports both SSHv1 and SSHv2. To change from compatibility mode to a specific version, use the <span class="cmd"><b>ip ssh version</b> {<b>1 </b>|<b> 2</b>}</span> global configuration command. </p> <p>The time interval that the router waits for the SSH client to respond during the SSH negotiation phase can be configured using the <span class="cmd"><b>ip ssh time-out</b><i> seconds</i></span> command in global configuration mode. The default is 120 seconds. When the EXEC session starts, the standard exec timeout configured for the vty applies. </p> <p>By default, a user logging in has three attempts before being disconnected. To configure a different number of consecutive SSH retries, use the <span class="cmd"><b>ip ssh authentication-retries</b><i> integer</i></span> command in global configuration mode.</p> <p>To verify the optional SSH command settings, use the <span class="cmd"><b>show ip ssh</b></span> command.</p> <p>After SSH is configured, an SSH client is required to connect to an SSH-enabled router.</p></content-text>
</page>
<page type="OneColumn" id="en2002010404">
<content-media type="StaticGraphic" id="cm5728746699">	<title><content-text></content-text></title>	<media ref="en2002000000/en2002010000/en2002010400/en2002010404/cm5728746699.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2002000000/en2002010000/en2002010400/en2002010404/cm5728746699text.xml"/></content-media>
<content-text><p>There are two different ways to connect to an SSH-enabled router:</p> <p><ul><li>Connect using an SSH-enabled Cisco router using the privileged EXEC mode <span class="cmd"><b>ssh</b></span> command.</li><li>Connect using a publicly and commercially available SSH client running on a host. Examples of these clients are PuTTY, OpenSSH, and TeraTerm.</li></ul></p> <p>Cisco routers are capable of acting as the SSH server and as an SSH client connecting to another SSH-enabled device. By default, both of these functions are enabled on the router when SSH is enabled. As a server, a router can accept SSH client connections. As a client, a router can SSH to another SSH-enabled router. </p> <p>The procedure for connecting to a Cisco router varies depending on the SSH client application that is being used. Generally, the SSH client initiates an SSH connection to the router. The router SSH service prompts for the correct username and password combination. After the login is verified, the router can be managed as if the administrator was using a standard Telnet session.</p> <p>Use the <span class="cmd"><b>show ssh</b></span> command to verify the status of the client connections.</p></content-text>
</page>
<page type="OneColumn" id="en2002010405">
<content-media type="StaticGraphic" id="cm9506545314">	<title><content-text></content-text></title>	<media ref="en2002000000/en2002010000/en2002010400/en2002010405/cm9506545314.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2002000000/en2002010000/en2002010400/en2002010405/cm9506545314text.xml"/></content-media>
<content-text><p>Cisco SDM can be used to configure an SSH daemon on a router. To see the current SSH key settings, choose <b>Configure > Additional Tasks > Router Access > SSH</b>. The SSH key settings have two status options.</p> <p><ul><li><b>RSA key is not set on this router </b>- This notice appears if there is no cryptographic key configured for the device. If there is no key configured, enter a modulus size and generate a key.</li><li><b>RSA key is set on this router </b>- This notice appears if a cryptographic key has been generated, in which case SSH is enabled on this router.</li></ul></p> <p>The default configuration file that ships with a Cisco SDM-enabled router automatically enables Telnet and SSH access from the LAN interface and generates an RSA key.</p> <p>The <b>Generate RSA</b> Key button configures a cryptographic key if one is not set. The Key Modulus Size dialog box appears. If the modulus value needs to be between 512 and 1024, enter an integer value that is a multiple of 64. If the modulus value needs to be higher than 1024, enter 1536 or 2048. If a value greater than 512 is entered, key generation can take a minute or longer.</p> <p>After SSH is enabled on the router, the vty lines to support SSH need to be configured. Choose <b>Configure > Additional Tasks > Router Access > VTY</b>. The VTY Lines window displays the vty settings on the router. Click the <b>Edit</b> button to configure vty parameters. </p></content-text>
</page>
</topic>
</section>
<section type="" id="en2002020000">
<title><content-text>Assigning Administrative Roles</content-text></title>
<topic type="" id="en2002020100">
<title><content-text>Configuring Privilege Levels</content-text></title>
<page type="OneColumn" id="en2002020101">
<content-media type="StaticGraphic" id="cm2699246047">	<title><content-text></content-text></title>	<media ref="en2002000000/en2002020000/en2002020100/en2002020101/cm2699246047.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2002000000/en2002020000/en2002020100/en2002020101/cm2699246047text.xml"/></content-media>
<content-text><p>While it is important that a system administrator can securely connect to and manage a device, still more configurations are needed to keep the network secure. For example, should complete access be provided for all employees in a company? The answer to that question is usually no. Most company employees require only specific areas of access to the network. What about complete access for all employees in the IT department? Keep in mind that large organizations have many various job functions within an IT department. For example, job titles include Chief Information Officer (CIO), Security Operator, Network Administrator, WAN Engineer, LAN Administrator, Software Administrator, PC Tech support, Help Desk support, and others. Not all job functions should have the same level of access to the infrastructure devices.</p> <p>As an example, a senior network administrator leaves for vacation and, as a precaution, provides a junior administrator with the privileged EXEC mode passwords to all infrastructure devices. A few days later, the curious junior administrator accidentally disables the company network. This is not an uncommon scenario, because all too often a router is secured with only one privileged EXEC password. Anyone with knowledge of this password has open access to the entire router. </p> <p>Configuring privilege levels is the next step for the system administrator who wants to secure the network. Privilege levels determine who should be allowed to connect to the device and what that person should be able to do with it. The Cisco IOS software CLI has two levels of access to commands.</p> <p><ul><li>User EXEC mode (privilege level 1) - Provides the lowest EXEC mode user privileges and allows only user-level commands available at the <span class="cmd">router></span> prompt.</li><li>Privileged EXEC mode (privilege level 15) - Includes all enable-level commands at the <span class="cmd">router# </span> prompt.</li></ul></p> <p>Although these two levels do provide control, sometimes a more precise level of control is required. </p> <p>Cisco IOS software has two methods of providing infrastructure access: privilege level and role-based CLI.</p></content-text>
</page>
<page type="OneColumn" id="en2002020102">
<content-media type="StaticGraphic" id="cm5261572801">	<title><content-text></content-text></title>	<media ref="en2002000000/en2002020000/en2002020100/en2002020102/cm5261572801.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2002000000/en2002020000/en2002020100/en2002020102/cm5261572801text.xml"/></content-media>
<content-text><p><b>Assigning Privilege Levels</b></p> <p>Since Cisco IOS Release 10.3, Cisco routers enable an administrator to configure multiple privilege levels. Configuring privilege levels is especially useful in a help desk environment where certain administrators must be able to configure and monitor every part of the router (level 15), and other administrators need only to monitor, not configure, the router (customized levels 2 to 14). There are 16 privilege levels in total. Levels 0, 1, and 15 have predefined settings.</p> <p>An administrator can define multiple customized privilege levels and assign different commands to each level. The higher the privilege level, the more router access a user has. Commands that are available at lower privilege levels are also executable at higher levels, because a privilege level includes the privileges of all lower levels. For example, a user authorized for privilege level 10 is granted access to commands allowed at privilege levels 0 through 10 (if also defined). A privilege-level-10 user cannot access commands granted to privilege level 11 (or higher). A user authorized for privilege level 15 can execute all Cisco IOS commands.</p> <p>To assign commands to a custom privilege level, use the <span class="cmd"><b>privilege</b></span> command from global configuration mode. </p> <p><span class="cmd">Router(config)# <b>privilege </b><i>mode</i> {<b>level </b><i>level command</i> | <b>reset</b>} <i>command</i></span></p> <p>It is important to note that assigning a command with multiple keywords, such as <span class="cmd"><b>show ip route</b></span>, to a specific privilege level automatically assigns all commands associated with the first few keywords to the specified privilege level. For example, both the <span class="cmd"><b>show</b></span> command and the <span class="cmd"><b>show ip</b></span> command are automatically set to the privilege level where <span class="cmd"><b>show ip route</b></span> is set. This is necessary because the <span class="cmd"><b>show ip route</b></span> command cannot be executed without access to the <span class="cmd"><b>show</b></span> and <span class="cmd"><b>show ip</b></span> commands. Subcommands coming under <span class="cmd"><b>show ip route</b></span> are also automatically assigned to the same privilege level.</p></content-text>
</page>
<page type="OneColumn" id="en2002020103">
<content-media type="StaticGraphic" id="cm7098501828">	<title><content-text></content-text></title>	<media ref="en2002000000/en2002020000/en2002020100/en2002020103/cm7098501828.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2002000000/en2002020000/en2002020100/en2002020103/cm7098501828text.xml"/></content-media>
<content-text><p>Privilege levels should also be configured for authentication. There are two methods for assigning passwords to the different levels:</p> <p><ul><li>To the privilege level using the global configuration command <span class="cmd"><b>enable secret level </b><i>level password</i></span>.</li><li>To a user that is granted a specific privilege level, using the global configuration command <span class="cmd"><b>username </b><i>name</i><b> privilege </b><i>level</i><b> secret </b><i>password</i></span>.</li></ul></p> <p>For example, an administrator could assign four levels of device access within an organization:</p> <p><ul><li>A USER account (requiring level 1, not including <span class="cmd"><b>ping</b></span>)</li><li>A SUPPORT account (requiring all level 1 access, plus the <span class="cmd"><b>ping</b></span> command)</li><li>A JR-ADMIN account (requiring all level 1 and 5 access, plus the <span class="cmd"><b>reload</b></span> command)</li><li>An ADMIN account (requiring complete access)</li></ul></p> <p>Implementing privilege levels varies depending on the organization's structure and the different job functions that require access to the infrastructure devices.</p> <p>In the case of the USER, which requires default level 1 (<span class="cmd">Router></span>) access, no custom privilege level is defined. This is because the default user mode is equivalent to level 1.</p> <p>The SUPPORT account could be assigned a higher level access such as level 5. Level 5 automatically inherits the commands from levels 1 through 4, plus additional commands can be assigned. Keep in mind that when a command is assigned at a specific level, access to that command is taken away from any lower level. For example, to assign level 5 the <span class="cmd"><b>ping</b></span> command, use the following command sequence.</p> <span class="cmd"><p><b>privilege exec level 5 ping</b></p></span> <p>The USER account (level 1) no longer has access to the ping command, because a user must have access to level 5 or higher to perform the ping function. </p> <p>To assign a password to level 5, enter the following command.</p> <p><span class="cmd"><b>enable secret level 5 cisco5</b></span></p> <p>To access level 5, the password cisco5 must be used.</p> <p>To assign a specific username to privilege level 5, enter the following command.</p> <p><span class="cmd"><b>username support privilege 5 secret cisco5</b></span></p> <p>A user that logs in under the username support is only able to access privilege level 5, which also inherits privilege level 1. </p></content-text>
</page>
<page type="OneColumn" id="en2002020104">
<content-media type="StaticGraphic" id="cm3884525836">	<title><content-text></content-text></title>	<media ref="en2002000000/en2002020000/en2002020100/en2002020104/cm3884525836.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2002000000/en2002020000/en2002020100/en2002020104/cm3884525836text.xml"/></content-media>
<content-text><p>The JR-ADMIN account needs access to all level 1 and level 5 commands as well as the <span class="cmd"><b>reload</b></span> command. This account must be assigned a higher level access, such as level 10. Level 10 automatically inherits all the commands from the lower levels. </p> <p>To assign level 10 to the privileged EXEC mode <span class="cmd"><b>reload</b></span> command, use the following command sequence.</p> <p><span class="cmd"><b>privilege exec level 10 reload</b></span></p> <p><span class="cmd"><b>username jr-admin privilege 10 secret cisco10</b></span></p> <span class="cmd"><p><b>enable secret level 10 cisco10</b></p></span> <p>By performing these commands, the <span class="cmd"><b>reload</b></span> command is only available to users with level 10 access or higher. The username jr-admin is given access to privilege level 10 and all associated commands, including those commands assigned to any lower privilege levels. To access level 10 mode, the password cisco10 is required.</p> <p>An ADMIN account could be assigned the default level 15 access for privileged EXEC mode. In this instance, no custom commands need to be defined. A custom password could be assigned using the <span class="cmd"><b>enable secret level 15 cisco123</b></span> command, however, that does not override the enable secret password, which could also be used to access level 15. Use the <span class="cmd"><b>username admin privilege 15 secret cisco15</b></span> command to assign level 15 access to the user ADMIN with a password of cisco15.</p> <p>Keep in mind that when assigning usernames to privilege levels, the <span class="cmd"><b>privilege</b></span> and <span class="cmd"><b>secret</b></span> keywords are not interchangeable. For example, the <span class="cmd"><b>username USER secret cisco privilege 1</b></span> command does not assign the USER account level 1 access. Instead, it creates an account requiring the password "<span class="cmd"><b>cisco privilege 1</b></span>". </p> <p>To access established privilege levels, enter the <span class="cmd"><b>enable <i>level</i></b></span> command from user mode, and enter the password that was assigned to the custom privilege level. Use the same command to switch from a lower level to a higher level.</p> <p><ul><li>To switch from level 1 to level 5, use the <span class="cmd"><b>enable 5</b></span> command at the EXEC prompt. </li><li>To switch to level 10, use <span class="cmd"><b>enable 10</b></span> with the correct password. </li><li>To switch from level 10 to level 15, use the <span class="cmd"><b>enable</b></span> command. If no privilege level is specified, level 15 is assumed.</li></ul></p> <p>It is sometimes easy to forget which level of access a user currently has. Use the <span class="cmd"><b>show privilege</b></span> command to display and confirm the current privilege level. Remember that the higher privilege levels automatically inherit the command access of the lower levels.</p></content-text>
</page>
<page type="OneColumn" id="en2002020105">
<content-media type="StaticGraphic" id="cm6935608341">	<title><content-text></content-text></title>	<media ref="en2002000000/en2002020000/en2002020100/en2002020105/cm6935608341.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2002000000/en2002020000/en2002020100/en2002020105/cm6935608341text.xml"/></content-media>
<content-text><p>Although assigning privilege levels does provide some flexibility, some organizations might not find them suitable because of the following limitations:</p> <p><ul><li>No access control to specific interfaces, ports, logical interfaces, and slots on a router.</li><li>Commands available at lower privilege levels are always executable at higher levels.</li><li>Commands specifically set on a higher privilege level are not available for lower privileged users.</li><li>Assigning a command with multiple keywords to a specific privilege level also assigns all commands associated with the first keywords to the same privilege level. An example is the <span class="cmd"><b>show ip route</b></span> command.</li></ul></p> <p>The biggest limitation however is that if an administrator needs to create a user account that has access to most but not all commands, <span class="cmd"><b>privilege exec</b></span> statements must be configured for every command that must be executed at a privilege level lower than 15. This can be a tedious process.</p> <p>How can the limitations of assigning privilege levels be overcome?</p></content-text>
</page>
</topic>
<topic type="" id="en2002020200">
<title><content-text>Configuring Role-Based CLI Access</content-text></title>
<page type="OneColumn" id="en2002020201">
<content-media type="StaticGraphic" id="cm6046172443">	<title><content-text></content-text></title>	<media ref="en2002000000/en2002020000/en2002020200/en2002020201/cm6046172443.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2002000000/en2002020000/en2002020200/en2002020201/cm6046172443text.xml"/></content-media>
<content-text><p><b>Role-Based CLI</b></p> <p>To provide more flexibility than privilege levels, Cisco introduced the Role-Based CLI Access feature in Cisco IOS Release 12.3(11)T. This feature provides finer, more granular access by controlling specifically which commands are available to specific roles. Role-based CLI access enables the network administrator to create different views of router configurations for different users. Each view defines the CLI commands that each user can access. </p> <p><b>Security</b></p> <p>Role-based CLI access enhances the security of the device by defining the set of CLI commands that is accessible by a particular user. Additionally, administrators can control user access to specific ports, logical interfaces, and slots on a router. This prevents a user from accidentally or purposely changing a configuration or collecting information to which they should not have access. </p> <p><b>Availability</b></p> <p>Role-based CLI access prevents unintentional execution of CLI commands by unauthorized personnel, which could result in undesirable results. This minimizes downtime. </p> <p><b>Operational Efficiency</b></p> <p>Users only see the CLI commands applicable to the ports and CLI to which they have access; therefore, the router appears to be less complex, and commands are easier to identify when using the help feature on the device.</p></content-text>
</page>
<page type="OneColumn" id="en2002020202">
<content-media type="StaticGraphic" id="cm2097637988">	<title><content-text></content-text></title>	<media ref="en2002000000/en2002020000/en2002020200/en2002020202/cm2097637988.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2002000000/en2002020000/en2002020200/en2002020202/cm2097637988text.xml"/></content-media>
<content-text><p>Role-based CLI provides three types of views:</p> <p><ul><li>Root view</li><li>CLI view</li><li>Superview</li></ul></p> <p>Each view dictates which commands are available.</p> <p><b>Root View</b></p> <p>To configure any view for the system, the administrator must be in root view. Root view has the same access privileges as a user who has level 15 privileges. However, a root view is not the same as a level 15 user. Only a root view user can configure a new view and add or remove commands from the existing views. </p> <p><b>CLI View</b></p> <p>A specific set of commands can be bundled into a CLI view. Unlike privilege levels, a CLI view has no command hierarchy and, therefore, no higher or lower views. Each view must be assigned all commands associated with that view, and a view does not inherit commands from any other views. Additionally, the same commands can be used in multiple views.</p> <p><b>Superview</b></p> <p>A superview consists of one or more CLI views. Administrators can define which commands are accepted and which configuration information is visible. Superviews allow a network administrator to assign users and groups of users multiple CLI views at once, instead of having to assign a single CLI view per user with all commands associated to that one CLI view. </p> <p>Superviews have the following characteristics: </p> <p><ul><li>A single CLI view can be shared within multiple superviews. </li><li>Commands cannot be configured for a superview. An administrator must add commands to the CLI view and add that CLI view to the superview. </li><li>Users who are logged into a superview can access all the commands that are configured for any of the CLI views that are part of the superview. </li><li>Each superview has a password that is used to switch between superviews or from a CLI view to a superview.</li></ul></p> <p>Deleting a superview does not delete the associated CLI views. The CLI views remain available to be assigned to another superview.</p></content-text>
</page>
<page type="OneColumn" id="en2002020203">
<content-media type="StaticGraphic" id="cm2157154750">	<title><content-text></content-text></title>	<media ref="en2002000000/en2002020000/en2002020200/en2002020203/cm2157154750.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2002000000/en2002020000/en2002020200/en2002020203/cm2157154750text.xml"/></content-media>
<content-text><p>Before an administrator can create a view, AAA must be enabled using the <span class="cmd"><b>aaa new-model</b></span> command or Cisco SDM. </p> <p>To configure and alter views, an administrator must log in as the root view, using the<span class="cmd"><b> enable view </b></span>privileged EXEC command. The <span class="cmd"><b>enable view root</b></span> command can also be used. When prompted, enter the enable secret password.</p> <p>There are five steps to create and manage a specific view.</p> <p><b>Step 1.</b> Enable AAA with the <span class="cmd"><b>aaa new-model</b></span> global configuration command. Exit and enter the root view with the <span class="cmd"><b>enable view</b></span> command.</p> <p><b>Step 2.</b> Create a view using the <span class="cmd"><b>parser view </b><i>view-name</i></span> command. This enables the view configuration mode. Excluding the root view, there is a maximum limit of 15 views in total.</p> <p><b>Step 3.</b> Assign a secret password to the view using the <span class="cmd"><b>secret</b><i> encrypted-password</i></span> command.</p> <p><b>Step 4.</b> Assign commands to the selected view using the <span class="cmd"><b>commands </b><i>parser-mode</i> {<b>include</b> | <b>include-exclusive</b> | <b>exclude</b>} [<b>all</b>] [<b>interface</b><i> interface-name</i> | <i>command</i>]</span> command in view configuration mode.</p> <p><b>Step 5.</b> Exit view configuration mode by typing the <span class="cmd"><b>exit</b></span> command.</p></content-text>
</page>
<page type="OneColumn" id="en2002020204">
<content-media type="StaticGraphic" id="cm8947806206">	<title><content-text></content-text></title>	<media ref="en2002000000/en2002020000/en2002020200/en2002020204/cm8947806206.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2002000000/en2002020000/en2002020200/en2002020204/cm8947806206text.xml"/></content-media>
<content-text><p>The steps to configure a superview are essentially the same as configuring a CLI view, except that instead of using the <span class="cmd"><b>commands</b></span> command to assign commands, use the <span class="cmd"><b>view </b><i>view-name</i></span> command to assign views. The administrator must be in root view to configure a superview. To confirm that root view is being used, use either the <span class="cmd"><b>enable view</b></span> or <span class="cmd"><b>enable view root</b></span> command. When prompted, enter the enable secret password.</p> <p>There are four steps to create and manage a superview.</p> <p><b>Step 1.</b> Create a view using the <span class="cmd"><b>parser view </b><i>view-name</i><b> superview</b></span> command and enter superview configuration mode.</p> <p><b>Step 2.</b> Assign a secret password to the view using the <span class="cmd"><b>secret</b><i> encrypted-password</i></span> command.</p> <p><b>Step 3.</b> Assign an existing view using the <span class="cmd"><b>view </b><i>view-name</i></span> command in view configuration mode.</p> <p><b>Step 4.</b> Exit superview configuration mode by typing the <span class="cmd"><b>exit</b></span> command.</p> <p>More than one view can be assigned to a superview, and views can be shared between superviews.</p> <p>To access existing views, enter the <span class="cmd"><b>enable view </b><i>viewname</i></span> command in user mode and enter the password that was assigned to the custom view. Use the same command to switch from one view to another.</p></content-text>
</page>
<page type="OneColumn" id="en2002020205">
<content-media type="StaticGraphic" id="cm7528193046">	<title><content-text></content-text></title>	<media ref="en2002000000/en2002020000/en2002020200/en2002020205/cm7528193046.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2002000000/en2002020000/en2002020200/en2002020205/cm7528193046text.xml"/></content-media>
<content-text><p>To verify a view, use the <span class="cmd"><b>enable view</b></span> command. Enter the name of the view to verify, and provide the password to log in to the view. Use the question mark (<span class="cmd"><b>?</b></span>) command to verify that the commands available in the view are correct. </p> <p>From the root view, use the <span class="cmd"><b>show parser view all</b></span> command to see a summary of all views.</p></content-text>
</page>
</topic>
</section>
<section type="" id="en2002030000">
<title><content-text>Monitoring and Managing Devices</content-text></title>
<topic type="" id="en2002030100">
<title><content-text>Securing the Cisco IOS Image and Configuration Files</content-text></title>
<page type="OneColumn" id="en2002030101">
<content-media type="StaticGraphic" id="cm8615350909">	<title><content-text></content-text></title>	<media ref="en2002000000/en2002030000/en2002030100/en2002030101/cm8615350909.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2002000000/en2002030000/en2002030100/en2002030101/cm8615350909text.xml"/></content-media>
<content-text><p>If attackers gain access to a router there are many things that they could do. For example, they could alter traffic flows, alter configurations, and even erase the startup configuration file and Cisco IOS image. If the configuration or IOS image is erased, the operator might need to retrieve an archived copy to restore the router. The recovery process must then be performed on each affected router, adding to the total network downtime.</p> <p>The Cisco IOS Resilient Configuration feature allows for faster recovery if someone reformats flash memory or erases the startup configuration file in NVRAM. This feature allows a router to withstand malicious attempts at erasing the files by securing the router image and maintaining a secure working copy of the running configuration.</p> <p>When a Cisco IOS image is secured, the resilient configuration feature denies all requests to copy, modify, or delete it. The secure copy of the startup configuration is stored in flash along with the secure IOS image. This set of Cisco IOS image and router running configuration files is referred to as the bootset.</p> <p>The Cisco IOS resilient configuration feature is only available for systems that support a PCMCIA Advanced Technology Attachment (ATA) flash interface. The Cisco IOS image and backup running configuration on the Flash drive are hidden from view, so the files are not included in any directory listing on the drive. </p> <p>Two global configurations commands are available to configure the Cisco IOS resilient configuration features: <span class="cmd"><b>secure boot-image</b></span> and <span class="cmd"><b>secure boot-config</b></span>.</p></content-text>
</page>
<page type="OneColumn" id="en2002030102">
<content-media type="StaticGraphic" id="cm3504255868">	<title><content-text></content-text></title>	<media ref="en2002000000/en2002030000/en2002030100/en2002030102/cm3504255868.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2002000000/en2002030000/en2002030100/en2002030102/cm3504255868text.xml"/></content-media>
<content-text><p><b>The </b><span class="cmd"><b>secure boot-image</b></span><b> command</b></p> <p>The <span class="cmd"><b>secure boot-image</b></span> command enables Cisco IOS image resilience. When enabled for the first time, the running Cisco IOS image is secured, and a log entry is generated. This feature can be disabled only through a console session using the <span class="cmd"><b>no</b></span> form of the command.</p> <p>This command functions properly only when the system is configured to run an image from a flash drive with an ATA interface. Additionally, the running image must be loaded from persistent storage to be secured as primary. Images that are booted from the network, such as a TFTP server, cannot be secured. </p> <p>The Cisco IOS resilient configuration feature detects image version mismatches. If the router is configured to boot with Cisco IOS resilience and an image with a different version of the Cisco IOS software is detected, a message, similar to the one shown below, is displayed at bootup:</p> <p><span class="cmd"><b>ios resilience: Archived image and configuration version 12.2 differs from running version 12.3</b></span></p> <p>To upgrade the image archive to the new running image, reenter the <span class="cmd"><b>secure boot-image</b></span> command from the console. A message about the upgraded image is displayed. The old image is released and is visible in the <span class="cmd"><b>dir</b></span> command output. </p> <p><b>The </b><span class="cmd"><b>secure boot-config</b></span><b> command</b></p> <p>To take a snapshot of the router running configuration and securely archive it in persistent storage, use the <span class="cmd"><b>secure boot-config</b></span> command in global configuration mode. A log message is displayed on the console notifying the user that configuration resilience is activated. The configuration archive is hidden and cannot be viewed or removed directly from the CLI prompt.</p> <p>The configuration upgrade scenario is similar to an image upgrade. This feature detects a different version of Cisco IOS configurations and notifies the user of a version mismatch. The <span class="cmd"><b>secure boot-config</b></span> command can be run to upgrade the configuration archive to a newer version after new configuration commands have been issued. </p></content-text>
</page>
<page type="OneColumn" id="en2002030103">
<content-media type="StaticGraphic" id="cm2180679109">	<title><content-text></content-text></title>	<media ref="en2002000000/en2002030000/en2002030100/en2002030103/cm2180679109.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2002000000/en2002030000/en2002030100/en2002030103/cm2180679109text.xml"/></content-media>
<content-text><p>Secured files do not appear in the output of a <span class="cmd"><b>dir</b></span> command that is issued from the CLI. This is because the Cisco IOS file system prevents secure files from being listed. Because the running image and running configuration archives are not visible in the <span class="cmd"><b>dir</b></span> command output, use the <span class="cmd"><b>show secure bootset</b></span> command to verify the existence of the archive. This step is important to verify that the Cisco IOS image and configuration files have been properly backed up and secured.</p> <p>While the Cisco IOS file system prevents these files from being viewed, ROM monitor (ROMmon) mode does not have any such restrictions and can list and boot from secured files.</p> <p>There are five steps to restore a primary bootset from a secure archive after the router has been tampered with (by an NVRAM erase or a disk format):</p> <p><b>Step 1.</b> Reload the router using the <span class="cmd"><b>reload</b></span> command.</p> <p><b>Step 2.</b> From ROMmon mode, enter the <span class="cmd"><b>dir</b></span> command to list the contents of the device that contains the secure bootset file. From the CLI, the device name can be found in the output of the <span class="cmd"><b>show secure bootset</b></span> command.</p> <p><b>Step 3.</b> Boot the router with the secure bootset image using the <span class="cmd"><b>boot</b></span> command with the filename found in Step 2. When the compromised router boots, change to privileged EXEC mode and restore the configuration.</p> <p><b>Step 4.</b> Enter global configuration mode using <span class="cmd"><b>conf t</b></span>.</p> <p><b>Step 5.</b> Restore the secure configuration to the supplied filename using the <span class="cmd"><b>secure boot-config restore</b><i> filename</i></span> command.</p></content-text>
</page>
<page type="OneColumn" id="en2002030104">
<content-media type="StaticGraphic" id="cm6360296536">	<title><content-text></content-text></title>	<media ref="en2002000000/en2002030000/en2002030100/en2002030104/cm6360296536.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2002000000/en2002030000/en2002030100/en2002030104/cm6360296536text.xml"/></content-media>
<content-text><p>In the event that a router is compromised or needs to be recovered from a misconfigured password, an administrator must understand password recovery procedures. For security reasons, password recovery requires the administrator to have physical access to the router through a console cable. </p> <p>Recovering a router password involves several steps.</p> <p><b>Step 1.</b> Connect to the console port.</p> <p><b>Step 2.</b> Use the <span class="cmd"><b>show version</b></span> command to view and record the configuration register.</p> <p>The configuration register is similar to the BIOS setting of a computer, which controls the bootup process. A configuration register, represented by a single hexadecimal value, tells a router what specific steps to take when powered on. Configuration registers have many uses, and password recovery is probably the most used. To view and record the configuration register, use the <span class="cmd"><b>show version</b></span> command. </p> <p><span class="cmd">R1><b>show version</b></span></p> <p><span class="cmd">&lt;Output omitted></span></p> <p><span class="cmd">Configuration register is 0x2102</span></p> <p>The configuration register is usually set to 0x2102 or 0x102. If there is no longer access to the router (because of a lost login or TACACS password), an administrator can safely assume that the configuration register is set to 0x2102.</p> <p><b>Step 3.</b> Use the power switch to power cycle the router.</p> <p><b>Step 4.</b> Issue the break sequence within 60 seconds of power up to put the router into ROMmon.</p> <p><b>Step 5.</b> Type <span class="cmd"><b>confreg 0x2142</b></span> at the <span class="cmd">rommon 1></span> prompt. </p> <p>This changes the default configuration register and causes the router to bypass the startup configuration where the forgotten enable password is stored.</p> <p><b>Step 6.</b> Type <span class="cmd"><b>reset</b></span> at the <span class="cmd">rommon 2></span> prompt. The router reboots, but ignores the saved configuration.</p> <p><b>Step 7.</b> Type <span class="cmd"><b>no</b></span> after each setup question, or press Ctrl-C to skip the initial setup procedure.</p> <p><b>Step 8.</b> Type <span class="cmd"><b>enable</b></span> at the <span class="cmd">Router></span> prompt. This puts the router into enable mode and allows you to see the <span class="cmd">Router#</span> prompt.</p> <p><b>Step 9.</b> Type <span class="cmd"><b>copy startup-config running-config</b></span> to copy the NVRAM into memory. Be careful not to type <span class="cmd"><b>copy running-config startup-config</b></span> or the startup configuration will be erased.</p> <p><b>Step 10.</b> Type <span class="cmd"><b>show running-config</b></span>. In this configuration, the <span class="cmd"><b>shutdown</b></span> command appears under all interfaces because all interfaces are currently shut down. An administrator can now see the passwords (enable password, enable secret, vty, and console passwords) either in encrypted or unencrypted format. Unencrypted passwords can be reused, but encrypted passwords need a new password to be created.</p> <p><b>Step 11.</b> Enter global configuration and type the <span class="cmd"><b>enable secret</b></span> command to change the enable secret password. For example: </p> <p><span class="cmd">R1(config)# <b>enable secret cisco</b></span></p> <p><b>Step 12.</b> Issue the <span class="cmd"><b>no shutdown</b></span> command on every interface to be used. Then issue the <span class="cmd"><b>show ip interface brief</b></span> command in privileged EXEC mode to confirm that the interface configuration is correct. Every interface to be used should display "up up."</p> <p><b>Step 13.</b> From global configuration mode type <span class="cmd"><b>config-register</b><i> configuration_register_setting</i></span>. The configuration register setting is either the value recorded in step 2 or 0x2102 . For example: </p> <p><span class="cmd">R1(config)# <b>config-register 0x2102</b></span></p> <p><b>Step 14.</b> Save the configuration changes using the <span class="cmd"><b>copy running-config startup-config</b></span> command.</p> <p>Password recovery is now complete. Enter the <span class="cmd"><b>show version</b></span> command to confirm that the router is using the configured configuration register setting on the next reboot.</p></content-text>
</page>
<page type="OneColumn" id="en2002030105">
<content-media type="StaticGraphic" id="cm4485352207">	<title><content-text></content-text></title>	<media ref="en2002000000/en2002030000/en2002030100/en2002030105/cm4485352207.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2002000000/en2002030000/en2002030100/en2002030105/cm4485352207text.xml"/></content-media>
<content-text><p>If someone gained physical access to a router, they could potentially gain control of that device through the password recovery procedure. This procedure, if performed correctly, leaves the router configuration intact, so if the attacker makes no major changes, this type of attack is difficult to detect. An attacker can use this attack method to discover the router configuration and other pertinent information about the network, such as traffic flows and access control restrictions.</p> <p>An administrator can mitigate this potential security breach by using the <span class="cmd"><b>no service password-recovery</b></span> global configuration command. The <span class="cmd"><b>no service password-recovery</b></span> command is a hidden Cisco IOS command and has no arguments or keywords. If a router is configured with the <span class="cmd"><b>no service password-recover</b>y</span> command, all access to ROMmon mode is disabled.</p> <p>When the <span class="cmd"><b>no service password-recovery</b></span> command is entered, a warning message is displayed and must be acknowledged before the feature is enabled. </p> <p>The <span class="cmd"><b>show running configuration</b></span> command displays a <span class="cmd"><b>no service password-recovery</b></span> statement. Additionally, when the router is booted, the initial boot sequence displays a message stating "PASSWORD RECOVERY FUNCTIONALITY IS DISABLED.".</p> <p>To recover a device after the <span class="cmd"><b>no service password-recovery</b></span> command is entered, issue the break sequence within five seconds after the image decompresses during the boot. You are prompted to confirm the break action. After the action is confirmed, the startup configuration is completely erased, the password recovery procedure is enabled, and the router boots with the factory default configuration. If you do not confirm the break action, the router boots normally with the <span class="cmd"><b>no service password-recovery</b></span> command enabled.</p> <p>One note of caution, if the router flash memory does not contain a valid Cisco IOS image because of corruption or deletion, the ROMmon<b> xmodem</b> command cannot be used to load a new flash image. To repair the router, an administrator must obtain a new Cisco IOS image on a flash SIMM or on a PCMCIA card. Refer to Cisco.com for more information regarding backup flash images.</p></content-text>
</page>
</topic>
<topic type="" id="en2002030200">
<title><content-text>Secure Management and Reporting</content-text></title>
<page type="OneColumn" id="en2002030201">
<content-media type="StaticGraphic" id="cm1441025276">	<title><content-text></content-text></title>	<media ref="en2002000000/en2002030000/en2002030200/en2002030201/cm1441025276.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2002000000/en2002030000/en2002030200/en2002030201/cm1441025276text.xml"/></content-media>
<content-text><p>Network administrators need to securely manage all devices and hosts in the network. In a small network, managing and monitoring network devices is a straightforward operation. However, in a large enterprise with hundreds of devices, monitoring, managing, and processing log messages can prove to be challenging. </p> <p>Several factors should be considered when implementing secure management. This includes configuration change management. When a network is under attack, it is important to know the state of critical network devices and when the last known modifications occurred. Configuration change management also includes issues such as ensuring that the right people have access when new management methodologies are adopted, and how to handle tools and devices that are no longer used. Creating a plan for change management should be part of a comprehensive security policy; however, at a minimum, record changes using authentication systems on devices and archive configurations using FTP or TFTP.</p> <p>Is there a change management policy or plan in place? These issues should be established and dealt with in a change management policy.</p> <p>Automated logging and reporting of information from identified devices to management hosts are also important considerations. These logs and reports can include content flow, configuration changes, and new software installs, to name a few. To identify the priorities of reporting and monitoring, it is important to get input from management and from the network and security teams. The security policy should also play a large role in answering the questions of what information to log and report.</p> <p>From a reporting standpoint, most networking devices can send syslog data that can be invaluable when troubleshooting network problems or security threats. Data from any device can be sent to a syslog analysis host for viewing. This data can be viewed in real time, on demand, and in scheduled reports. There are various logging levels to ensure that the correct amount of data is sent, based on the device sending the data. It is also possible to flag device log data within the analysis software to permit granular viewing and reporting. For example, during an attack, the log data that is provided by Layer 2 switches might not be as interesting as the data that is provided by the intrusion prevention system (IPS).</p> <p>Many applications and protocols are also available, such as SNMP, which is used in network management systems to monitor and make configuration changes to devices remotely.</p></content-text>
</page>
<page type="OneColumn" id="en2002030202">
<content-media type="StaticGraphic" id="cm9355368744">	<title><content-text></content-text></title>	<media ref="en2002000000/en2002030000/en2002030200/en2002030202/cm9355368744.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2002000000/en2002030000/en2002030200/en2002030202/cm9355368744text.xml"/></content-media>
<content-text><p>When logging and managing information, the information flow between management hosts and the managed devices can take two paths:</p> <p><ul><li><b>Out-of-band (OOB)</b> - Information flows on a dedicated management network on which no production traffic resides.</li><li><b>In-band</b> - Information flows across an enterprise production network, the Internet, or both using regular data channels.</li></ul></p> <p>For example, a network has two network segments that are separated by a Cisco IOS router that acts as a firewall and a virtual private network (VPN) termination device. One side of the firewall connects to all management hosts and to Cisco IOS routers that act as terminal servers. The terminal servers offer OOB direct connections to any device requiring management on the production network. Most devices should be connected to this management segment and be configured using OOB management.</p> <p>The other side of the firewall connects to the production network itself. The connection to the production network is only provided for selective Internet access by the management hosts, limited in-band management traffic, and encrypted management traffic from predetermined hosts. In-band management occurs only when a management application does not use OOB, or when the Cisco device being managed does not physically have enough interfaces to support the normal connection to the management network. If a device must contact a management host by sending data across the production network, that traffic should be sent securely using a private encrypted tunnel or VPN tunnel. The tunnel should be preconfigured to permit only the traffic that is required for management and reporting of these devices. The tunnel should also be locked down so that only appropriate hosts can initiate and terminate tunnels. The Cisco IOS firewall is configured to allow syslog information into the management segment. In addition, Telnet, SSH, and SNMP are allowed on the condition that these services are first initiated by the management network.</p> <p>Because the management network has administrative access to nearly every area of the network, it can be a very attractive target to hackers. The management module on the firewall has been built with several technologies designed to mitigate such risks. The primary threat is a hacker attempting to gain access to the management network itself. This can possibly be accomplished through a compromised managed host that an management device must access. To mitigate the threat of a compromised device, strong access control should be implemented at the firewall and at every other device. Additionally, management devices should be set up in a fashion that prevents direct communication with other hosts on the same management subnet, using separate LAN segments or VLANs. Setting up private VLANs (PVLANs) on the switches for the management segment forwards all traffic from the management devices to the Cisco IOS firewall where traffic is filtered before it is forwarded to any other device.</p></content-text>
</page>
<page type="OneColumn" id="en2002030203">
<content-media type="StaticGraphic" id="cm1696018104">	<title><content-text></content-text></title>	<media ref="en2002000000/en2002030000/en2002030200/en2002030203/cm1696018104.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2002000000/en2002030000/en2002030200/en2002030203/cm1696018104text.xml"/></content-media>
<content-text><p>As a general rule, for security purposes, OOB management is appropriate for large enterprise networks. However, it is not always desirable. Often the decision depends on the type of management applications that are running and the protocols that are being monitored, for example, a management tool with the goal of determining the reachability of all devices on a network. Consider a situation in which two core switches are being managed and monitored using an OOB network. If a critical link between these two core switches fails on the production network, the application monitoring those devices may never determine that the link has failed and alert the administrator. This is because the OOB network makes all devices appear to be attached to a single OOB management network. The OOB management network remains unaffected by the downed link. With management applications such as these, it is preferable to run the management application in-band in a secure fashion. </p> <p>In-band management is also recommended in smaller networks as a means of achieving a more cost-effective security deployment. In such architectures, management traffic flows in-band in all cases and is made as secure as possible using secure variants to insecure management protocols, such as using SSH instead of Telnet. Another option is to create secure tunnels, using protocols such as IPsec, for management traffic. If management access is not necessary at all times, perhaps temporary holes can be placed in a firewall while management functions are performed. This technique should be used cautiously, and all holes should be closed immediately when management functions are completed. </p> <p>Finally, if using remote management tools with in-band management, be wary of the underlying security vulnerabilities of the management tool itself. For example, SNMP managers are often used to ease troubleshooting and configuration tasks on a network. However, SNMP should be treated with the utmost care because the underlying protocol has its own set of security vulnerabilities.</p></content-text>
</page>
</topic>
<topic type="" id="en2002030300">
<title><content-text>Using Syslog for Network Security</content-text></title>
<page type="OneColumn" id="en2002030301">
<content-media type="StaticGraphic" id="cm3929655277">	<title><content-text></content-text></title>	<media ref="en2002000000/en2002030000/en2002030300/en2002030301/cm3929655277.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2002000000/en2002030000/en2002030300/en2002030301/cm3929655277text.xml"/></content-media>
<content-text><p>Implementing a router logging facility is an important part of any network security policy. Cisco routers can log information regarding configuration changes, ACL violations, interface status, and many other types of events. Cisco routers can send log messages to several different facilities. You should configure the router to send log messages to one or more of the following items.</p> <p><ul><li><b>Console</b> - Console logging is on by default. Messages log to the console and can be viewed when modifying or testing the router using terminal emulation software while connected to the console port of the router.</li><li><b>Terminal lines</b> - Enabled EXEC sessions can be configured to receive log messages on any terminal lines. Similar to console logging, this type of logging is not stored by the router and, therefore, is only valuable to the user on that line.</li><li><b>Buffered logging</b> - Buffered logging is a little more useful as a security tool because log messages are stored in router memory for a time. However, events are cleared whenever the router is rebooted.</li><li><b>SNMP traps</b> - Certain thresholds can be preconfigured on routers and other devices. Router events, such as exceeding a threshold, can be processed by the router and forwarded as SNMP traps to an external SNMP server. SNMP traps are a viable security logging facility but require the configuration and maintenance of an SNMP system.</li><li><b>Syslog</b> - Cisco routers can be configured to forward log messages to an external syslog service. This service can reside on any number of servers or workstations, including Microsoft Windows and UNIX-based systems, or the Cisco Security MARS appliance. Syslog is the most popular message logging facility, because it provides long-term log storage capabilities and a central location for all router messages.</li></ul></p> <p>Cisco router log messages fall into one of eight levels. The lower the level number, the higher the severity level.</p> <p>Cisco router log messages contain three main parts:</p> <p><ul><li>Timestamp</li><li>Log message name and severity level</li><li>Message text</li></ul></p></content-text>
</page>
<page type="OneColumn" id="en2002030302">
<content-media type="StaticGraphic" id="cm1792703106">	<title><content-text></content-text></title>	<media ref="en2002000000/en2002030000/en2002030300/en2002030302/cm1792703106.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2002000000/en2002030000/en2002030300/en2002030302/cm1792703106text.xml"/></content-media>
<content-text><p>Syslog is the standard for logging system events. Syslog implementations contain two types of systems.</p> <p><ul><li><b>Syslog servers</b> - Also known as log hosts, these systems accept and process log messages from syslog clients.</li><li><b>Syslog clients</b> - Routers or other types of equipment that generate and forward log messages to syslog servers.</li></ul></p> <p>The syslog protocol allows login messages to be sent from a syslog client to the syslog server. While the ability to send logs to a central syslog server is part of a good security solution, it can also potentially be part of security problem. The biggest issue is the enormity of the task of sifting through the resulting information, correlating the events from several different network devices and application servers, and taking different types of actions based on a vulnerability assessment of the incident.</p> <p>The Cisco Security Monitoring, Analysis, and Response System (MARS) is a Cisco security appliance that can receive and analyze syslog messages from various networking devices and hosts from Cisco and other vendors. Cisco Security MARS extends the portfolio of security management products for the Cisco Self-Defending Network initiative. Cisco Security MARS is the first purpose-built appliance for real-time security threat mitigation.</p> <p>Cisco Security MARS monitors many types of logging and reporting traffic that is available from the security and network products in the enterprise network. Cisco Security MARS combines all of this log data into a series of sessions which it then compares to a database of rules. If the rules indicate that there might be a problem, an incident is triggered. By using this method, a network administrator can have the Cisco Security MARS appliance process most of the logging data from network devices and focus human efforts on the potential problems.</p></content-text>
</page>
<page type="OneColumn" id="en2002030303">
<content-media type="StaticGraphic" id="cm5203672535">	<title><content-text></content-text></title>	<media ref="en2002000000/en2002030000/en2002030300/en2002030303/cm5203672535.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2002000000/en2002030000/en2002030300/en2002030303/cm5203672535text.xml"/></content-media>
<content-text><p>Use the following steps to configure system logging.</p> <p><b>Step 1.</b> Set the destination logging host using the <span class="cmd"><b>logging host</b></span> command.</p> <p><b>Step 2.</b> (Optional) Set the log severity (trap) level using the <span class="cmd"><b>logging trap </b><i>level</i></span> command.</p> <p><b>Step 3.</b> Set the source interface using the <span class="cmd"><b>logging source-interface</b></span> command. This specifies that syslog packets contain the IPv4 or IPv6 address of a particular interface, regardless of which interface the packet uses to exit the router.</p> <p><b>Step 4.</b> Enable logging with the <span class="cmd"><b>logging on</b></span> command. You can turn logging on and off for these destinations individually using the <span class="cmd"><b>logging buffered</b></span>, <span class="cmd"><b>logging monitor</b></span>, and <span class="cmd"><b>logging</b></span> global configuration commands. However, if the <span class="cmd"><b>logging on</b></span> command is disabled, no messages are sent to these destinations. Only the console receives messages.</p></content-text>
</page>
<page type="OneColumn" id="en2002030304">
<content-media type="StaticGraphic" id="cm9586529743">	<title><content-text></content-text></title>	<media ref="en2002000000/en2002030000/en2002030300/en2002030304/cm9586529743.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2002000000/en2002030000/en2002030300/en2002030304/cm9586529743text.xml"/></content-media>
<content-text><p>To enable syslog logging on your router using Cisco Router and Security Device Manager (SDM), follow these steps.</p> <p><b>Step 1.</b> Choose <b>Configure > Additional Tasks > Router Properties > Logging</b>.</p> <p><b>Step 2.</b> From the Logging pane, click <b>Edit</b>.</p> <p><b>Step 3.</b> In the Logging window, select <b>Enable Logging Level</b> and choose the logging level from the <b>Logging Level</b> list box. Messages will be logged for the level selected and below.</p> <p><b>Step 4.</b> Click <b>Add</b>, and enter an IP address of a logging host in the <b>IP Address/Hostname</b> field.</p> <p><b>Step 5.</b> Click <b>OK</b> to return to the Logging dialog box.</p> <p><b>Step 6.</b> Click <b>OK</b> to accept the changes and return to the Logging pane.</p></content-text>
</page>
<page type="OneColumn" id="en2002030305">
<content-media type="StaticGraphic" id="cm9327416044">	<title><content-text></content-text></title>	<media ref="en2002000000/en2002030000/en2002030300/en2002030305/cm9327416044.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2002000000/en2002030000/en2002030300/en2002030305/cm9327416044text.xml"/></content-media>
<content-text><p>Cisco SDM can be used to monitor logging by choosing <b>Monitor > Logging</b>.</p> <p>From the Syslog tab, you can perform the following functions:</p> <p><ul><li>See the logging hosts to which the router logs messages.</li><li>Choose the minimum severity level to view. </li><li>Monitor the router syslog messages, update the screen to show the most current log entries, and erase all syslog messages from the router log buffer.</li></ul></p></content-text>
</page>
</topic>
<topic type="" id="en2002030400">
<title><content-text>Using SNMP for Network Security</content-text></title>
<page type="OneColumn" id="en2002030401">
<content-media type="StaticGraphic" id="cm9200251786">	<title><content-text></content-text></title>	<media ref="en2002000000/en2002030000/en2002030400/en2002030401/cm9200251786.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2002000000/en2002030000/en2002030400/en2002030401/cm9200251786text.xml"/></content-media>
<content-text><p>Another common monitoring tool is SNMP. SNMP was developed to manage nodes, such as servers, workstations, routers, switches, hubs, and security appliances, on an IP network. SNMP is an Application Layer protocol that facilitates the exchange of management information between network devices. SNMP is part of the TCP/IP protocol suite. SNMP enables network administrators to manage network performance, find and solve network problems, and plan for network growth. There are different versions of SNMP.</p> <p>SNMP version 1 (SNMPv1) and SNMP version 2 (SNMPv2) are based on managers (network management systems [NMSs]), agents (managed nodes), and Management Information Bases (MIBs). In any configuration, at least one manager node runs SNMP management software. Network devices that need to be managed, such as switches, routers, servers, and workstations, are equipped with an SMNP agent software module. The agent is responsible for providing access to a local MIB of objects that reflects the resources and activity at its node. MIBs store data about the device operation and are meant to be available to authenticated remote users.</p> <p>The SNMP manager can get information from the agent, and change, or set, information in the agent. Sets can change configuration variables in the agent device. Sets can also initiate actions in devices. A reply to a set indicates the new setting in the device. For example, a set can cause a router to reboot, send a configuration file, or receive a configuration file. SNMP traps enable an agent to notify the management station of significant events by sending an unsolicited SNMP message. The action of gets and sets are the vulnerabilities that open SNMP to attack.</p></content-text>
</page>
<page type="OneColumn" id="en2002030402">
<content-media type="StaticGraphic" id="cm8692293720">	<title><content-text></content-text></title>	<media ref="en2002000000/en2002030000/en2002030400/en2002030402/cm8692293720.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2002000000/en2002030000/en2002030400/en2002030402/cm8692293720text.xml"/></content-media>
<content-text><p>SNMP agents accept commands and requests from SNMP management systems only if those systems have a correct community string. An SNMP community string is a text string that can authenticate messages between a management station and an SNMP agent and allow access to the information in MIBs. Community strings are essentially used for password-only authentication of messages between the NMS and the agent.</p> <p>There are two types of community strings.</p> <p><ul><li>Read-only community strings - Provides read-only access to all objects in the MIB, except the community strings.</li><li>Read-write community strings - Provides read-write access to all objects in the MIB, except the community strings.</li></ul></p> <p>If the manager sends one of the correct read-only community strings, it can get information but not set information in an agent. If the manager uses one of the correct read-write community strings, it can get or set information in the agent. In effect, having set access to a router is equivalent to having the enable password of the router. </p> <p>By default, most SNMP systems use "public" as a community string. If you configure your router SNMP agent to use this commonly known community string, anyone with an SNMP system is able to read the router MIB. Because router MIB variables can point to things such as routing tables and other security-critical parts of the router configuration, it is extremely important that you create your own custom SNMP community strings. However, even if the community string is changed, the strings are sent in plaintext. This is a huge vulnerability of the SNMPv1 and SNMPv2 architecture. </p> <p>If using in-band management, to reduce security risks, SNMP management should be configured to only pull information from devices rather than being allowed to push "set" changes to the devices. To ensure management information is pulled, each device should be configured with a read-only SNMP community string. </p> <p>Keeping SNMP traffic on a management segment allows the traffic to traverse an isolated segment when management information is pulled from devices and when configuration changes are pushed to a device. Therefore, if using an OOB network, it is acceptable to configure an SNMP read-write community string; however, be aware of the increased security risk of a plaintext string that allows modification of device configurations.</p></content-text>
</page>
<page type="OneColumn" id="en2002030403">
<content-media type="StaticGraphic" id="cm3353397193">	<title><content-text></content-text></title>	<media ref="en2002000000/en2002030000/en2002030400/en2002030403/cm3353397193.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2002000000/en2002030000/en2002030400/en2002030403/cm3353397193text.xml"/></content-media>
<content-text><p>The current version of SNMPv3 addresses the vulnerabilities of earlier versions by including three important services: authentication, privacy, and access control.</p> <p>SNMPv3 is an interoperable standards-based protocol for network management. SNMPv3 uses a combination of authenticating and encrypting packets over the network to provide secure access to devices. SNMPv3 provides three security features.</p> <p><ul><li><b>Message integrity</b> - Ensures that a packet has not been tampered with in transit.</li><li><b>Authentication</b> - Determines that the message is from a valid source.</li><li><b>Encryption</b> - Scrambles the contents of a packet to prevent it from being seen by an unauthorized source.</li></ul></p> <p>While it is recommended that SNMPv3 be used where possible because of the added security features, configuring SNMPv3 is beyond the scope of this course.</p></content-text>
</page>
<page type="OneColumn" id="en2002030404">
<content-media type="StaticGraphic" id="cm8526990361">	<title><content-text></content-text></title>	<media ref="en2002000000/en2002030000/en2002030400/en2002030404/cm8526990361.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2002000000/en2002030000/en2002030400/en2002030404/cm8526990361text.xml"/></content-media>
<content-text><p>When enabling SNMP, it is important to consider the security model and the security level. The security model is an authentication strategy that is set up for a user and the group in which the user resides. Currently, Cisco IOS software supports three security models: SNMPv1, SNMPv2c, and SNMPv3. A security level is the permitted level of security within a security model. The security level is a type of security algorithm that is performed on each SNMP packet. </p> <p>There are three security levels.</p> <p><ul><li><b>noAuth</b> - Authenticates a packet by a string match of the username or community string.</li><li><b>auth</b> - Authenticates a packet by using either the Hashed Message Authentication Code (HMAC) with MD5 method or Secure Hash Algorithms (SHA) method. The HMAC method is described in RFC 2104, HMAC: Keyed-Hashing for Message Authentication.</li><li><b>priv</b> - Authenticates a packet by using either the HMAC MD5 or HMAC SHA algorithms and encrypts the packet using the Data Encryption Standard (DES), Triple DES (3DES), or Advanced Encryption Standard (AES) algorithms.</li></ul></p> <p>The combination of the model and level determines which security mechanism is employed when handling an SNMP packet. Only SNMPv3 supports the auth and priv security levels. However, Cisco SDM does not support configuration of SNMPv3. </p> <p>To enable SNMPv1 and SNMPv2 using Cisco SDM follow these steps:</p> <p><b>Step 1.</b> Choose <b>Configure > Additional Tasks > Router Properties > SNMP</b>. Click the <b>Edit</b> button.</p> <p><b>Step 2.</b> From the SNMP Properties window, select <b>Enable SNMP</b> to enable SNMP support.</p> <p>Set community strings and enter trap manager information from the same SNMP Properties window used to enable support. </p> <p><b>Step 3.</b> In the SNMP Properties window, click <b>Add</b> to create new community strings, click <b>Edit</b> to edit an existing community string, or click <b>Delete</b> to delete a community string.</p> <p>An example CLI command that SDM would generate based on a read only community string of cisco123 is <span class="cmd"><b>snmp-server community cisco123 ro</b></span>.</p></content-text>
</page>
<page type="OneColumn" id="en2002030405">
<content-media type="StaticGraphic" id="cm9242221270">	<title><content-text></content-text></title>	<media ref="en2002000000/en2002030000/en2002030400/en2002030405/cm9242221270.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2002000000/en2002030000/en2002030400/en2002030405/cm9242221270text.xml"/></content-media>
<content-text><p>The administrator can also configure devices to which a router sends traps. These devices are referred to as trap receivers. Cisco SDM can be used to add, edit, or delete a trap receiver.</p> <p><b>Step 1.</b> From the SNMP pane in Cisco SDM, click <b>Edit</b>. The SNMP Properties window displays.</p> <p><b>Step 2.</b> To add a new trap receiver, click <b>Add</b> in the Trap Receiver section of the SNMP Properties window. The Add a Trap Receiver window displays.</p> <p><b>Step 3.</b> Enter the IP address or host name of the trap receiver and the password that is used to connect to the trap receiver. Typically, this is the IP address of the SNMP management station that monitors your domain. Check with the site administrator to determine the address if unsure.</p> <p><b>Step 4.</b> Click <b>OK</b> to finish adding the trap receiver.</p> <p><b>Step 5.</b> To edit an existing trap receiver, choose a trap receiver from the trap receiver list and click <b>Edit</b>. To delete an existing trap receiver, choose a trap receiver from the trap receiver list and click <b>Delete</b>.</p> <p><b>Step 6.</b> When the trap receiver list is complete, click <b>OK</b> to return to the SNMP pane.</p> <p>The SNMP Properties window also contains the SNMP Server Device Location field and the SNMP Server Administrator Contact field. Both of these fields are text fields that can be used to enter descriptive information about the SNMP server location and the contact information for a person managing the SNMP server. These fields are not required and do not affect the operation of the router.</p></content-text>
</page>
</topic>
<topic type="" id="en2002030500">
<title><content-text>Using NTP</content-text></title>
<page type="OneColumn" id="en2002030501">
<content-media type="StaticGraphic" id="cm2638242007">	<title><content-text></content-text></title>	<media ref="en2002000000/en2002030000/en2002030500/en2002030501/cm2638242007.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2002000000/en2002030000/en2002030500/en2002030501/cm2638242007text.xml"/></content-media>
<content-text><p>Many things involved in the security of a network, such as security logs, depend on an accurate date and time stamp. When dealing with an attack, seconds matter, because it is important to identify the order in which a specified attack occurred. To ensure that log messages are synchronized with one another, clocks on hosts and network devices must be maintained and synchronized. </p> <p>Typically, the date and time settings of the router can be set using one of two methods:</p> <p><ul><li>Manually editing the date and time</li><li>Configuring the Network Time Protocol (NTP)</li></ul></p> <p>Although the manual method works in a small network environment, as a network grows, it becomes difficult to ensure that all infrastructure devices are operating with synchronized time. Even in a smaller network environment, the manual method is not ideal. If a router reboots, where would it get an accurate date and timestamp?</p> <p>A better solution is to configure NTP on the network. NTP allows routers on the network to synchronize their time settings with an NTP server. A group of NTP clients that obtain time and date information from a single source have more consistent time settings. When NTP is implemented in the network, it can be set up to synchronize to a private master clock, or it can synchronize to a publicly available NTP server on the Internet.</p></content-text>
</page>
<page type="OneColumn" id="en2002030502">
<content-media type="StaticGraphic" id="cm2443418784">	<title><content-text></content-text></title>	<media ref="en2002000000/en2002030000/en2002030500/en2002030502/cm2443418784.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2002000000/en2002030000/en2002030500/en2002030502/cm2443418784text.xml"/></content-media>
<content-text><p>NTP uses UDP port 123 and is documented in RFC 1305. </p> <p>When determining whether to use a private clock synchronization versus a public clock, it is necessary to weigh the risks and benefits of both.</p> <p>If a private master clock is implemented, it could be synchronized to Coordinated Universal Time (UTC) via satellite or radio. The administrator does need to ensure that the time source is valid and from a secure site; otherwise, it can introduce vulnerabilities. For example, an attacker can launch a DoS attack by sending bogus NTP data across the Internet to the network in an attempt to change the clocks on network devices, possibly causing digital certificates to become invalid. An attacker could attempt to confuse a network administrator during an attack by disrupting the clocks on network devices. This scenario would make it difficult for the network administrator to determine the order of syslog events on multiple devices.</p> <p>Pulling the clock time from the Internet means that unsecured packets are allowed through the firewall. Many NTP servers on the Internet do not require any authentication of peers; therefore, the network administrator must trust that the clock itself is reliable, valid, and secure.</p> <p>The communications (known as associations) between machines that run NTP are usually statically configured. Each device is given the IP address of NTP masters. Accurate timekeeping is possible by exchanging NTP messages between each pair of machines with an association. In an NTP configured network, one or more routers are designated as the master clock keeper (known as an NTP master) using the <span class="cmd"><b>ntp master</b></span> global configuration command. </p> <p>NTP clients either contact the master or listen for messages from the master to synchronize their clocks. To contact the master, use the <span class="cmd"><b>ntp server </b><i>ntp-server-address</i></span> command. </p> <p>In a LAN environment, NTP can be configured to use IP broadcast messages instead by using the <span class="cmd"><b>ntp broadcast client</b></span> command. This alternative reduces configuration complexity because each machine can be configured to send or receive broadcast messages. The accuracy of timekeeping is marginally reduced because the information flow is one-way only.</p></content-text>
</page>
<page type="OneColumn" id="en2002030503">
<content-media type="StaticGraphic" id="cm2042954642">	<title><content-text></content-text></title>	<media ref="en2002000000/en2002030000/en2002030500/en2002030503/cm2042954642.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2002000000/en2002030000/en2002030500/en2002030503/cm2042954642text.xml"/></content-media>
<content-text><p>The time that a machine keeps is a critical resource, therefore the security features of NTP should be used to avoid the accidental or malicious setting of incorrect times. There are two security mechanisms available: </p> <p><ul><li>ACL-based restriction scheme</li><li>Encrypted authentication mechanism offered by NTP version 3 or later</li></ul></p> <p>NTP version 3 (NTPv3) and later support a cryptographic authentication mechanism between NTP peers. This authentication mechanism, in addition to ACLs that specify which network devices are allowed to synchronize with other network devices, can be used to help mitigate such an attack.</p> <p>To secure NTP traffic, it is strongly recommended that NTP version 3 or later is implemented. Use the following commands on both the NTP master and the NTP client.</p> <p><span class="cmd"><b>ntp authenticate</b></span></p> <p><span class="cmd"><b>ntp authentication-key </b><i>key-number</i><b> md5 </b><i>key-value</i></span></p> <span class="cmd"><p><b>ntp trusted-key </b><i>key-number</i></p></span> <p>The authentication is for the benefit of a client to ensure that it is getting the time from an authenticated server. Clients configured without authentication still get the time from the server. The difference is that these clients do not authenticate the server as a secure source. </p> <p>Use the <span class="cmd"><b>show ntp associations detail</b></span> command to confirm that the server is an authenticated source.</p> <p>Note: The key value can also be set as an argument in the <span class="cmd"><b>ntp server </b><i>ntp-server-address</i></span> command.</p></content-text>
</page>
<page type="OneColumn" id="en2002030504">
<content-media type="StaticGraphic" id="cm9398641124">	<title><content-text></content-text></title>	<media ref="en2002000000/en2002030000/en2002030500/en2002030504/cm9398641124.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2002000000/en2002030000/en2002030500/en2002030504/cm9398641124text.xml"/></content-media>
<content-text><p>Cisco SDM allows a network administrator to view the configured NTP server information, add new information, and edit or delete existing information.</p> <p>There are seven steps to add an NTP server using Cisco SDM.</p> <p><b>Step 1.</b> Choose <b>Configure > Additional Tasks > Router Properties > NTP/SNTP</b>. The NTP pane appears, displaying the information for all configured NTP servers.</p> <p><b>Step 2.</b> To add a new NTP server, click <b>Add</b>. The Add NTP Server Details window appears.</p> <p><b>Step 3.</b> Add an NTP server by name if the router is configured to use a Domain Name System (DNS) server or by IP address. To add an NTP server by IP address, enter the IP address in the field next to the NTP Server IP Address option. If the organization does not have an NTP server, the administrator might want to use a publicly available server, such as one from the server list that can be found at http://support.ntp.org/bin/view/Servers/WebHome. </p> <p><b>Step 4.</b> (Optional) From the <b>NTP Source Interface</b> drop-down list, choose the interface that the router uses to communicate with the NTP server. The NTP Source Interface is an optional field. If this field is left blank, NTP messages are sent from the interface closest to the NTP server per the routing table. </p> <p><b>Step 5.</b> Select <b>Prefer</b> if this NTP server has been designated as a preferred NTP server. Preferred NTP servers are contacted before nonpreferred NTP servers. There can be more than one preferred NTP server.</p> <p><b>Step 6.</b> If the NTP server uses authentication, select <b>Authentication Key</b> and enter the key number and key value.</p> <p><b>Step 7.</b> Click <b>OK</b> to finish adding the server.</p></content-text>
</page>
</topic>
</section>
<section type="" id="en2002040000">
<title><content-text>Using Automated Security Features</content-text></title>
<topic type="" id="en2002040100">
<title><content-text>Performing a Security Audit</content-text></title>
<page type="OneColumn" id="en2002040101">
<content-media type="StaticGraphic" id="cm3969990296">	<title><content-text></content-text></title>	<media ref="en2002000000/en2002040000/en2002040100/en2002040101/cm3969990296.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2002000000/en2002040000/en2002040100/en2002040101/cm3969990296text.xml"/></content-media>
<content-text><p>Cisco routers are initially deployed with many services that are enabled by default. This is done for convenience and to simplify the configuration process required to get the device operational. However, some of these services can make the device vulnerable to attack if security is not enabled. Administrators can also enable services on Cisco routers that can expose the device to significant risk. Both of these scenarios must be taken into account when securing the network.</p> <p>For example, Cisco Discovery Protocol (CDP) is an example of a service that is enabled by default in Cisco routers. It is used primarily to obtain protocol addresses of neighboring Cisco devices and to discover the platforms of those devices. Unfortunately, an attacker on the network can use CDP to discover devices on the local network. In addition, attackers do not need to have CDP-enabled devices. Readily available software, such as Cisco CDP Monitor, can be downloaded to gain the information. The intent of CDP is to make it easier for administrators to discover and troubleshoot other Cisco devices on the network. However, because of the security implications, the use of CDP should be deterministic. While it is an extremely helpful tool, it should not be everywhere in the network. Edge devices are an example of a device that should have this feature disabled.</p></content-text>
</page>
<page type="OneColumn" id="en2002040102">
<content-media type="StaticGraphic" id="cm7128755206">	<title><content-text></content-text></title>	<media ref="en2002000000/en2002040000/en2002040100/en2002040102/cm7128755206.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2002000000/en2002040000/en2002040100/en2002040102/cm7128755206text.xml"/></content-media>
<content-text><p>Attackers choose services and protocols that make the network more vulnerable to malicious exploitation. </p> <p>Depending on the security needs of an organization, many of these services should be disabled or, at a minimum, restricted in their capabilities. These features range from Cisco proprietary protocols, such as Cisco Discovery Protocol (CDP), to globally available protocols such as ICMP and other scanning tools.</p> <p>Some of the default settings in Cisco IOS software are there for historical reasons; they made sense when they were chosen but would probably be different if new defaults were chosen today. Other defaults make sense for most systems but can create security exposures if they are used in devices that form part of a network perimeter defense. Still other defaults are actually required by standards but are not always desirable from a security point of view.</p> <p>Many practices help ensure a device is secure.</p> <p><ul><li>Disable unnecessary services and interfaces.</li><li>Disable and restrict commonly configured management services, such as SNMP.</li><li>Disable probes and scans, such as ICMP.</li><li>Ensure terminal access security.</li><li>Disable gratuitous and proxy Address Resolution Protocol (ARP).</li><li>Disable IP-directed broadcasts.</li></ul></p></content-text>
</page>
<page type="OneColumn" id="en2002040103">
<content-media type="StaticGraphic" id="cm4161831684">	<title><content-text></content-text></title>	<media ref="en2002000000/en2002040000/en2002040100/en2002040103/cm4161831684.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2002000000/en2002040000/en2002040100/en2002040103/cm4161831684text.xml"/></content-media>
<content-text><p>To secure network devices, administrators must first determine the vulnerabilities that exist with the current configuration. The best way to accomplish this is through the use of a security audit tool. A security audit tool performs checks on the security level of a configuration by comparing that configuration to recommended settings and tracking discrepancies. After vulnerabilities are identified, network administrators must modify the configuration to reduce or eliminate those vulnerabilities to secure the device and the network. </p> <p>Three security audit tools available include:</p> <p><ul><li> <b>Security Audit Wizard</b> - a security audit feature provided through Cisco SDM. The Security Audit Wizard provides a list of vulnerabilities and then allows the administrator to choose which potential security-related configuration changes to implement on a router.</li><li> <b>Cisco AutoSecure</b> - a security audit feature available through the Cisco IOS CLI. The <span class="cmd"><b>autosecure</b></span> command initiates a security audit and then allows for configuration changes. Based on the mode selected, configuration changes can be automatic or require network administrator input.</li><li> <b>One-Step Lockdown</b> - a security audit feature provided through Cisco SDM. The One-Step Lockdown feature provides a list of vulnerabilities and then automatically makes all recommended security-related configuration changes.</li></ul></p> <p>Both Security Audit Wizard and One-Step Lockdown are based on the Cisco IOS Autosecure feature.</p></content-text>
</page>
<page type="OneColumn" id="en2002040104">
<content-media type="StaticGraphic" id="cm7308948887">	<title><content-text></content-text></title>	<media ref="en2002000000/en2002040000/en2002040100/en2002040104/cm7308948887.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2002000000/en2002040000/en2002040100/en2002040104/cm7308948887text.xml"/></content-media>
<content-text><p><b>Security Audit Wizard</b></p> <p>The Security Audit wizard tests the router configuration to determine if any potential security problems exist in the configuration, and then presents a screen that lets the administrator determine which of those security problems to fix. At this point, Security Audit wizard makes the necessary changes to the router configuration to fix those problems.</p> <p>The Security Audit wizard compares a router configuration against recommended settings and performs the following:</p> <p><ul><li>Shuts down unneeded servers.</li><li>Disables unneeded services.</li><li>Applies the firewall to the outside interfaces. </li><li>Disables or hardens SNMP.</li><li>Shuts down unused interfaces.</li><li>Checks password strength.</li><li>Enforces the use of ACLs.</li></ul></p> <p>When a security audit is initiated, the Security Audit wizard must know which router interfaces connect to the inside network and which connect to the outside of the network. The Security Audit wizard then tests the router configuration to determine possible security problems that may exist. A window shows all configuration options tested and whether the current router configuration passes those tests.</p> <p>When the audit is complete, Security Audit identifies possible vulnerabilities in the configuration and provides a way to correct those problems. It also gives the administrator the option to fix problems automatically, in which case it determines the necessary configuration commands. A description of specific problems and a list of the Cisco IOS commands used to correct those problems is provided.</p> <p>Before any configuration changes are made, a summary page displays a list of all the configuration changes that Security Audit will make. The administrator must click <b>Finish</b> to send those configurations to the router.</p></content-text>
</page>
</topic>
<topic type="" id="en2002040200">
<title><content-text>Locking Down a Router Using AutoSecure</content-text></title>
<page type="OneColumn" id="en2002040201">
<content-media type="StaticGraphic" id="cm8406712290">	<title><content-text></content-text></title>	<media ref="en2002000000/en2002040000/en2002040200/en2002040201/cm8406712290.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2002000000/en2002040000/en2002040200/en2002040201/cm8406712290text.xml"/></content-media>
<content-text><p><b>Cisco AutoSecure</b></p> <p>Released in IOS version 12.3, Cisco AutoSecure is a feature that is initiated from the CLI and executes a script. AutoSecure first makes recommendations for fixing security vulnerabilities and then modifies the security configuration of the router. </p> <p>AutoSecure can lock down the management plane functions and the forwarding plane services and functions of a router. </p> <p>The management plane is the logical path of all traffic related to the management of a routing platform. It is used to control all other functions of routing and to manage a device through its connection to the network. There are several management plane services and functions:</p> <p><ul><li>Secure BOOTP, CDP, FTP, TFTP, PAD, UDP, and TCP small servers, MOP, ICMP (redirects, mask-replies), IP source routing, Finger, password encryption, TCP keepalives, gratuitous ARP, proxy ARP, and directed broadcast</li><li>Legal notification using a banner</li><li>Secure password and login functions</li><li>Secure NTP </li><li>Secure SSH access</li><li>TCP intercept services</li></ul></p> <p>The forwarding plane is responsible for packet forwarding (or packet switching), which is the act of receiving packets on the router interfaces and sending them out on other interfaces. </p> <p>There are three forwarding plane services and functions: </p> <p><ul><li>Enables CEF </li><li>Enables traffic filtering with ACLs</li><li>Implements Cisco IOS firewall inspection for common protocols</li></ul></p> <p>AutoSecure is often used in the field to provide a baseline security policy on a new router. Features can then be altered to support the security policy of the organization.</p></content-text>
</page>
<page type="OneColumn" id="en2002040202">
<content-media type="StaticGraphic" id="cm1157506369">	<title><content-text></content-text></title>	<media ref="en2002000000/en2002040000/en2002040200/en2002040202/cm1157506369.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2002000000/en2002040000/en2002040200/en2002040202/cm1157506369text.xml"/></content-media>
<content-text><p>Use the <span class="cmd"><b>auto secure</b></span> command to enable the Cisco AutoSecure feature setup. This setup can be interactive or non-interactive.</p> <p><span class="cmd"><b>auto secure [no-interact]</b></span></p> <p>In interactive mode, the router prompts with options to enable and disable services and other security features. This is the default mode, but it can also be configured using the <span class="cmd"><b>auto secure full</b></span> command.</p> <p>The non-interactive mode is similar to the SDM Security Audit one-step lockdown feature because it automatically executes the Cisco AutoSecure command with the recommended Cisco default settings. This mode is enabled using the <span class="cmd"><b>auto secure no-interact</b></span> privileged EXEC command. </p> <p>The <span class="cmd"><b>auto secure</b></span> command can also be entered with keywords to configure specific components, such as the management plane and forwarding plane.</p></content-text>
</page>
<page type="OneColumn" id="en2002040203">
<content-media type="StaticGraphic" id="cm3702114990">	<title><content-text></content-text></title>	<media ref="en2002000000/en2002040000/en2002040200/en2002040203/cm3702114990.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2002000000/en2002040000/en2002040200/en2002040203/cm3702114990text.xml"/></content-media>
<content-text><p>When the <span class="cmd"><b>auto secure</b></span> command is initiated, a wizard is displayed to step the administrator through the configuration of the device. User input is required. When the wizard is complete, a running configuration displays all configuration settings and changes.</p></content-text>
</page>
</topic>
<topic type="" id="en2002040300">
<title><content-text>Locking down a router using SDM</content-text></title>
<page type="OneColumn" id="en2002040301">
<content-media type="StaticGraphic" id="cm6065183064">	<title><content-text></content-text></title>	<media ref="en2002000000/en2002040000/en2002040300/en2002040301/cm6065183064.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2002000000/en2002040000/en2002040300/en2002040301/cm6065183064text.xml"/></content-media>
<content-text><p><b>Cisco One-Step Lockdown</b></p> <p>One-step lockdown tests a router configuration for any potential security problems and automatically makes the necessary configuration changes to correct any problems.</p> <p>Cisco One-Step Lockdown Disables:</p> <p><ul><li>Finger service</li><li>PAD service</li><li>TCP small servers service</li><li>UDP small servers service</li><li>IP BOOTP server service</li><li>IP identification service</li><li>Cisco Discovery Protocol</li><li>IP source route</li><li>IP GARPs</li><li>SNMP</li><li>IP redirects</li><li>IP proxy ARP</li><li>IP directed broadcast</li><li>MOP service</li><li>IP unreachables</li><li>IP mask reply</li><li>IP unreachables on null interface</li></ul></p> <p>Cisco One-Step Lockdown Enables:</p> <p><ul><li>Password encryption service</li><li>TCP keepalives for inbound and outbound Telnet sessions </li><li>Sequence numbers and timestamps on debugs</li><li>IP Cisco Express Forwarding Enable NetFlow switching </li><li>Unicast Reverse Path Forwarding (RPF) on outside interfaces</li><li>Firewall on all outside interfaces</li><li>SSH for access to the router</li><li>AAA</li></ul></p> <p>Cisco One-Step Lockdown Sets:</p> <p><ul><li>Minimum password length to six characters</li><li>Authentication failure rate to less than three retries</li><li>TCP synwait time</li><li>Notification banner</li><li>Logging parameters</li><li>Enable secret password</li><li>Scheduler interval</li><li>Scheduler allocate</li><li>Users</li><li>Telnet settings</li><li>Access class on HTTP server service</li><li>Access class on vty lines</li></ul></p></content-text>
</page>
<page type="OneColumn" id="en2002040302">
<content-media type="StaticGraphic" id="cm4061770545">	<title><content-text></content-text></title>	<media ref="en2002000000/en2002040000/en2002040300/en2002040302/cm4061770545.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2002000000/en2002040000/en2002040300/en2002040302/cm4061770545text.xml"/></content-media>
<content-text><p>Deciding which automated lockdown feature to use, AutoSecure or SDM Security Audit one-step lockdown, is basically a matter of preference. There are differences in how they implement good security practices.</p> <p>Cisco SDM does not implement all the features of Cisco AutoSecure. Since Cisco SDM version 2.4, the following Cisco AutoSecure features are not part of the Cisco SDM one-step lockdown:</p> <p><ul><li><b>Disabling NTP</b> - Based on input, Cisco AutoSecure disables NTP if it is not necessary. Otherwise, NTP is configured with MD5 authentication. Cisco SDM does not support disabling NTP.</li><li><b>Configuring AAA</b> - If the AAA service is not configured, Cisco AutoSecure configures local AAA and prompts for the configuration of a local username and password database on the router. Cisco SDM does not support AAA configuration.</li><li><b>Setting Selective Packet Discard (SPD) values</b> - Cisco SDM does not set SPD values.</li><li><b>Enabling TCP intercepts</b> - Cisco SDM does not enable TCP intercepts.</li><li><b>Configuring antispoofing ACLs on outside interfaces</b> - Cisco AutoSecure creates three named access lists to prevent antispoofing source addresses. Cisco SDM does not configure these ACLs.</li></ul></p> <p>The following Cisco AutoSecure features are implemented differently in Cisco SDM:</p> <p><ul><li><b>Enable SSH for access to the router</b> - Cisco SDM enables and configures SSH on Cisco IOS images that have the IPsec feature set; however, unlike Cisco AutoSecure, Cisco SDM does not enable Secure Copy Protocol (SCP) or disable other access and file transfer services, such as FTP.</li><li><b>Disable SNMP</b> - Cisco SDM disables SNMP; however, unlike Cisco AutoSecure, Cisco SDM does not provide an option for configuring SNMPv3. The SNMPv3 option is not available on all routers.</li></ul></p> <p>Regardless of which automated feature is preferred, it should be used as a baseline and then altered to meet the needs of the organization.</p></content-text>
</page>
</topic>
</section>
<section type="ChapterSummary" id="en2002050000">
<title><content-text>Chapter Summary</content-text></title>
<topic type="" id="en2002050100">
<title><content-text>Chapter Summary</content-text></title>
<page type="FullScreen" id="en2002050101">
<content-media type="StaticGraphic" id="cm6228266933">	<title><content-text></content-text></title>	<media ref="en2002000000/en2002050000/en2002050100/en2002050101/cm6228266933.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en2002000000/en2002050000/en2002050100/en2002050101/cm6228266933text.xml"/></content-media>
<content-text></content-text>
</page>
</topic>
</section>
</chapter>
